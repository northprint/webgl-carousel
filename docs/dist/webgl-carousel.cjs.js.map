{"version":3,"file":"webgl-carousel.cjs.js","sources":["../src/core/EventEmitter.ts","../src/core/StateManager.ts","../src/core/ImageLoader.ts","../src/core/BaseWebGLRenderer.ts","../src/core/WebGLRenderer.ts","../src/core/WebGL2Renderer.ts","../src/core/Canvas2DFallback.ts","../src/core/EffectManager.ts","../src/effects/BaseEffect.ts","../src/effects/shaderUtils.ts","../src/effects/fade.ts","../src/effects/slide.ts","../src/effects/flip.ts","../src/effects/wave.ts","../src/effects/distortion.ts","../src/effects/dissolve.ts","../src/effects/circle.ts","../src/effects/pixelDissolve.ts","../src/effects/morph.ts","../src/effects/glitch.ts","../src/effects/CustomEffect.ts","../src/effects/index.ts","../src/core/CarouselCore.ts","../src/WebGLCarousel.ts","../src/adapters/react/WebGLCarouselReact.tsx","../src/adapters/vue/WebGLCarouselVue.ts","../src/index.ts"],"sourcesContent":["export type EventHandler = (...args: unknown[]) => void;\n\nexport interface EventMap {\n  [event: string]: unknown[];\n}\n\nexport class EventEmitter<T extends EventMap = EventMap> {\n  private events: Map<keyof T, Set<EventHandler>> = new Map();\n\n  on<K extends keyof T>(event: K, handler: (...args: T[K]) => void): this {\n    if (!this.events.has(event)) {\n      this.events.set(event, new Set());\n    }\n    this.events.get(event)!.add(handler as EventHandler);\n    return this;\n  }\n\n  off<K extends keyof T>(event: K, handler: (...args: T[K]) => void): this {\n    const handlers = this.events.get(event);\n    if (handlers) {\n      handlers.delete(handler as EventHandler);\n      if (handlers.size === 0) {\n        this.events.delete(event);\n      }\n    }\n    return this;\n  }\n\n  emit<K extends keyof T>(event: K, ...args: T[K]): this {\n    const handlers = this.events.get(event);\n    if (handlers) {\n      handlers.forEach((handler) => {\n        try {\n          handler(...args);\n        } catch (error) {\n          console.error(`Error in event handler for \"${String(event)}\":`, error);\n        }\n      });\n    }\n    return this;\n  }\n\n  once<K extends keyof T>(event: K, handler: (...args: T[K]) => void): this {\n    const onceHandler = (...args: T[K]) => {\n      this.off(event, onceHandler);\n      handler(...args);\n    };\n    return this.on(event, onceHandler);\n  }\n\n  removeAllListeners(event?: keyof T): this {\n    if (event) {\n      this.events.delete(event);\n    } else {\n      this.events.clear();\n    }\n    return this;\n  }\n\n  listenerCount(event: keyof T): number {\n    const handlers = this.events.get(event);\n    return handlers ? handlers.size : 0;\n  }\n}\n","import { EventEmitter } from './EventEmitter';\n\nexport interface CarouselState {\n  currentIndex: number;\n  images: string[];\n  isPlaying: boolean;\n  isTransitioning: boolean;\n  effect: string;\n  transitionDuration: number;\n  autoplayInterval: number;\n  loop: boolean;\n}\n\nexport interface StateEvents extends Record<string, unknown[]> {\n  stateChange: [keyof CarouselState, unknown, unknown];\n  indexChange: [number, number];\n  playStateChange: [boolean];\n  transitionStart: [number, number];\n  transitionEnd: [number];\n}\n\nexport class StateManager extends EventEmitter<StateEvents> {\n  private state: CarouselState;\n\n  constructor(initialState: Partial<CarouselState> = {}) {\n    super();\n    this.state = {\n      currentIndex: 0,\n      images: [],\n      isPlaying: false,\n      isTransitioning: false,\n      effect: 'fade',\n      transitionDuration: 1000,\n      autoplayInterval: 3000,\n      loop: true,\n      ...initialState,\n    };\n  }\n\n  getState(): Readonly<CarouselState> {\n    return { ...this.state };\n  }\n\n  get<K extends keyof CarouselState>(key: K): CarouselState[K] {\n    return this.state[key];\n  }\n\n  set<K extends keyof CarouselState>(key: K, value: CarouselState[K]): void {\n    const oldValue = this.state[key];\n    if (oldValue !== value) {\n      this.state[key] = value;\n      this.emit('stateChange', key, oldValue, value);\n\n      // Emit specific events for certain state changes\n      if (key === 'currentIndex') {\n        this.emit('indexChange', oldValue as number, value as number);\n      } else if (key === 'isPlaying') {\n        this.emit('playStateChange', value as boolean);\n      }\n    }\n  }\n\n  update(updates: Partial<CarouselState>): void {\n    Object.entries(updates).forEach(([key, value]) => {\n      this.set(key as keyof CarouselState, value);\n    });\n  }\n\n  canGoNext(): boolean {\n    const { currentIndex, images, loop } = this.state;\n    return loop || currentIndex < images.length - 1;\n  }\n\n  canGoPrevious(): boolean {\n    const { currentIndex, loop } = this.state;\n    return loop || currentIndex > 0;\n  }\n\n  getNextIndex(): number {\n    const { currentIndex, images, loop } = this.state;\n    if (currentIndex === images.length - 1) {\n      return loop ? 0 : currentIndex;\n    }\n    return currentIndex + 1;\n  }\n\n  getPreviousIndex(): number {\n    const { currentIndex, images, loop } = this.state;\n    if (currentIndex === 0) {\n      return loop ? images.length - 1 : currentIndex;\n    }\n    return currentIndex - 1;\n  }\n\n  startTransition(toIndex: number): void {\n    if (!this.state.isTransitioning) {\n      const fromIndex = this.state.currentIndex;\n      this.set('isTransitioning', true);\n      this.emit('transitionStart', fromIndex, toIndex);\n    }\n  }\n\n  endTransition(newIndex: number): void {\n    if (this.state.isTransitioning) {\n      this.set('isTransitioning', false);\n      this.set('currentIndex', newIndex);\n      this.emit('transitionEnd', newIndex);\n    }\n  }\n\n  reset(): void {\n    this.update({\n      currentIndex: 0,\n      isPlaying: false,\n      isTransitioning: false,\n    });\n  }\n}\n","export interface LoadedImage {\n  url: string;\n  element: HTMLImageElement;\n  width: number;\n  height: number;\n  aspectRatio: number;\n}\n\nexport interface ImageLoaderOptions {\n  crossOrigin?: string;\n  timeout?: number;\n}\n\nexport class ImageLoader {\n  private cache: Map<string, LoadedImage> = new Map();\n  private loadingPromises: Map<string, Promise<LoadedImage>> = new Map();\n  private options: ImageLoaderOptions;\n\n  constructor(options: ImageLoaderOptions = {}) {\n    this.options = {\n      crossOrigin: 'anonymous',\n      timeout: 30000,\n      ...options,\n    };\n  }\n\n  async load(url: string): Promise<LoadedImage> {\n    // Check cache first\n    const cached = this.cache.get(url);\n    if (cached) {\n      return cached;\n    }\n\n    // Check if already loading\n    const loading = this.loadingPromises.get(url);\n    if (loading) {\n      return loading;\n    }\n\n    // Start new loading process\n    const loadPromise = this.loadImage(url);\n    this.loadingPromises.set(url, loadPromise);\n\n    try {\n      const loadedImage = await loadPromise;\n      this.cache.set(url, loadedImage);\n      this.loadingPromises.delete(url);\n      return loadedImage;\n    } catch (error) {\n      this.loadingPromises.delete(url);\n      throw error;\n    }\n  }\n\n  async preload(urls: string[]): Promise<LoadedImage[]> {\n    return Promise.all(urls.map((url) => this.load(url)));\n  }\n\n  async preloadWithProgress(\n    urls: string[],\n    onProgress?: (loaded: number, total: number) => void,\n  ): Promise<LoadedImage[]> {\n    const total = urls.length;\n    let loaded = 0;\n    const results: LoadedImage[] = [];\n\n    for (const url of urls) {\n      try {\n        const image = await this.load(url);\n        results.push(image);\n        loaded++;\n        onProgress?.(loaded, total);\n      } catch (error) {\n        // Create a placeholder image for failed loads\n        console.warn(`Failed to load image: ${url}`, error);\n\n        // Create a 1x1 transparent image as placeholder\n        const canvas = document.createElement('canvas');\n        canvas.width = 1;\n        canvas.height = 1;\n        const ctx = canvas.getContext('2d');\n        if (ctx) {\n          ctx.fillStyle = 'rgba(0, 0, 0, 0)';\n          ctx.fillRect(0, 0, 1, 1);\n        }\n\n        // Convert canvas to image element\n        const img = new Image();\n        img.src = canvas.toDataURL();\n\n        const placeholderImage: LoadedImage = {\n          url: url,\n          element: img,\n          width: 1,\n          height: 1,\n          aspectRatio: 1,\n        };\n\n        results.push(placeholderImage);\n        loaded++;\n        onProgress?.(loaded, total);\n      }\n    }\n\n    return results;\n  }\n\n  getFromCache(url: string): LoadedImage | null {\n    return this.cache.get(url) || null;\n  }\n\n  clearCache(url?: string): void {\n    if (url) {\n      this.cache.delete(url);\n      this.loadingPromises.delete(url);\n    } else {\n      this.cache.clear();\n      this.loadingPromises.clear();\n    }\n  }\n\n  getCacheSize(): number {\n    return this.cache.size;\n  }\n\n  private loadImage(url: string): Promise<LoadedImage> {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      let timeoutId: NodeJS.Timeout | null = null;\n\n      const cleanup = () => {\n        if (timeoutId) {\n          clearTimeout(timeoutId);\n          timeoutId = null;\n        }\n        img.onload = null;\n        img.onerror = null;\n      };\n\n      const handleLoad = () => {\n        cleanup();\n        const width = img.naturalWidth || img.width;\n        const height = img.naturalHeight || img.height;\n        resolve({\n          url,\n          element: img,\n          width,\n          height,\n          aspectRatio: width / height,\n        });\n      };\n\n      const handleError = (error?: Event | string) => {\n        cleanup();\n        reject(new Error(`Failed to load image: ${url}. ${error || ''}`));\n      };\n\n      // Set timeout\n      if (this.options.timeout && this.options.timeout > 0) {\n        timeoutId = setTimeout(() => {\n          handleError('Timeout');\n        }, this.options.timeout);\n      }\n\n      // Configure image\n      // Set crossOrigin before src to ensure CORS headers are requested\n      if (this.options.crossOrigin) {\n        img.crossOrigin = this.options.crossOrigin;\n      }\n\n      img.onload = handleLoad;\n      img.onerror = handleError;\n      img.src = url;\n    });\n  }\n}\n","import { EventEmitter } from './EventEmitter';\n\nexport interface WebGLRendererEvents extends Record<string, unknown[]> {\n  contextLost: [];\n  contextRestored: [];\n  error: [Error];\n}\n\nexport abstract class BaseWebGLRenderer<\n  TContext extends WebGLRenderingContext | WebGL2RenderingContext = WebGLRenderingContext\n> extends EventEmitter<WebGLRendererEvents> {\n  protected canvas: HTMLCanvasElement | null = null;\n  protected gl: TContext | null = null;\n  protected program: WebGLProgram | null = null;\n  protected textures: Map<string, WebGLTexture> = new Map();\n  protected imageSizes: Map<string, { width: number; height: number }> = new Map();\n  protected uniforms: Map<string, WebGLUniformLocation> = new Map();\n  protected attributes: Map<string, number> = new Map();\n\n  // Abstract methods that must be implemented by subclasses\n  abstract initialize(canvas: HTMLCanvasElement): boolean;\n  abstract setEffect(effect: { vertexShader: string; fragmentShader: string }): void;\n  abstract render(\n    currentTexture: WebGLTexture | null,\n    nextTexture: WebGLTexture | null,\n    progress: number,\n    additionalUniforms?: Record<string, number | number[] | Float32Array>,\n    currentImageSrc?: string,\n    nextImageSrc?: string,\n  ): void;\n  abstract dispose(): void;\n\n  // Common texture loading logic\n  loadTexture(image: HTMLImageElement): WebGLTexture | null {\n    if (!this.gl) return null;\n\n    const srcPreview = image.src.substring(0, 50) + '...';\n    \n    // Cache image size first (before checking for existing texture)\n    if (!this.imageSizes.has(image.src)) {\n      const imageSize = {\n        width: image.naturalWidth || image.width,\n        height: image.naturalHeight || image.height,\n      };\n      this.imageSizes.set(image.src, imageSize);\n    } else {\n      const cachedSize = this.imageSizes.get(image.src);\n    }\n\n    // Check if texture already exists\n    const existingTexture = this.textures.get(image.src);\n    if (existingTexture) {\n      return existingTexture;\n    }\n\n    const texture = this.createTexture(image);\n    if (texture) {\n      // Cache texture with image src as key\n      this.textures.set(image.src, texture);\n    }\n\n    return texture;\n  }\n\n  // Template method for texture creation - can be overridden by subclasses\n  protected createTexture(image: HTMLImageElement): WebGLTexture | null {\n    if (!this.gl) return null;\n\n    const texture = this.gl.createTexture();\n    if (!texture) return null;\n\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\n    this.gl.texImage2D(\n      this.gl.TEXTURE_2D,\n      0,\n      this.gl.RGBA,\n      this.gl.RGBA,\n      this.gl.UNSIGNED_BYTE,\n      image,\n    );\n\n    // Set texture parameters\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.LINEAR);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.LINEAR);\n\n    return texture;\n  }\n\n  // Common shader compilation logic\n  protected compileShader(source: string, type: number): WebGLShader | null {\n    if (!this.gl) return null;\n\n    const shader = this.gl.createShader(type);\n    if (!shader) {\n      throw new Error('Failed to create shader');\n    }\n\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n\n    if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n      const error = this.gl.getShaderInfoLog(shader);\n      this.gl.deleteShader(shader);\n      throw new Error(`Failed to compile shader: ${error}`);\n    }\n\n    return shader;\n  }\n\n  // Common program creation logic\n  protected createProgram(vertexSource: string, fragmentSource: string): WebGLProgram | null {\n    if (!this.gl) return null;\n\n    const vertexShader = this.compileShader(vertexSource, this.gl.VERTEX_SHADER);\n    const fragmentShader = this.compileShader(fragmentSource, this.gl.FRAGMENT_SHADER);\n\n    if (!vertexShader || !fragmentShader) return null;\n\n    const program = this.gl.createProgram();\n    if (!program) {\n      throw new Error('Failed to create shader program');\n    }\n\n    this.gl.attachShader(program, vertexShader);\n    this.gl.attachShader(program, fragmentShader);\n    this.gl.linkProgram(program);\n\n    if (!this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\n      const error = this.gl.getProgramInfoLog(program);\n      this.gl.deleteProgram(program);\n      throw new Error(`Failed to link shader program: ${error}`);\n    }\n\n    this.gl.deleteShader(vertexShader);\n    this.gl.deleteShader(fragmentShader);\n\n    return program;\n  }\n\n  // Common uniform and attribute caching logic\n  protected cacheUniformsAndAttributes(): void {\n    if (!this.gl || !this.program) return;\n\n    this.uniforms.clear();\n    this.attributes.clear();\n\n    // Get all active uniforms dynamically from the shader program\n    const numUniforms = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_UNIFORMS);\n\n    for (let i = 0; i < numUniforms; i++) {\n      const info = this.gl.getActiveUniform(this.program, i);\n      if (info) {\n        const location = this.gl.getUniformLocation(this.program, info.name);\n        if (location) {\n          this.uniforms.set(info.name, location);\n        }\n      }\n    }\n\n    // Get all active attributes dynamically from the shader program\n    const numAttributes = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_ATTRIBUTES);\n\n    for (let i = 0; i < numAttributes; i++) {\n      const info = this.gl.getActiveAttrib(this.program, i);\n      if (info) {\n        const location = this.gl.getAttribLocation(this.program, info.name);\n        if (location >= 0) {\n          this.attributes.set(info.name, location);\n        }\n      }\n    }\n  }\n\n  // Common resize logic\n  resize(width: number, height: number): void {\n    if (!this.gl || !this.canvas) return;\n\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.gl.viewport(0, 0, width, height);\n  }\n\n  // Common context lost/restored handlers\n  protected handleContextLost = (event: Event): void => {\n    event.preventDefault();\n    this.emit('contextLost');\n  };\n\n  protected handleContextRestored = (): void => {\n    this.initialize(this.canvas!);\n    this.emit('contextRestored');\n  };\n\n  // Common image size uniform setting logic\n  protected setImageSizeUniforms(\n    currentImageSrc?: string,\n    nextImageSrc?: string,\n  ): void {\n    if (!this.gl || !this.canvas) return;\n\n    const imageSize0Loc = this.uniforms.get('uImageSize0');\n    const imageSize1Loc = this.uniforms.get('uImageSize1');\n\n    if (imageSize0Loc) {\n      const size = currentImageSrc ? this.imageSizes.get(currentImageSrc) : null;\n      if (size && size.width > 0 && size.height > 0) {\n        this.gl.uniform2f(imageSize0Loc, size.width, size.height);\n      } else {\n        // Default to a square aspect ratio instead of canvas size\n        const defaultSize = Math.min(this.canvas.width, this.canvas.height);\n        this.gl.uniform2f(imageSize0Loc, defaultSize, defaultSize);\n      }\n    }\n\n    if (imageSize1Loc) {\n      let size = null;\n      if (nextImageSrc) {\n        size = this.imageSizes.get(nextImageSrc);\n      } else if (currentImageSrc) {\n        // For initial render, use the same image size for both textures\n        size = this.imageSizes.get(currentImageSrc);\n      }\n      \n      if (size && size.width > 0 && size.height > 0) {\n        this.gl.uniform2f(imageSize1Loc, size.width, size.height);\n      } else {\n        // Default to a square aspect ratio instead of canvas size\n        const defaultSize = Math.min(this.canvas.width, this.canvas.height);\n        this.gl.uniform2f(imageSize1Loc, defaultSize, defaultSize);\n      }\n    }\n  }\n\n  // Common cleanup logic\n  protected disposeCommon(): void {\n    if (!this.gl) return;\n\n    // Delete textures\n    this.textures.forEach((texture) => {\n      this.gl!.deleteTexture(texture);\n    });\n    this.textures.clear();\n    this.imageSizes.clear();\n\n    // Delete program\n    if (this.program) {\n      this.gl.deleteProgram(this.program);\n      this.program = null;\n    }\n\n    // Remove event listeners\n    if (this.canvas) {\n      this.canvas.removeEventListener('webglcontextlost', this.handleContextLost);\n      this.canvas.removeEventListener('webglcontextrestored', this.handleContextRestored);\n    }\n\n    this.gl = null;\n    this.canvas = null;\n    this.removeAllListeners();\n  }\n\n  isInitialized(): boolean {\n    return this.gl !== null && this.program !== null;\n  }\n\n  getContext(): TContext | null {\n    return this.gl;\n  }\n}","import { BaseWebGLRenderer } from './BaseWebGLRenderer';\n\nexport interface WebGLRendererOptions {\n  antialias?: boolean;\n  alpha?: boolean;\n  premultipliedAlpha?: boolean;\n  preserveDrawingBuffer?: boolean;\n}\n\nexport class WebGLRenderer extends BaseWebGLRenderer<WebGLRenderingContext> {\n  private vertexBuffer: WebGLBuffer | null = null;\n  private options: WebGLRendererOptions;\n\n  constructor(options: WebGLRendererOptions = {}) {\n    super();\n    this.options = {\n      antialias: true,\n      alpha: true,\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: false,\n      ...options,\n    };\n  }\n\n  initialize(canvas: HTMLCanvasElement): boolean {\n    this.canvas = canvas;\n\n    try {\n      this.gl =\n        (canvas.getContext('webgl', this.options) as WebGLRenderingContext | null) ||\n        (canvas.getContext('experimental-webgl', this.options) as WebGLRenderingContext | null);\n\n      if (!this.gl) {\n        throw new Error('WebGL not supported');\n      }\n\n      this.setupEventListeners();\n      this.initializeVertexBuffer();\n      this.setDefaultEffect();\n\n      return true;\n    } catch (error) {\n      this.emit('error', error as Error);\n      return false;\n    }\n  }\n\n  private setupEventListeners(): void {\n    if (!this.canvas) return;\n\n    this.canvas.addEventListener('webglcontextlost', this.handleContextLost);\n    this.canvas.addEventListener('webglcontextrestored', this.handleContextRestored);\n  }\n\n  private initializeVertexBuffer(): void {\n    if (!this.gl) return;\n\n    // Y texture coordinates are flipped to correct for WebGL's coordinate system\n    const vertices = new Float32Array([\n      -1.0,\n      -1.0,\n      0.0,\n      1.0, // Bottom-left\n      1.0,\n      -1.0,\n      1.0,\n      1.0, // Bottom-right\n      -1.0,\n      1.0,\n      0.0,\n      0.0, // Top-left\n      1.0,\n      1.0,\n      1.0,\n      0.0, // Top-right\n    ]);\n\n    this.vertexBuffer = this.gl.createBuffer();\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuffer);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, vertices, this.gl.STATIC_DRAW);\n  }\n\n  private setDefaultEffect(): void {\n    const vertexShader = `\n      attribute vec2 aPosition;\n      attribute vec2 aTexCoord;\n      uniform vec2 uResolution;\n      uniform vec2 uImageSize0;\n      uniform vec2 uImageSize1;\n      varying vec2 vTexCoord;\n      \n      void main() {\n        gl_Position = vec4(aPosition, 0.0, 1.0);\n        vTexCoord = aTexCoord;\n      }\n    `;\n\n    const fragmentShader = `\n      precision mediump float;\n      \n      uniform sampler2D uTexture0;\n      uniform sampler2D uTexture1;\n      uniform float uProgress;\n      uniform vec2 uResolution;\n      uniform vec2 uImageSize0;\n      uniform vec2 uImageSize1;\n      \n      varying vec2 vTexCoord;\n      \n      // getCoverUV function for proper aspect ratio handling\n      vec2 getCoverUV(vec2 uv, vec2 imageSize, vec2 resolution) {\n        float imageAspect = imageSize.x / imageSize.y;\n        float screenAspect = resolution.x / resolution.y;\n        vec2 scale;\n        \n        if (screenAspect > imageAspect) {\n          scale = vec2(1.0, imageAspect / screenAspect);\n        } else {\n          scale = vec2(screenAspect / imageAspect, 1.0);\n        }\n        \n        return (uv - 0.5) / scale + 0.5;\n      }\n      \n      void main() {\n        vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n        vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n        \n        vec4 color0 = texture2D(uTexture0, uv0);\n        vec4 color1 = texture2D(uTexture1, uv1);\n        gl_FragColor = mix(color0, color1, uProgress);\n      }\n    `;\n\n    this.setEffect({ vertexShader, fragmentShader });\n  }\n\n  setEffect(effect: { vertexShader: string; fragmentShader: string }): void {\n    if (!this.gl) return;\n\n    try {\n      const program = super.createProgram(effect.vertexShader, effect.fragmentShader);\n      if (program) {\n        if (this.program) {\n          this.gl.deleteProgram(this.program);\n        }\n        this.program = program;\n        super.cacheUniformsAndAttributes();\n      }\n    } catch (error) {\n      this.emit('error', error as Error);\n    }\n  }\n\n\n\n\n\n  render(\n    currentTexture: WebGLTexture | null,\n    nextTexture: WebGLTexture | null,\n    progress: number,\n    additionalUniforms?: Record<string, number | number[] | Float32Array>,\n    currentImageSrc?: string,\n    nextImageSrc?: string,\n  ): void {\n    if (!this.gl || !this.program || !currentTexture) return;\n\n    this.gl.useProgram(this.program);\n\n    // Clear\n    this.gl.clearColor(0, 0, 0, 0);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n\n    // Bind vertex buffer\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuffer);\n\n    // Set attributes\n    const positionLoc = this.attributes.get('aPosition');\n    const texCoordLoc = this.attributes.get('aTexCoord');\n\n    if (positionLoc !== undefined) {\n      this.gl.enableVertexAttribArray(positionLoc);\n      this.gl.vertexAttribPointer(positionLoc, 2, this.gl.FLOAT, false, 4 * 4, 0);\n    }\n\n    if (texCoordLoc !== undefined) {\n      this.gl.enableVertexAttribArray(texCoordLoc);\n      this.gl.vertexAttribPointer(texCoordLoc, 2, this.gl.FLOAT, false, 4 * 4, 2 * 4);\n    }\n\n    // Bind textures\n    this.gl.activeTexture(this.gl.TEXTURE0);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, currentTexture);\n\n    // Bind texture1 - nextTexture if available, otherwise bind current texture\n    this.gl.activeTexture(this.gl.TEXTURE1);\n    if (nextTexture) {\n      this.gl.bindTexture(this.gl.TEXTURE_2D, nextTexture);\n    } else {\n      // For single texture rendering, bind currentTexture to both slots\n      this.gl.bindTexture(this.gl.TEXTURE_2D, currentTexture);\n    }\n\n    // Set uniforms\n    const texture0Loc = this.uniforms.get('uTexture0');\n    const texture1Loc = this.uniforms.get('uTexture1');\n    const progressLoc = this.uniforms.get('uProgress');\n\n    if (texture0Loc) this.gl.uniform1i(texture0Loc, 0);\n    if (texture1Loc) this.gl.uniform1i(texture1Loc, 1);\n    if (progressLoc) this.gl.uniform1f(progressLoc, progress);\n\n    // Set resolution uniform if available\n    const resolutionLoc = this.uniforms.get('uResolution');\n    if (resolutionLoc && this.canvas) {\n      this.gl.uniform2f(resolutionLoc, this.canvas.width, this.canvas.height);\n    }\n\n    // Set image size uniforms\n    super.setImageSizeUniforms(currentImageSrc, nextImageSrc);\n\n    // Set additional uniforms\n    if (additionalUniforms) {\n      Object.entries(additionalUniforms).forEach(([name, value]) => {\n        const location = this.gl!.getUniformLocation(this.program!, name);\n        if (location) {\n          if (Array.isArray(value) || value instanceof Float32Array) {\n            const len = value.length;\n            switch (len) {\n              case 2:\n                this.gl!.uniform2fv(location, value as Float32Array | number[]);\n                break;\n              case 3:\n                this.gl!.uniform3fv(location, value as Float32Array | number[]);\n                break;\n              case 4:\n                this.gl!.uniform4fv(location, value as Float32Array | number[]);\n                break;\n              default:\n                if (len === 1) {\n                  this.gl!.uniform1f(location, (value as number[])[0] ?? 0);\n                }\n                break;\n            }\n          } else if (typeof value === 'number') {\n            this.gl!.uniform1f(location, value);\n          }\n        }\n      });\n    }\n\n    // Draw\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\n  }\n\n\n  dispose(): void {\n    if (!this.gl) return;\n\n    // Delete vertex buffer\n    if (this.vertexBuffer) {\n      this.gl.deleteBuffer(this.vertexBuffer);\n      this.vertexBuffer = null;\n    }\n\n    // Call parent dispose\n    super.disposeCommon();\n  }\n\n}\n","import { BaseWebGLRenderer } from './BaseWebGLRenderer';\n\nexport interface WebGL2RendererOptions {\n  antialias?: boolean;\n  alpha?: boolean;\n  premultipliedAlpha?: boolean;\n  preserveDrawingBuffer?: boolean;\n  powerPreference?: 'default' | 'high-performance' | 'low-power';\n}\n\nexport interface MeshData {\n  vertices: Float32Array;\n  indices: Uint16Array;\n  normals?: Float32Array;\n  texCoords: Float32Array;\n  instanceData?: Float32Array;\n}\n\nexport interface TransformFeedbackData {\n  buffers: WebGLBuffer[];\n  varyings: string[];\n}\n\nexport class WebGL2Renderer extends BaseWebGLRenderer<WebGL2RenderingContext> {\n  private vertexArray: WebGLVertexArrayObject | null = null;\n  private vertexBuffer: WebGLBuffer | null = null;\n  private indexBuffer: WebGLBuffer | null = null;\n  private uniformBlockIndices: Map<string, number> = new Map();\n  private options: WebGL2RendererOptions;\n  private meshData: MeshData | null = null;\n  private transformFeedback: WebGLTransformFeedback | null = null;\n  private computeTextures: Map<string, WebGLTexture> = new Map();\n\n  constructor(options: WebGL2RendererOptions = {}) {\n    super();\n    this.options = {\n      antialias: true,\n      alpha: true,\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: false,\n      powerPreference: 'high-performance',\n      ...options,\n    };\n  }\n\n  initialize(canvas: HTMLCanvasElement): boolean {\n    this.canvas = canvas;\n\n    try {\n      this.gl = canvas.getContext('webgl2', this.options) as WebGL2RenderingContext | null;\n\n      if (!this.gl) {\n        throw new Error('WebGL 2.0 not supported');\n      }\n\n      // Enable WebGL 2.0 features\n      this.gl.enable(this.gl.DEPTH_TEST);\n      this.gl.enable(this.gl.CULL_FACE);\n      this.gl.cullFace(this.gl.BACK);\n\n      this.setupEventListeners();\n      this.initializeDefaultMesh();\n      this.setDefaultEffect();\n\n      return true;\n    } catch (error) {\n      this.emit('error', error as Error);\n      return false;\n    }\n  }\n\n  private setupEventListeners(): void {\n    if (!this.canvas) return;\n\n    this.canvas.addEventListener('webglcontextlost', this.handleContextLost);\n    this.canvas.addEventListener('webglcontextrestored', this.handleContextRestored);\n  }\n\n  private initializeDefaultMesh(): void {\n    if (!this.gl) return;\n\n    // Create VAO\n    this.vertexArray = this.gl.createVertexArray();\n    this.gl.bindVertexArray(this.vertexArray);\n\n    // Default quad mesh\n    const vertices = new Float32Array([\n      -1.0,\n      -1.0,\n      0.0, // Position\n      0.0,\n      1.0, // TexCoord (flipped Y)\n      1.0,\n      -1.0,\n      0.0, // Position\n      1.0,\n      1.0, // TexCoord\n      -1.0,\n      1.0,\n      0.0, // Position\n      0.0,\n      0.0, // TexCoord\n      1.0,\n      1.0,\n      0.0, // Position\n      1.0,\n      0.0, // TexCoord\n    ]);\n\n    const indices = new Uint16Array([0, 1, 2, 2, 1, 3]);\n\n    this.vertexBuffer = this.gl.createBuffer();\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuffer);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, vertices, this.gl.STATIC_DRAW);\n\n    this.indexBuffer = this.gl.createBuffer();\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n    this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, indices, this.gl.STATIC_DRAW);\n\n    this.meshData = {\n      vertices,\n      indices,\n      texCoords: new Float32Array([0, 1, 1, 1, 0, 0, 1, 0]),\n    };\n\n    // Don't set up vertex attributes here - wait until shader is loaded\n    // Attributes will be set up in setupMeshAttributes() after shader program is created\n\n    // Unbind VAO\n    this.gl.bindVertexArray(null);\n  }\n\n  setMesh(meshData: MeshData): void {\n    if (!this.gl) return;\n\n    this.meshData = meshData;\n\n    // Create new VAO for custom mesh\n    if (this.vertexArray) {\n      this.gl.deleteVertexArray(this.vertexArray);\n    }\n    this.vertexArray = this.gl.createVertexArray();\n    this.gl.bindVertexArray(this.vertexArray);\n\n    // Upload vertex data\n    if (this.vertexBuffer) {\n      this.gl.deleteBuffer(this.vertexBuffer);\n    }\n    this.vertexBuffer = this.gl.createBuffer();\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuffer);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, meshData.vertices, this.gl.DYNAMIC_DRAW);\n\n    // Upload index data\n    if (this.indexBuffer) {\n      this.gl.deleteBuffer(this.indexBuffer);\n    }\n    this.indexBuffer = this.gl.createBuffer();\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n    this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, meshData.indices, this.gl.STATIC_DRAW);\n\n    // Setup attributes based on current program\n    if (this.program) {\n      this.setupMeshAttributes();\n    }\n\n    this.gl.bindVertexArray(null);\n  }\n\n  private setupMeshAttributes(): void {\n    if (!this.gl || !this.program || !this.meshData) return;\n\n    const stride = 5 * 4; // 3 for position, 2 for texCoord\n\n    // Position attribute\n    const positionLoc = this.gl.getAttribLocation(this.program, 'aPosition');\n\n    if (positionLoc >= 0) {\n      this.gl.enableVertexAttribArray(positionLoc);\n      this.gl.vertexAttribPointer(positionLoc, 3, this.gl.FLOAT, false, stride, 0);\n    } else {\n      console.error('[WebGL2Renderer.setupMeshAttributes] aPosition not found in shader!');\n    }\n\n    // TexCoord attribute\n    const texCoordLoc = this.gl.getAttribLocation(this.program, 'aTexCoord');\n\n    if (texCoordLoc >= 0) {\n      this.gl.enableVertexAttribArray(texCoordLoc);\n      this.gl.vertexAttribPointer(texCoordLoc, 2, this.gl.FLOAT, false, stride, 3 * 4);\n    } else {\n      console.error('[WebGL2Renderer.setupMeshAttributes] aTexCoord not found in shader!');\n    }\n\n    // Instance attributes if available\n    if (this.meshData.instanceData) {\n      const instanceBuffer = this.gl.createBuffer();\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, instanceBuffer);\n      this.gl.bufferData(this.gl.ARRAY_BUFFER, this.meshData.instanceData, this.gl.DYNAMIC_DRAW);\n\n      // Each instance has 12 floats: 3 for position, 4 for rotation, 2 for scale, 3 for extra\n      const stride = 12 * 4; // 12 floats * 4 bytes per float\n\n      // Instance position (vec3)\n      const positionLoc = this.gl.getAttribLocation(this.program, 'aInstancePosition');\n      if (positionLoc >= 0) {\n        this.gl.enableVertexAttribArray(positionLoc);\n        this.gl.vertexAttribPointer(positionLoc, 3, this.gl.FLOAT, false, stride, 0);\n        this.gl.vertexAttribDivisor(positionLoc, 1);\n      }\n\n      // Instance rotation (vec4 - quaternion)\n      const rotationLoc = this.gl.getAttribLocation(this.program, 'aInstanceRotation');\n      if (rotationLoc >= 0) {\n        this.gl.enableVertexAttribArray(rotationLoc);\n        this.gl.vertexAttribPointer(rotationLoc, 4, this.gl.FLOAT, false, stride, 3 * 4);\n        this.gl.vertexAttribDivisor(rotationLoc, 1);\n      }\n\n      // Instance scale (vec2)\n      const scaleLoc = this.gl.getAttribLocation(this.program, 'aInstanceScale');\n      if (scaleLoc >= 0) {\n        this.gl.enableVertexAttribArray(scaleLoc);\n        this.gl.vertexAttribPointer(scaleLoc, 2, this.gl.FLOAT, false, stride, 7 * 4);\n        this.gl.vertexAttribDivisor(scaleLoc, 1);\n      }\n\n      // Instance extra (vec3)\n      const extraLoc = this.gl.getAttribLocation(this.program, 'aInstanceExtra');\n      if (extraLoc >= 0) {\n        this.gl.enableVertexAttribArray(extraLoc);\n        this.gl.vertexAttribPointer(extraLoc, 3, this.gl.FLOAT, false, stride, 9 * 4);\n        this.gl.vertexAttribDivisor(extraLoc, 1);\n      }\n    }\n  }\n\n  private setDefaultEffect(): void {\n    const vertexShader = `#version 300 es\n      in vec3 aPosition;\n      in vec2 aTexCoord;\n      \n      uniform vec2 uResolution;\n      uniform vec2 uImageSize0;\n      uniform vec2 uImageSize1;\n      uniform mat4 uProjectionMatrix;\n      uniform mat4 uModelViewMatrix;\n      \n      out vec2 vTexCoord;\n      \n      void main() {\n        gl_Position = vec4(aPosition.xy, 0.0, 1.0);\n        vTexCoord = aTexCoord;\n      }\n    `;\n\n    const fragmentShader = `#version 300 es\n      precision highp float;\n      \n      uniform sampler2D uTexture0;\n      uniform sampler2D uTexture1;\n      uniform float uProgress;\n      uniform vec2 uResolution;\n      uniform vec2 uImageSize0;\n      uniform vec2 uImageSize1;\n      \n      in vec2 vTexCoord;\n      out vec4 fragColor;\n      \n      // getCoverUV function for proper aspect ratio handling\n      vec2 getCoverUV(vec2 uv, vec2 imageSize, vec2 resolution) {\n        float imageAspect = imageSize.x / imageSize.y;\n        float screenAspect = resolution.x / resolution.y;\n        vec2 scale;\n        \n        if (screenAspect > imageAspect) {\n          scale = vec2(1.0, imageAspect / screenAspect);\n        } else {\n          scale = vec2(screenAspect / imageAspect, 1.0);\n        }\n        \n        return (uv - 0.5) / scale + 0.5;\n      }\n      \n      void main() {\n        vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n        vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n        \n        vec4 color0 = texture(uTexture0, uv0);\n        vec4 color1 = texture(uTexture1, uv1);\n        fragColor = mix(color0, color1, uProgress);\n      }\n    `;\n\n    this.setEffect({ vertexShader, fragmentShader });\n  }\n\n  setEffect(effect: {\n    vertexShader: string;\n    fragmentShader: string;\n    transformFeedbackVaryings?: string[];\n  }): void {\n    if (!this.gl) return;\n\n    try {\n      // Convert WebGL 1.0 shaders to WebGL 2.0 if needed\n      let vertexShader = effect.vertexShader;\n      let fragmentShader = effect.fragmentShader;\n\n      // Check if shaders are WebGL 1.0 style (no version directive)\n      if (!vertexShader.includes('#version')) {\n        vertexShader = this.convertVertexShaderToWebGL2(vertexShader);\n      }\n      if (!fragmentShader.includes('#version')) {\n        fragmentShader = this.convertFragmentShaderToWebGL2(fragmentShader);\n      }\n\n\n      const program = effect.transformFeedbackVaryings \n        ? this.createProgram(vertexShader, fragmentShader, effect.transformFeedbackVaryings)\n        : super.createProgram(vertexShader, fragmentShader);\n      if (program) {\n        if (this.program) {\n          this.gl.deleteProgram(this.program);\n        }\n        this.program = program;\n        super.cacheUniformsAndAttributes();\n\n        // Re-setup mesh attributes with new program\n        if (this.vertexArray && this.meshData) {\n          this.gl.bindVertexArray(this.vertexArray);\n          this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuffer);\n          this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n          this.setupMeshAttributes();\n          this.gl.bindVertexArray(null);\n        }\n      }\n    } catch (error) {\n      this.emit('error', error as Error);\n    }\n  }\n\n  // Override to support transform feedback\n  protected createProgram(\n    vertexSource: string,\n    fragmentSource: string,\n    transformFeedbackVaryings?: string[],\n  ): WebGLProgram | null {\n    if (!this.gl) return null;\n\n    const vertexShader = this.compileShader(vertexSource, this.gl.VERTEX_SHADER);\n    const fragmentShader = this.compileShader(fragmentSource, this.gl.FRAGMENT_SHADER);\n\n    if (!vertexShader || !fragmentShader) return null;\n\n    const program = this.gl.createProgram();\n    if (!program) {\n      throw new Error('Failed to create shader program');\n    }\n\n    this.gl.attachShader(program, vertexShader);\n    this.gl.attachShader(program, fragmentShader);\n\n    // Setup transform feedback if specified\n    if (transformFeedbackVaryings && transformFeedbackVaryings.length > 0) {\n      this.gl.transformFeedbackVaryings(\n        program,\n        transformFeedbackVaryings,\n        this.gl.INTERLEAVED_ATTRIBS,\n      );\n    }\n\n    this.gl.linkProgram(program);\n\n    if (!this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\n      const error = this.gl.getProgramInfoLog(program);\n      this.gl.deleteProgram(program);\n      throw new Error(`Failed to link shader program: ${error}`);\n    }\n\n    this.gl.deleteShader(vertexShader);\n    this.gl.deleteShader(fragmentShader);\n\n    return program;\n  }\n\n  private compileShader(source: string, type: number): WebGLShader | null {\n    if (!this.gl) return null;\n\n    const shader = this.gl.createShader(type);\n    if (!shader) {\n      throw new Error('Failed to create shader');\n    }\n\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n\n    if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n      const error = this.gl.getShaderInfoLog(shader);\n      console.error('[WebGL2Renderer] Shader compilation error:', error);\n      this.gl.deleteShader(shader);\n      throw new Error(`Failed to compile shader: ${error}`);\n    }\n\n    return shader;\n  }\n\n  private cacheUniformsAndAttributes(): void {\n    if (!this.gl || !this.program) return;\n\n    this.uniforms.clear();\n    this.attributes.clear();\n    this.uniformBlockIndices.clear();\n\n    // Get all active uniforms\n    const numUniforms = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_UNIFORMS);\n\n    for (let i = 0; i < numUniforms; i++) {\n      const info = this.gl.getActiveUniform(this.program, i);\n      if (info) {\n        const location = this.gl.getUniformLocation(this.program, info.name);\n        if (location) {\n          this.uniforms.set(info.name, location);\n        }\n      }\n    }\n\n    // Get all active attributes\n    const numAttributes = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_ATTRIBUTES);\n\n    for (let i = 0; i < numAttributes; i++) {\n      const info = this.gl.getActiveAttrib(this.program, i);\n      if (info) {\n        const location = this.gl.getAttribLocation(this.program, info.name);\n        if (location >= 0) {\n          this.attributes.set(info.name, location);\n        }\n      }\n    }\n\n    // Cache uniform block indices\n    const numUniformBlocks = this.gl.getProgramParameter(\n      this.program,\n      this.gl.ACTIVE_UNIFORM_BLOCKS,\n    );\n    for (let i = 0; i < numUniformBlocks; i++) {\n      const name = this.gl.getActiveUniformBlockName(this.program, i);\n      if (name) {\n        const index = this.gl.getUniformBlockIndex(this.program, name);\n        this.uniformBlockIndices.set(name, index);\n      }\n    }\n  }\n\n  // Override to add WebGL2-specific texture features\n  protected createTexture(image: HTMLImageElement): WebGLTexture | null {\n    if (!this.gl) return null;\n\n    const texture = this.gl.createTexture();\n    if (!texture) return null;\n\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\n\n    try {\n      this.gl.texImage2D(\n        this.gl.TEXTURE_2D,\n        0,\n        this.gl.RGBA,\n        this.gl.RGBA,\n        this.gl.UNSIGNED_BYTE,\n        image,\n      );\n    } catch (error) {\n      console.error('[WebGL2Renderer.createTexture] Failed to create texture:', error);\n      this.gl.deleteTexture(texture);\n      return null;\n    }\n\n    // Generate mipmaps\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\n\n    // Set texture parameters\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(\n      this.gl.TEXTURE_2D,\n      this.gl.TEXTURE_MIN_FILTER,\n      this.gl.LINEAR_MIPMAP_LINEAR,\n    );\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.LINEAR);\n\n    // Enable anisotropic filtering if available\n    const ext = this.gl.getExtension('EXT_texture_filter_anisotropic');\n    if (ext) {\n      const maxAnisotropy = this.gl.getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\n      this.gl.texParameterf(this.gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, maxAnisotropy);\n    }\n\n    return texture;\n  }\n\n  createComputeTexture(width: number, height: number, data?: Float32Array): WebGLTexture | null {\n    if (!this.gl) return null;\n\n    const texture = this.gl.createTexture();\n    if (!texture) return null;\n\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\n    this.gl.texImage2D(\n      this.gl.TEXTURE_2D,\n      0,\n      this.gl.RGBA32F,\n      width,\n      height,\n      0,\n      this.gl.RGBA,\n      this.gl.FLOAT,\n      data || null,\n    );\n\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\n\n    return texture;\n  }\n\n  setupTransformFeedback(buffers: WebGLBuffer[], _varyings: string[]): void {\n    if (!this.gl) return;\n\n    if (this.transformFeedback) {\n      this.gl.deleteTransformFeedback(this.transformFeedback);\n    }\n\n    this.transformFeedback = this.gl.createTransformFeedback();\n    this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK, this.transformFeedback);\n\n    buffers.forEach((buffer, index) => {\n      this.gl!.bindBufferBase(this.gl!.TRANSFORM_FEEDBACK_BUFFER, index, buffer);\n    });\n\n    this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK, null);\n  }\n\n  render(\n    currentTexture: WebGLTexture | null,\n    nextTexture: WebGLTexture | null,\n    progress: number,\n    additionalUniforms?: Record<string, number | number[] | Float32Array>,\n    currentImageSrc?: string,\n    nextImageSrc?: string,\n    instanceCount?: number,\n  ): void {\n    if (!this.gl || !this.program || !currentTexture || !this.vertexArray) {\n      console.error('[WebGL2Renderer.render] Missing required resources:', {\n        gl: !!this.gl,\n        program: !!this.program,\n        currentTexture: !!currentTexture,\n        vertexArray: !!this.vertexArray,\n      });\n      return;\n    }\n\n    this.gl.useProgram(this.program);\n    this.gl.bindVertexArray(this.vertexArray);\n\n    // Clear\n    this.gl.clearColor(0, 0, 0, 0);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n\n    // Bind textures\n    this.gl.activeTexture(this.gl.TEXTURE0);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, currentTexture);\n\n    if (nextTexture) {\n      this.gl.activeTexture(this.gl.TEXTURE1);\n      this.gl.bindTexture(this.gl.TEXTURE_2D, nextTexture);\n    }\n\n    // Set uniforms\n    const texture0Loc = this.uniforms.get('uTexture0');\n    const texture1Loc = this.uniforms.get('uTexture1');\n    const progressLoc = this.uniforms.get('uProgress');\n\n    if (texture0Loc) this.gl.uniform1i(texture0Loc, 0);\n    if (texture1Loc) this.gl.uniform1i(texture1Loc, 1);\n    if (progressLoc) this.gl.uniform1f(progressLoc, progress);\n\n    // Set resolution uniform if available\n    const resolutionLoc = this.uniforms.get('uResolution');\n    if (resolutionLoc && this.canvas) {\n      this.gl.uniform2f(resolutionLoc, this.canvas.width, this.canvas.height);\n    }\n\n    // Set image size uniforms\n    super.setImageSizeUniforms(currentImageSrc, nextImageSrc);\n\n    // Set additional uniforms\n    if (additionalUniforms) {\n      Object.entries(additionalUniforms).forEach(([name, value]) => {\n        const location = this.uniforms.get(name);\n        if (location) {\n          if (value instanceof Float32Array) {\n            switch (value.length) {\n              case 16:\n                this.gl!.uniformMatrix4fv(location, false, value);\n                break;\n              case 9:\n                this.gl!.uniformMatrix3fv(location, false, value);\n                break;\n              case 4:\n                this.gl!.uniform4fv(location, value);\n                break;\n              case 3:\n                this.gl!.uniform3fv(location, value);\n                break;\n              case 2:\n                this.gl!.uniform2fv(location, value);\n                break;\n              default:\n                this.gl!.uniform1fv(location, value);\n            }\n          } else if (Array.isArray(value)) {\n            switch (value.length) {\n              case 2:\n                this.gl!.uniform2fv(location, value);\n                break;\n              case 3:\n                this.gl!.uniform3fv(location, value);\n                break;\n              case 4:\n                this.gl!.uniform4fv(location, value);\n                break;\n            }\n          } else {\n            this.gl!.uniform1f(location, value);\n          }\n        }\n      });\n    }\n\n    // Draw\n\n    try {\n      if (this.meshData) {\n        if (instanceCount && instanceCount > 1) {\n          this.gl.drawElementsInstanced(\n            this.gl.TRIANGLES,\n            this.meshData.indices.length,\n            this.gl.UNSIGNED_SHORT,\n            0,\n            instanceCount,\n          );\n        } else {\n          this.gl.drawElements(\n            this.gl.TRIANGLES,\n            this.meshData.indices.length,\n            this.gl.UNSIGNED_SHORT,\n            0,\n          );\n        }\n      } else {\n        this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\n      }\n\n      // Check for GL errors\n      const error = this.gl.getError();\n      if (error !== this.gl.NO_ERROR) {\n        let errorString = 'Unknown error';\n        switch (error) {\n          case this.gl.INVALID_ENUM:\n            errorString = 'INVALID_ENUM';\n            break;\n          case this.gl.INVALID_VALUE:\n            errorString = 'INVALID_VALUE';\n            break;\n          case this.gl.INVALID_OPERATION:\n            errorString = 'INVALID_OPERATION';\n            break;\n          case this.gl.INVALID_FRAMEBUFFER_OPERATION:\n            errorString = 'INVALID_FRAMEBUFFER_OPERATION';\n            break;\n          case this.gl.OUT_OF_MEMORY:\n            errorString = 'OUT_OF_MEMORY';\n            break;\n        }\n        console.error(`[WebGL2Renderer.render] GL Error: ${error} (${errorString})`);\n      }\n    } catch (error) {\n      console.error('[WebGL2Renderer.render] Draw error:', error);\n      throw error;\n    }\n\n    this.gl.bindVertexArray(null);\n  }\n\n  renderWithTransformFeedback(\n    currentTexture: WebGLTexture | null,\n    nextTexture: WebGLTexture | null,\n    progress: number,\n    additionalUniforms?: Record<string, number | number[] | Float32Array>,\n  ): void {\n    if (!this.gl || !this.program || !this.transformFeedback) return;\n\n    this.gl.enable(this.gl.RASTERIZER_DISCARD);\n    this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK, this.transformFeedback);\n    this.gl.beginTransformFeedback(this.gl.POINTS);\n\n    this.render(currentTexture, nextTexture, progress, additionalUniforms);\n\n    this.gl.endTransformFeedback();\n    this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK, null);\n    this.gl.disable(this.gl.RASTERIZER_DISCARD);\n  }\n\n  dispose(): void {\n    if (!this.gl) return;\n\n    // Delete WebGL 2.0 specific resources\n    this.computeTextures.forEach((texture) => {\n      this.gl!.deleteTexture(texture);\n    });\n    this.computeTextures.clear();\n\n    // Delete buffers\n    if (this.vertexBuffer) {\n      this.gl.deleteBuffer(this.vertexBuffer);\n      this.vertexBuffer = null;\n    }\n\n    if (this.indexBuffer) {\n      this.gl.deleteBuffer(this.indexBuffer);\n      this.indexBuffer = null;\n    }\n\n    // Delete VAO\n    if (this.vertexArray) {\n      this.gl.deleteVertexArray(this.vertexArray);\n      this.vertexArray = null;\n    }\n\n    // Delete transform feedback\n    if (this.transformFeedback) {\n      this.gl.deleteTransformFeedback(this.transformFeedback);\n      this.transformFeedback = null;\n    }\n\n    // Call parent dispose\n    super.disposeCommon();\n  }\n\n  isInitialized(): boolean {\n    return super.isInitialized() && this.vertexArray !== null;\n  }\n\n  isWebGL2(): boolean {\n    return true;\n  }\n\n  private convertVertexShaderToWebGL2(shader: string): string {\n    let converted = shader;\n\n    // Remove any existing precision declarations first\n    converted = converted.replace(/precision\\s+\\w+\\s+float\\s*;/g, '');\n\n    // Add version and precision at the beginning\n    converted = '#version 300 es\\nprecision highp float;\\n' + converted;\n\n    // Convert attribute to in\n    converted = converted.replace(/\\battribute\\s+/g, 'in ');\n\n    // Convert varying to out\n    converted = converted.replace(/\\bvarying\\s+/g, 'out ');\n\n    return converted;\n  }\n\n  private convertFragmentShaderToWebGL2(shader: string): string {\n    let converted = shader;\n\n    // Remove any existing precision declarations first\n    converted = converted.replace(/precision\\s+\\w+\\s+float\\s*;/g, '');\n\n    // Add version, precision, and output variable at the beginning\n    converted = '#version 300 es\\nprecision highp float;\\nout vec4 fragColor;\\n' + converted;\n\n    // Convert varying to in\n    converted = converted.replace(/\\bvarying\\s+/g, 'in ');\n\n    // Replace gl_FragColor with fragColor\n    converted = converted.replace(/\\bgl_FragColor\\b/g, 'fragColor');\n\n    // Replace texture2D with texture\n    converted = converted.replace(/\\btexture2D\\s*\\(/g, 'texture(');\n\n    return converted;\n  }\n}\n","export interface Canvas2DFallbackOptions {\n  transitionDuration?: number;\n}\n\nexport class Canvas2DFallback {\n  private canvas: HTMLCanvasElement | null = null;\n  private ctx: CanvasRenderingContext2D | null = null;\n  private currentImage: HTMLImageElement | null = null;\n  private nextImage: HTMLImageElement | null = null;\n  private options: Canvas2DFallbackOptions;\n\n  constructor(options: Canvas2DFallbackOptions = {}) {\n    this.options = {\n      transitionDuration: 1000,\n      ...options,\n    };\n  }\n\n  initialize(canvas: HTMLCanvasElement): boolean {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d');\n\n    if (!this.ctx) {\n      return false;\n    }\n\n    // Set image smoothing\n    this.ctx.imageSmoothingEnabled = true;\n    this.ctx.imageSmoothingQuality = 'high';\n\n    return true;\n  }\n\n  setImages(current: HTMLImageElement | null, next: HTMLImageElement | null): void {\n    this.currentImage = current;\n    this.nextImage = next;\n  }\n\n  render(progress: number): void {\n    if (!this.ctx || !this.canvas) return;\n\n    // Clear canvas\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    // Calculate dimensions to maintain aspect ratio\n    const canvasRatio = this.canvas.width / this.canvas.height;\n\n    if (this.currentImage && progress < 1) {\n      const imageRatio = this.currentImage.width / this.currentImage.height;\n      const { width, height, x, y } = this.calculateDimensions(\n        this.canvas.width,\n        this.canvas.height,\n        imageRatio,\n        canvasRatio,\n      );\n\n      // Draw current image with fade out effect\n      this.ctx.save();\n      this.ctx.globalAlpha = 1 - progress;\n      this.ctx.drawImage(this.currentImage, x, y, width, height);\n      this.ctx.restore();\n    }\n\n    if (this.nextImage && progress > 0) {\n      const imageRatio = this.nextImage.width / this.nextImage.height;\n      const { width, height, x, y } = this.calculateDimensions(\n        this.canvas.width,\n        this.canvas.height,\n        imageRatio,\n        canvasRatio,\n      );\n\n      // Draw next image with fade in effect\n      this.ctx.save();\n      this.ctx.globalAlpha = progress;\n      this.ctx.drawImage(this.nextImage, x, y, width, height);\n      this.ctx.restore();\n    }\n  }\n\n  private calculateDimensions(\n    canvasWidth: number,\n    canvasHeight: number,\n    imageRatio: number,\n    canvasRatio: number,\n  ): { width: number; height: number; x: number; y: number } {\n    let width: number;\n    let height: number;\n    let x = 0;\n    let y = 0;\n\n    if (imageRatio > canvasRatio) {\n      // Image is wider than canvas\n      width = canvasWidth;\n      height = canvasWidth / imageRatio;\n      y = (canvasHeight - height) / 2;\n    } else {\n      // Image is taller than canvas\n      height = canvasHeight;\n      width = canvasHeight * imageRatio;\n      x = (canvasWidth - width) / 2;\n    }\n\n    return { width, height, x, y };\n  }\n\n  resize(width: number, height: number): void {\n    if (!this.canvas) return;\n\n    this.canvas.width = width;\n    this.canvas.height = height;\n\n    // Redraw after resize\n    this.render(0);\n  }\n\n  dispose(): void {\n    this.canvas = null;\n    this.ctx = null;\n    this.currentImage = null;\n    this.nextImage = null;\n  }\n\n  isInitialized(): boolean {\n    return this.ctx !== null;\n  }\n\n  getContext(): CanvasRenderingContext2D | null {\n    return this.ctx;\n  }\n}\n","export interface IEffect {\n  readonly name: string;\n  readonly vertexShader: string;\n  readonly fragmentShader: string;\n\n  getUniforms(progress: number): Record<string, number | number[] | Float32Array>;\n\n  // Optional hooks\n  onBeforeRender?(gl: WebGLRenderingContext): void;\n  onAfterRender?(gl: WebGLRenderingContext): void;\n\n  // Optional properties for advanced effects\n  readonly requiresWebGL2?: boolean;\n  readonly requiresCustomMesh?: boolean;\n  getMesh?(): {\n    positions: Float32Array;\n    indices: Uint16Array;\n    texCoords: Float32Array;\n    normals?: Float32Array;\n  };\n  getInstanceData?(): { positions: Float32Array; offsets: Float32Array; scales: Float32Array };\n}\n\nexport class EffectManager {\n  private effects: Map<string, IEffect> = new Map();\n  private defaultEffectName = 'fade';\n\n  register(effect: IEffect): void {\n    if (!effect.name) {\n      throw new Error('Effect must have a name');\n    }\n\n    if (this.effects.has(effect.name)) {\n      console.warn(`Effect \"${effect.name}\" is already registered. Overwriting...`);\n    }\n\n    this.effects.set(effect.name, effect);\n  }\n\n  unregister(name: string): boolean {\n    return this.effects.delete(name);\n  }\n\n  get(name: string): IEffect | null {\n    return this.effects.get(name) || null;\n  }\n\n  has(name: string): boolean {\n    return this.effects.has(name);\n  }\n\n  list(): string[] {\n    return Array.from(this.effects.keys());\n  }\n\n  clear(): void {\n    this.effects.clear();\n  }\n\n  size(): number {\n    return this.effects.size;\n  }\n\n  setDefault(name: string): void {\n    if (!this.effects.has(name)) {\n      throw new Error(`Effect \"${name}\" is not registered`);\n    }\n    this.defaultEffectName = name;\n  }\n\n  getDefault(): IEffect | null {\n    return this.get(this.defaultEffectName);\n  }\n\n  getDefaultName(): string {\n    return this.defaultEffectName;\n  }\n}\n\n// Factory function for creating effect managers with pre-registered effects\nexport function createEffectManager(effects?: IEffect[]): EffectManager {\n  const manager = new EffectManager();\n\n  if (effects) {\n    effects.forEach((effect) => manager.register(effect));\n  }\n\n  return manager;\n}\n","import { IEffect } from '../core/EffectManager';\nimport { TriangleMesh } from '../utils/MeshGenerator';\n\nexport abstract class BaseEffect implements IEffect {\n  abstract readonly name: string;\n\n  // Default vertex shader that can be overridden\n  readonly vertexShader: string = `\n    attribute vec2 aPosition;\n    attribute vec2 aTexCoord;\n    \n    varying vec2 vTexCoord;\n    \n    void main() {\n      gl_Position = vec4(aPosition, 0.0, 1.0);\n      vTexCoord = aTexCoord;\n    }\n  `;\n\n  abstract readonly fragmentShader: string;\n\n  abstract getUniforms(progress: number): Record<string, number | number[] | Float32Array>;\n\n  // Optional lifecycle hooks\n  onBeforeRender?(gl: WebGLRenderingContext | WebGL2RenderingContext): void;\n  onAfterRender?(gl: WebGLRenderingContext | WebGL2RenderingContext): void;\n\n  // WebGL 2.0 support\n  get requiresWebGL2(): boolean {\n    return false;\n  }\n\n  // Custom mesh support\n  get requiresCustomMesh(): boolean {\n    return false;\n  }\n\n  getMesh?(): TriangleMesh {\n    throw new Error('getMesh() must be implemented for effects that require custom meshes');\n  }\n\n  // Instance data for instanced rendering\n  getInstanceData?(): { positions: Float32Array; offsets: Float32Array; scales: Float32Array } {\n    return {\n      positions: new Float32Array(0),\n      offsets: new Float32Array(0),\n      scales: new Float32Array(0),\n    };\n  }\n\n  // Transform feedback varyings for WebGL 2.0\n  getTransformFeedbackVaryings?(): string[] {\n    return [];\n  }\n}\n","// Common shader functions and utilities\n\nexport const commonShaderFunctions = `\n  // Custom smooth step function for transitions\n  float customSmoothstep(float edge0, float edge1, float x) {\n    float t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return t * t * (3.0 - 2.0 * t);\n  }\n  \n  // Cubic easing function\n  float cubicInOut(float t) {\n    return t < 0.5\n      ? 4.0 * t * t * t\n      : 1.0 - pow(-2.0 * t + 2.0, 3.0) / 2.0;\n  }\n  \n  // Linear interpolation\n  vec4 mix4(vec4 a, vec4 b, float t) {\n    return a * (1.0 - t) + b * t;\n  }\n  \n  // 2D rotation matrix\n  mat2 rotate2d(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n    return mat2(c, -s, s, c);\n  }\n  \n  // Convert normalized coordinates to aspect-corrected coordinates\n  vec2 aspectCorrect(vec2 uv, vec2 resolution) {\n    float aspect = resolution.x / resolution.y;\n    return vec2(uv.x * aspect, uv.y);\n  }\n`;\n\nexport const createFragmentShader = (effectCode: string, includeCommon = true): string => {\n  const common = includeCommon ? commonShaderFunctions : '';\n\n  return `\n    precision mediump float;\n    \n    uniform sampler2D uTexture0;\n    uniform sampler2D uTexture1;\n    uniform float uProgress;\n    uniform vec2 uResolution;\n    uniform vec2 uImageSize0;\n    uniform vec2 uImageSize1;\n    \n    varying vec2 vTexCoord;\n    \n    // Calculate UV coordinates for cover fit\n    vec2 getCoverUV(vec2 uv, vec2 imageSize, vec2 resolution) {\n      // Ensure we have valid sizes\n      if (imageSize.x <= 0.0 || imageSize.y <= 0.0 || resolution.x <= 0.0 || resolution.y <= 0.0) {\n        return uv;\n      }\n      \n      float imageAspect = imageSize.x / imageSize.y;\n      float canvasAspect = resolution.x / resolution.y;\n      \n      vec2 scale = vec2(1.0);\n      if (imageAspect > canvasAspect) {\n        // Image is wider, scale by height\n        scale.x = imageAspect / canvasAspect;\n      } else {\n        // Image is taller, scale by width\n        scale.y = canvasAspect / imageAspect;\n      }\n      \n      // Center the UV coordinates\n      vec2 scaledUV = (uv - 0.5) / scale + 0.5;\n      \n      return scaledUV;\n    }\n    \n    ${common}\n    \n    ${effectCode}\n  `;\n};\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport class FadeEffect extends BaseEffect {\n  readonly name = 'fade';\n\n  readonly fragmentShader = createFragmentShader(`\n    void main() {\n      vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n      \n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Simple linear fade\n      gl_FragColor = mix(color0, color1, uProgress);\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport type SlideDirection = 'left' | 'right' | 'up' | 'down';\n\nexport class SlideEffect extends BaseEffect {\n  readonly name: string;\n  private direction: SlideDirection;\n\n  constructor(direction: SlideDirection = 'left') {\n    super();\n    this.direction = direction;\n    this.name = `slide${direction.charAt(0).toUpperCase() + direction.slice(1)}`;\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform vec2 uDirection;\n    \n    void main() {\n      vec2 uv = vTexCoord;\n      \n      // Calculate offset based on progress\n      vec2 offset = uDirection * uProgress;\n      \n      // Calculate UVs for both images with proper aspect ratio\n      vec2 uv0 = getCoverUV(uv + offset, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(uv + offset - uDirection, uImageSize1, uResolution);\n      \n      // Sample textures\n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Calculate transition boundary\n      vec2 transitionUV = uv + offset - uDirection;\n      \n      // Create mask based on direction\n      float mask;\n      if (abs(uDirection.x) > 0.5) {\n        // Horizontal slide\n        mask = step(0.0, transitionUV.x) * step(transitionUV.x, 1.0);\n      } else {\n        // Vertical slide\n        mask = step(0.0, transitionUV.y) * step(transitionUV.y, 1.0);\n      }\n      \n      gl_FragColor = mix(color0, color1, mask);\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    let direction: number[] = [0, 0];\n\n    switch (this.direction) {\n      case 'left':\n        direction = [-1, 0];\n        break;\n      case 'right':\n        direction = [1, 0];\n        break;\n      case 'up':\n        direction = [0, 1];\n        break;\n      case 'down':\n        direction = [0, -1];\n        break;\n    }\n\n    return {\n      uProgress: progress,\n      uDirection: direction,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport type FlipAxis = 'horizontal' | 'vertical';\n\nexport class FlipEffect extends BaseEffect {\n  readonly name: string;\n  private axis: FlipAxis;\n\n  constructor(axis: FlipAxis = 'horizontal') {\n    super();\n    this.axis = axis;\n    this.name = `flip${axis.charAt(0).toUpperCase() + axis.slice(1)}`;\n  }\n\n  // カスタム頂点シェーダー - 画像を変形\n  readonly vertexShader = `\n    attribute vec2 aPosition;\n    attribute vec2 aTexCoord;\n    \n    uniform float uProgress;\n    uniform float uAxis;\n    \n    varying vec2 vTexCoord;\n    \n    void main() {\n      vTexCoord = aTexCoord;\n      \n      // 回転角度\n      float angle = uProgress * 3.14159;\n      float scale = abs(cos(angle));\n      \n      vec2 position = aPosition;\n      \n      if (uAxis < 0.5) {\n        // Horizontal flip - X方向のみ縮小\n        position.x *= scale;\n      } else {\n        // Vertical flip - Y方向のみ縮小  \n        position.y *= scale;\n      }\n      \n      gl_Position = vec4(position, 0.0, 1.0);\n    }\n  `;\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uAxis;\n    \n    void main() {\n      vec2 uv = vTexCoord;\n      \n      // 回転角度\n      float angle = uProgress * 3.14159;\n      float cosAngle = cos(angle);\n      \n      // スケール計算（0で完全に消える）\n      float scale = abs(cosAngle);\n      \n      // 表裏の判定\n      bool isBackface = cosAngle < 0.0;\n      \n      vec4 finalColor;\n      \n      if (!isBackface) {\n        // 表面：1枚目の画像\n        vec2 uv0 = getCoverUV(uv, uImageSize0, uResolution);\n        finalColor = texture2D(uTexture0, uv0);\n      } else {\n        // 裏面：2枚目の画像\n        vec2 uv1 = getCoverUV(uv, uImageSize1, uResolution);\n        finalColor = texture2D(uTexture1, uv1);\n      }\n      \n      // 軽いシェーディング効果\n      float shading = 0.7 + 0.3 * scale;\n      finalColor.rgb *= shading;\n      \n      gl_FragColor = finalColor;\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n      uAxis: this.axis === 'vertical' ? 1 : 0,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface WaveOptions {\n  amplitude?: number;\n  frequency?: number;\n  speed?: number;\n}\n\nexport class WaveEffect extends BaseEffect {\n  name = 'wave';\n  private amplitude: number;\n  private frequency: number;\n  private speed: number;\n\n  constructor(options: WaveOptions = {}) {\n    super();\n    this.amplitude = options.amplitude ?? 0.1;\n    this.frequency = options.frequency ?? 10.0;\n    this.speed = options.speed ?? 1.0;\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uAmplitude;\n    uniform float uFrequency;\n    uniform float uSpeed;\n    uniform float uTime;\n    \n    void main() {\n      vec2 uv = vTexCoord;\n      \n      // Create wave displacement\n      float wave = sin(uv.y * uFrequency + uTime * uSpeed) * uAmplitude;\n      \n      // Apply wave based on progress\n      float displacement = wave * (1.0 - abs(uProgress - 0.5) * 2.0);\n      \n      // Apply wave displacement then aspect ratio correction\n      vec2 displacedUV0 = vec2(uv.x + displacement * (1.0 - uProgress), uv.y);\n      vec2 displacedUV1 = vec2(uv.x + displacement * uProgress, uv.y);\n      \n      vec2 uv0 = getCoverUV(displacedUV0, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(displacedUV1, uImageSize1, uResolution);\n      \n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Mix with wave-influenced progress\n      float mixFactor = smoothstep(0.0, 1.0, uProgress + wave * 0.5);\n      \n      gl_FragColor = mix(color0, color1, mixFactor);\n    }\n  `);\n\n  private startTime = Date.now();\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    const time = (Date.now() - this.startTime) / 1000; // Convert to seconds\n\n    return {\n      uProgress: progress,\n      uAmplitude: this.amplitude,\n      uFrequency: this.frequency,\n      uSpeed: this.speed,\n      uTime: time,\n    };\n  }\n\n  onBeforeRender(_gl: WebGLRenderingContext): void {\n    // Reset time on each transition start\n    if (this.lastProgress === 0 && this.lastProgress !== undefined) {\n      this.startTime = Date.now();\n    }\n    this.lastProgress = this.lastProgress ?? 0;\n  }\n\n  private lastProgress?: number;\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface DistortionOptions {\n  intensity?: number;\n  radius?: number;\n  spiral?: number;\n}\n\nexport class DistortionEffect extends BaseEffect {\n  name = 'distortion';\n  private intensity: number;\n  private radius: number;\n  private spiral: number;\n\n  constructor(options: DistortionOptions = {}) {\n    super();\n    this.intensity = options.intensity ?? 0.5;\n    this.radius = options.radius ?? 0.8;\n    this.spiral = options.spiral ?? 2.0;\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uIntensity;\n    uniform float uRadius;\n    uniform float uSpiral;\n    \n    vec2 distort(vec2 uv, float progress) {\n      // Center the coordinates\n      vec2 center = vec2(0.5, 0.5);\n      vec2 dir = uv - center;\n      float dist = length(dir);\n      \n      // Create distortion effect\n      float distortionAmount = 0.0;\n      \n      if (dist < uRadius) {\n        // Smooth the edge of distortion\n        float edge = smoothstep(0.0, uRadius, dist);\n        \n        // Calculate rotation based on distance and progress\n        float angle = progress * uSpiral * (1.0 - edge);\n        \n        // Apply rotation\n        float s = sin(angle);\n        float c = cos(angle);\n        dir = vec2(\n          dir.x * c - dir.y * s,\n          dir.x * s + dir.y * c\n        );\n        \n        // Add radial distortion\n        float radialDistort = (1.0 - edge) * progress * uIntensity;\n        dir *= 1.0 + radialDistort;\n      }\n      \n      return center + dir;\n    }\n    \n    void main() {\n      // Create two different distortion phases\n      float phase1 = smoothstep(0.0, 0.5, uProgress);\n      float phase2 = smoothstep(0.5, 1.0, uProgress);\n      \n      // Distort UV coordinates\n      vec2 distortedUV0 = distort(vTexCoord, phase1);\n      vec2 distortedUV1 = distort(vTexCoord, 1.0 - phase2);\n      \n      // Apply aspect ratio correction after distortion\n      vec2 uv0 = getCoverUV(distortedUV0, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(distortedUV1, uImageSize1, uResolution);\n      \n      // Sample textures\n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Mix based on progress\n      float mixFactor = smoothstep(0.4, 0.6, uProgress);\n      \n      gl_FragColor = mix(color0, color1, mixFactor);\n      \n      // Add vignette effect during transition\n      float vignette = 1.0 - length(vTexCoord - 0.5) * 0.5 * sin(uProgress * 3.14159);\n      gl_FragColor.rgb *= vignette;\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n      uIntensity: this.intensity,\n      uRadius: this.radius,\n      uSpiral: this.spiral,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface DissolveOptions {\n  scale?: number;\n  threshold?: number;\n  fadeWidth?: number;\n}\n\nexport class DissolveEffect extends BaseEffect {\n  name = 'dissolve';\n  private scale: number;\n  private threshold: number;\n  private fadeWidth: number;\n\n  constructor(options: DissolveOptions = {}) {\n    super();\n    this.scale = options.scale ?? 10.0;\n    this.threshold = options.threshold ?? 0.5;\n    this.fadeWidth = options.fadeWidth ?? 0.1;\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uScale;\n    uniform float uThreshold;\n    uniform float uFadeWidth;\n    \n    // Simple pseudo-random function\n    float random(vec2 co) {\n      return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n    }\n    \n    // Noise function\n    float noise(vec2 p) {\n      vec2 i = floor(p);\n      vec2 f = fract(p);\n      \n      float a = random(i);\n      float b = random(i + vec2(1.0, 0.0));\n      float c = random(i + vec2(0.0, 1.0));\n      float d = random(i + vec2(1.0, 1.0));\n      \n      vec2 u = f * f * (3.0 - 2.0 * f);\n      \n      return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;\n    }\n    \n    void main() {\n      // Apply aspect ratio correction\n      vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n      \n      // Generate noise for dissolve effect\n      float n = noise(vTexCoord * uScale);\n      \n      // Add some variation with multiple octaves\n      n += noise(vTexCoord * uScale * 2.0) * 0.5;\n      n += noise(vTexCoord * uScale * 4.0) * 0.25;\n      n = n / 1.75; // Normalize\n      \n      // Calculate dissolve threshold\n      float threshold = uProgress * (1.0 + uFadeWidth * 2.0) - uFadeWidth;\n      \n      // Create smooth transition\n      float alpha = smoothstep(threshold - uFadeWidth, threshold + uFadeWidth, n);\n      \n      // Sample textures\n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Mix colors based on dissolve\n      gl_FragColor = mix(color1, color0, alpha);\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n      uScale: this.scale,\n      uThreshold: this.threshold,\n      uFadeWidth: this.fadeWidth,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface CircleOptions {\n  centerX?: number;\n  centerY?: number;\n  feather?: number;\n  scale?: number;\n}\n\nexport class CircleEffect extends BaseEffect {\n  name = 'circle';\n  private centerX: number;\n  private centerY: number;\n  private feather: number;\n  private scale: number;\n\n  constructor(options: CircleOptions = {}) {\n    super();\n    this.centerX = options.centerX ?? 0.5;\n    this.centerY = options.centerY ?? 0.5;\n    this.feather = options.feather ?? 0.1;\n    this.scale = options.scale ?? 1.0;\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform vec2 uCenter;\n    uniform float uFeather;\n    uniform float uScale;\n    \n    void main() {\n      // Apply aspect ratio correction\n      vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n      \n      // Calculate distance from center\n      vec2 center = uCenter;\n      vec2 pos = vTexCoord - center;\n      \n      // Correct for aspect ratio\n      float aspect = uResolution.x / uResolution.y;\n      pos.x *= aspect;\n      \n      float dist = length(pos);\n      \n      // Calculate circle radius based on progress\n      float radius = uProgress * uScale * sqrt(2.0); // sqrt(2) to cover corners\n      \n      // Create smooth edge\n      float alpha = smoothstep(radius - uFeather, radius + uFeather, dist);\n      \n      // Sample textures\n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Mix based on circle mask\n      gl_FragColor = mix(color1, color0, alpha);\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n      uCenter: [this.centerX, this.centerY],\n      uFeather: this.feather,\n      uScale: this.scale,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface PixelDissolveOptions {\n  pixelSize?: number;\n  stagger?: number;\n}\n\nexport class PixelDissolveEffect extends BaseEffect {\n  name = 'pixelDissolve';\n  private pixelSize: number;\n  private stagger: number;\n\n  constructor(options: PixelDissolveOptions = {}) {\n    super();\n    this.pixelSize = options.pixelSize ?? 20.0;\n    this.stagger = options.stagger ?? 0.3;\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uPixelSize;\n    uniform float uStagger;\n    \n    // Simple pseudo-random function\n    float random(vec2 co) {\n      return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n    }\n    \n    void main() {\n      // Apply aspect ratio correction\n      vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n      \n      // Calculate pixel grid coordinates\n      vec2 pixelCoord = floor(vTexCoord * uResolution / uPixelSize);\n      \n      // Generate random value per pixel\n      float pixelRandom = random(pixelCoord);\n      \n      // Add some variation based on position\n      float positionBias = (pixelCoord.x + pixelCoord.y) / (uResolution.x / uPixelSize + uResolution.y / uPixelSize);\n      pixelRandom = mix(pixelRandom, positionBias, uStagger);\n      \n      // Calculate transition threshold\n      float threshold = uProgress;\n      \n      // Determine pixel visibility with hard edge\n      float alpha = step(pixelRandom, threshold);\n      \n      // Sample textures\n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // Mix colors based on pixel visibility\n      gl_FragColor = mix(color0, color1, alpha);\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n      uPixelSize: this.pixelSize,\n      uStagger: this.stagger,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface MorphOptions {\n  gridSize?: number;\n  morphIntensity?: number;\n  twistAmount?: number;\n  waveFrequency?: number;\n}\n\nexport class MorphEffect extends BaseEffect {\n  name = 'morph';\n  private gridSize: number;\n  private morphIntensity: number;\n  private twistAmount: number;\n  private waveFrequency: number;\n\n  constructor(options: MorphOptions = {}) {\n    super();\n    this.gridSize = options.gridSize ?? 50.0;\n    this.morphIntensity = options.morphIntensity ?? 0.3;\n    this.twistAmount = options.twistAmount ?? 2.0;\n    this.waveFrequency = options.waveFrequency ?? 3.0;\n  }\n\n  // カスタム頂点シェーダー - 頂点を動的に変形\n  readonly vertexShader = `\n    attribute vec2 aPosition;\n    attribute vec2 aTexCoord;\n    \n    uniform float uProgress;\n    uniform float uMorphIntensity;\n    uniform float uTwistAmount;\n    uniform float uWaveFrequency;\n    uniform vec2 uResolution;\n    \n    varying vec2 vTexCoord;\n    varying float vMorphAmount;\n    \n    void main() {\n      vTexCoord = aTexCoord;\n      \n      // 中心からの距離を計算\n      vec2 center = vec2(0.5, 0.5);\n      vec2 toCenter = aTexCoord - center;\n      float dist = length(toCenter);\n      \n      // プログレスに基づくモーフ量を計算\n      float morphProgress = smoothstep(0.0, 1.0, uProgress);\n      float morphAmount = sin(morphProgress * 3.14159);\n      vMorphAmount = morphAmount;\n      \n      // 頂点の変位を計算\n      vec2 position = aPosition;\n      \n      // ツイスト効果\n      float angle = atan(toCenter.y, toCenter.x);\n      float twist = sin(angle * uWaveFrequency + morphProgress * uTwistAmount) * morphAmount;\n      position.x += twist * toCenter.y * uMorphIntensity;\n      position.y -= twist * toCenter.x * uMorphIntensity;\n      \n      // 波形効果\n      float wave = sin(dist * 10.0 - morphProgress * 5.0) * morphAmount;\n      position += normalize(toCenter) * wave * uMorphIntensity * 0.5;\n      \n      // Z軸の変位（3D効果）\n      float z = sin(dist * 8.0 + morphProgress * 4.0) * morphAmount * 0.3;\n      \n      gl_Position = vec4(position, z, 1.0);\n    }\n  `;\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uGridSize;\n    varying float vMorphAmount;\n    \n    void main() {\n      vec2 uv0 = getCoverUV(vTexCoord, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(vTexCoord, uImageSize1, uResolution);\n      \n      // グリッドベースの歪み\n      vec2 gridUV = vTexCoord * uGridSize;\n      vec2 gridPos = floor(gridUV);\n      vec2 gridFract = fract(gridUV);\n      \n      // モーフ量に基づく歪み\n      vec2 distortion = sin(gridPos * 0.1 + vMorphAmount * 3.14159) * 0.02 * vMorphAmount;\n      \n      vec2 distortedUV0 = uv0 + distortion;\n      vec2 distortedUV1 = uv1 - distortion;\n      \n      vec4 color0 = texture2D(uTexture0, distortedUV0);\n      vec4 color1 = texture2D(uTexture1, distortedUV1);\n      \n      // エッジ効果\n      float edge = 1.0 - smoothstep(0.4, 0.5, abs(gridFract.x - 0.5)) * \n                         smoothstep(0.4, 0.5, abs(gridFract.y - 0.5));\n      edge *= vMorphAmount;\n      \n      // カラーミックス\n      float mixFactor = smoothstep(0.3, 0.7, uProgress);\n      vec4 finalColor = mix(color0, color1, mixFactor);\n      \n      // エッジハイライト\n      finalColor.rgb += vec3(edge * 0.2);\n      \n      // 色収差効果\n      vec2 aberration = distortion * 2.0;\n      finalColor.r = mix(\n        texture2D(uTexture0, distortedUV0 + aberration).r,\n        texture2D(uTexture1, distortedUV1 + aberration).r,\n        mixFactor\n      );\n      finalColor.b = mix(\n        texture2D(uTexture0, distortedUV0 - aberration).b,\n        texture2D(uTexture1, distortedUV1 - aberration).b,\n        mixFactor\n      );\n      \n      gl_FragColor = finalColor;\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    return {\n      uProgress: progress,\n      uGridSize: this.gridSize,\n      uMorphIntensity: this.morphIntensity,\n      uTwistAmount: this.twistAmount,\n      uWaveFrequency: this.waveFrequency,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { createFragmentShader } from './shaderUtils';\n\nexport interface GlitchOptions {\n  intensity?: number;\n  sliceCount?: number;\n  colorShift?: number;\n  noiseAmount?: number;\n}\n\nexport class GlitchEffect extends BaseEffect {\n  name = 'glitch';\n  private intensity: number;\n  private sliceCount: number;\n  private colorShift: number;\n  private noiseAmount: number;\n  private startTime: number;\n\n  constructor(options: GlitchOptions = {}) {\n    super();\n    this.intensity = options.intensity ?? 0.5;\n    this.sliceCount = options.sliceCount ?? 15.0;\n    this.colorShift = options.colorShift ?? 0.03;\n    this.noiseAmount = options.noiseAmount ?? 0.1;\n    this.startTime = Date.now();\n  }\n\n  readonly fragmentShader = createFragmentShader(`\n    uniform float uIntensity;\n    uniform float uSliceCount;\n    uniform float uColorShift;\n    uniform float uNoiseAmount;\n    uniform float uTime;\n    \n    // 擬似乱数生成\n    float random(vec2 co) {\n      return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n    }\n    \n    // ノイズ関数\n    float noise(vec2 p) {\n      vec2 i = floor(p);\n      vec2 f = fract(p);\n      \n      float a = random(i);\n      float b = random(i + vec2(1.0, 0.0));\n      float c = random(i + vec2(0.0, 1.0));\n      float d = random(i + vec2(1.0, 1.0));\n      \n      vec2 u = f * f * (3.0 - 2.0 * f);\n      \n      return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;\n    }\n    \n    void main() {\n      vec2 uv = vTexCoord;\n      \n      // グリッチ強度の計算（時間ベース）\n      float glitchStrength = step(0.5, sin(uTime * 20.0)) * uIntensity;\n      glitchStrength *= step(0.8, random(vec2(uTime * 10.0, 0.0)));\n      \n      // プログレスに基づくグリッチの増減\n      float progressGlitch = sin(uProgress * 3.14159);\n      glitchStrength *= progressGlitch;\n      \n      // 水平スライスの計算\n      float slice = floor(uv.y * uSliceCount);\n      float sliceOffset = random(vec2(slice, uTime)) * 2.0 - 1.0;\n      sliceOffset *= step(0.7, random(vec2(slice * 2.0, uTime * 10.0))) * glitchStrength;\n      \n      // UV座標の歪み\n      vec2 distortedUV = uv;\n      distortedUV.x += sliceOffset * 0.1;\n      \n      // ブロックノイズ\n      vec2 blockSize = vec2(0.05, 0.03);\n      vec2 blockCoord = floor(uv / blockSize) * blockSize;\n      float blockNoise = step(0.9, random(blockCoord + vec2(uTime * 5.0))) * glitchStrength;\n      distortedUV += blockNoise * (random(blockCoord * 2.0) - 0.5) * uNoiseAmount;\n      \n      // アスペクト比補正を適用\n      vec2 uv0 = getCoverUV(distortedUV, uImageSize0, uResolution);\n      vec2 uv1 = getCoverUV(distortedUV, uImageSize1, uResolution);\n      \n      // テクスチャサンプリング\n      vec4 color0 = texture2D(uTexture0, uv0);\n      vec4 color1 = texture2D(uTexture1, uv1);\n      \n      // RGB分離（グリッチ効果）\n      vec4 color0Shift = vec4(\n        texture2D(uTexture0, getCoverUV(distortedUV + vec2(uColorShift * glitchStrength, 0.0), uImageSize0, uResolution)).r,\n        color0.g,\n        texture2D(uTexture0, getCoverUV(distortedUV - vec2(uColorShift * glitchStrength, 0.0), uImageSize0, uResolution)).b,\n        color0.a\n      );\n      \n      vec4 color1Shift = vec4(\n        texture2D(uTexture1, getCoverUV(distortedUV + vec2(uColorShift * glitchStrength, 0.0), uImageSize1, uResolution)).r,\n        color1.g,\n        texture2D(uTexture1, getCoverUV(distortedUV - vec2(uColorShift * glitchStrength, 0.0), uImageSize1, uResolution)).b,\n        color1.a\n      );\n      \n      // カラーミックス\n      float mixFactor = smoothstep(0.3, 0.7, uProgress);\n      vec4 finalColor = mix(color0Shift, color1Shift, mixFactor);\n      \n      // デジタルノイズ\n      float digitalNoise = random(uv + vec2(uTime * 100.0)) * glitchStrength * 0.1;\n      finalColor.rgb += vec3(digitalNoise);\n      \n      // カラー反転（ランダム）\n      float invertChance = step(0.95, random(vec2(uTime * 30.0))) * glitchStrength;\n      finalColor.rgb = mix(finalColor.rgb, 1.0 - finalColor.rgb, invertChance);\n      \n      // スキャンライン\n      float scanline = sin(uv.y * 800.0) * 0.04 * glitchStrength;\n      finalColor.rgb -= scanline;\n      \n      gl_FragColor = finalColor;\n    }\n  `);\n\n  getUniforms(progress: number): Record<string, number | number[]> {\n    const time = (Date.now() - this.startTime) / 1000;\n    return {\n      uProgress: progress,\n      uIntensity: this.intensity,\n      uSliceCount: this.sliceCount,\n      uColorShift: this.colorShift,\n      uNoiseAmount: this.noiseAmount,\n      uTime: time,\n    };\n  }\n}\n","import { BaseEffect } from './BaseEffect';\nimport { TriangleMesh } from '../utils/MeshGenerator';\n\nexport interface CustomEffectOptions {\n  name: string;\n  vertexShader: string;\n  fragmentShader: string;\n  uniforms?: () => Record<string, number | number[] | Float32Array>;\n  requiresWebGL2?: boolean;\n  requiresCustomMesh?: boolean;\n  getMesh?: () => { positions: Float32Array; indices: Uint16Array };\n  getInstanceData?: () => Float32Array | null;\n  getTransformFeedbackVaryings?: () => string[];\n}\n\n/**\n * Custom effect that allows loading external shaders\n */\nexport class CustomEffect extends BaseEffect {\n  name: string;\n  vertexShader: string;\n  fragmentShader: string;\n  private uniformsGetter?: () => Record<string, number | number[] | Float32Array>;\n  private _requiresWebGL2: boolean;\n  private _requiresCustomMesh: boolean;\n  private _getMesh?: () => { positions: Float32Array; indices: Uint16Array };\n  private _getInstanceData?: () => Float32Array | null;\n  private _getTransformFeedbackVaryings?: () => string[];\n\n  constructor(options: CustomEffectOptions) {\n    super();\n    this.name = options.name;\n    this.vertexShader = options.vertexShader;\n    this.fragmentShader = options.fragmentShader;\n    this.uniformsGetter = options.uniforms;\n    this._requiresWebGL2 = options.requiresWebGL2 ?? false;\n    this._requiresCustomMesh = options.requiresCustomMesh ?? false;\n    this._getMesh = options.getMesh;\n    this._getInstanceData = options.getInstanceData;\n    this._getTransformFeedbackVaryings = options.getTransformFeedbackVaryings;\n  }\n\n  getUniforms(progress: number): Record<string, number | number[] | Float32Array> {\n    const baseUniforms = {\n      uProgress: progress,\n    };\n\n    if (this.uniformsGetter) {\n      return { ...baseUniforms, ...this.uniformsGetter() };\n    }\n\n    return baseUniforms;\n  }\n\n  get requiresWebGL2(): boolean {\n    return this._requiresWebGL2;\n  }\n\n  get requiresCustomMesh(): boolean {\n    return this._requiresCustomMesh;\n  }\n\n  getMesh(): TriangleMesh {\n    if (this._getMesh) {\n      const mesh = this._getMesh();\n      return {\n        positions: mesh.positions,\n        indices: mesh.indices,\n        texCoords: new Float32Array(0), // Default empty\n        normals: new Float32Array(0), // Default empty\n        triangles: [],\n      };\n    }\n    throw new Error('getMesh() not implemented for this custom effect');\n  }\n\n  getInstanceData(): { positions: Float32Array; offsets: Float32Array; scales: Float32Array } {\n    if (this._getInstanceData) {\n      const data = this._getInstanceData();\n      if (data) {\n        // Convert Float32Array to the expected format\n        return {\n          positions: data,\n          offsets: new Float32Array(0),\n          scales: new Float32Array(0),\n        };\n      }\n    }\n    // Return empty data instead of null to match BaseEffect\n    return {\n      positions: new Float32Array(0),\n      offsets: new Float32Array(0),\n      scales: new Float32Array(0),\n    };\n  }\n\n  getTransformFeedbackVaryings(): string[] {\n    if (this._getTransformFeedbackVaryings) {\n      return this._getTransformFeedbackVaryings();\n    }\n    return [];\n  }\n}\n\n/**\n * Helper function to create a custom effect from external shader files\n */\nexport async function createCustomEffectFromFiles(\n  name: string,\n  vertexShaderUrl: string,\n  fragmentShaderUrl: string,\n  options?: Partial<CustomEffectOptions>,\n): Promise<CustomEffect> {\n  const [vertexShader, fragmentShader] = await Promise.all([\n    fetch(vertexShaderUrl).then((r) => r.text()),\n    fetch(fragmentShaderUrl).then((r) => r.text()),\n  ]);\n\n  return new CustomEffect({\n    name,\n    vertexShader,\n    fragmentShader,\n    ...options,\n  });\n}\n\n/**\n * Helper function to create a custom effect from shader strings\n */\nexport function createCustomEffect(\n  name: string,\n  vertexShader: string | undefined,\n  fragmentShader: string,\n  options?: Partial<CustomEffectOptions>,\n): CustomEffect {\n  // Use default vertex shader if not provided\n  const defaultVertexShader = `\n    attribute vec2 aPosition;\n    attribute vec2 aTexCoord;\n    \n    varying vec2 vTexCoord;\n    \n    void main() {\n      gl_Position = vec4(aPosition, 0.0, 1.0);\n      vTexCoord = aTexCoord;\n    }\n  `;\n\n  return new CustomEffect({\n    name,\n    vertexShader: vertexShader || defaultVertexShader,\n    fragmentShader,\n    ...options,\n  });\n}\n","// Re-export all effects\nexport { BaseEffect } from './BaseEffect';\nexport { createFragmentShader, commonShaderFunctions } from './shaderUtils';\n\n// Effect classes\nexport { FadeEffect } from './fade';\nexport { SlideEffect, type SlideDirection } from './slide';\nexport { FlipEffect, type FlipAxis } from './flip';\nexport { WaveEffect, type WaveOptions } from './wave';\nexport { DistortionEffect, type DistortionOptions } from './distortion';\nexport { DissolveEffect, type DissolveOptions } from './dissolve';\nexport { CircleEffect, type CircleOptions } from './circle';\nexport { PixelDissolveEffect, type PixelDissolveOptions } from './pixelDissolve';\nexport { MorphEffect, type MorphOptions } from './morph';\nexport { GlitchEffect, type GlitchOptions } from './glitch';\nexport {\n  CustomEffect,\n  createCustomEffect,\n  createCustomEffectFromFiles,\n  type CustomEffectOptions,\n} from './CustomEffect';\n\n// Import classes for creating instances\nimport { FadeEffect } from './fade';\nimport { SlideEffect } from './slide';\nimport { FlipEffect } from './flip';\nimport { WaveEffect } from './wave';\nimport { DistortionEffect } from './distortion';\nimport { DissolveEffect } from './dissolve';\nimport { CircleEffect } from './circle';\nimport { PixelDissolveEffect } from './pixelDissolve';\nimport { MorphEffect } from './morph';\nimport { GlitchEffect } from './glitch';\n\n// Create and export singleton instances\nexport const fadeEffect = new FadeEffect();\nexport const slideLeftEffect = new SlideEffect('left');\nexport const slideRightEffect = new SlideEffect('right');\nexport const slideUpEffect = new SlideEffect('up');\nexport const slideDownEffect = new SlideEffect('down');\nexport const flipHorizontalEffect = new FlipEffect('horizontal');\nexport const flipVerticalEffect = new FlipEffect('vertical');\nexport const waveEffect = new WaveEffect();\nexport const gentleWaveEffect = new WaveEffect({ amplitude: 0.05, frequency: 5.0, speed: 0.5 });\nexport const intenseWaveEffect = new WaveEffect({ amplitude: 0.2, frequency: 15.0, speed: 2.0 });\nexport const distortionEffect = new DistortionEffect();\nexport const subtleDistortionEffect = new DistortionEffect({\n  intensity: 0.3,\n  radius: 0.6,\n  spiral: 1.0,\n});\nexport const extremeDistortionEffect = new DistortionEffect({\n  intensity: 1.0,\n  radius: 1.0,\n  spiral: 4.0,\n});\nexport const dissolveEffect = new DissolveEffect();\nexport const smoothDissolveEffect = new DissolveEffect({\n  scale: 5.0,\n  threshold: 0.5,\n  fadeWidth: 0.2,\n});\nexport const pixelDissolveEffect = new PixelDissolveEffect();\nexport const largePixelDissolveEffect = new PixelDissolveEffect({\n  pixelSize: 40.0,\n  stagger: 0.2,\n});\nexport const smallPixelDissolveEffect = new PixelDissolveEffect({\n  pixelSize: 10.0,\n  stagger: 0.4,\n});\nexport const circleEffect = new CircleEffect();\nexport const circleFromCenterEffect = new CircleEffect({\n  centerX: 0.5,\n  centerY: 0.5,\n  feather: 0.05,\n  scale: 1.2,\n});\nexport const circleFromCornerEffect = new CircleEffect({\n  centerX: 0.0,\n  centerY: 0.0,\n  feather: 0.1,\n  scale: 1.5,\n});\nexport const morphEffect = new MorphEffect();\nexport const intenseMorphEffect = new MorphEffect({\n  gridSize: 100.0,\n  morphIntensity: 0.5,\n  twistAmount: 4.0,\n  waveFrequency: 5.0,\n});\nexport const glitchEffect = new GlitchEffect();\nexport const intenseGlitchEffect = new GlitchEffect({\n  intensity: 0.8,\n  sliceCount: 25.0,\n  colorShift: 0.05,\n  noiseAmount: 0.2,\n});\nexport const subtleGlitchEffect = new GlitchEffect({\n  intensity: 0.3,\n  sliceCount: 10.0,\n  colorShift: 0.02,\n  noiseAmount: 0.05,\n});\n\n// Set unique names for effect variants\ngentleWaveEffect.name = 'gentleWave';\nintenseWaveEffect.name = 'intenseWave';\nsubtleDistortionEffect.name = 'subtleDistortion';\nextremeDistortionEffect.name = 'extremeDistortion';\npixelDissolveEffect.name = 'pixelDissolve';\nsmoothDissolveEffect.name = 'smoothDissolve';\ncircleFromCenterEffect.name = 'circleFromCenter';\ncircleFromCornerEffect.name = 'circleFromCorner';\nlargePixelDissolveEffect.name = 'largePixelDissolve';\nsmallPixelDissolveEffect.name = 'smallPixelDissolve';\nintenseMorphEffect.name = 'intenseMorph';\nintenseGlitchEffect.name = 'intenseGlitch';\nsubtleGlitchEffect.name = 'subtleGlitch';\n\n// Collection of all default effects\nexport function getDefaultEffects() {\n  return [\n    fadeEffect,\n    slideLeftEffect,\n    slideRightEffect,\n    slideUpEffect,\n    slideDownEffect,\n    flipHorizontalEffect,\n    flipVerticalEffect,\n    waveEffect,\n    gentleWaveEffect,\n    intenseWaveEffect,\n    distortionEffect,\n    subtleDistortionEffect,\n    extremeDistortionEffect,\n    dissolveEffect,\n    pixelDissolveEffect,\n    largePixelDissolveEffect,\n    smallPixelDissolveEffect,\n    smoothDissolveEffect,\n    circleEffect,\n    circleFromCenterEffect,\n    circleFromCornerEffect,\n    morphEffect,\n    intenseMorphEffect,\n    glitchEffect,\n    intenseGlitchEffect,\n    subtleGlitchEffect,\n  ];\n}\n\nimport type { EffectManager } from '../core/EffectManager';\n\n// Helper to register all default effects\nexport function registerDefaultEffects(manager: EffectManager): void {\n  getDefaultEffects().forEach((effect) => manager.register(effect));\n}\n","import { EventEmitter } from './EventEmitter';\nimport { StateManager } from './StateManager';\nimport { ImageLoader, LoadedImage } from './ImageLoader';\nimport { WebGLRenderer } from './WebGLRenderer';\nimport { WebGL2Renderer } from './WebGL2Renderer';\nimport { Canvas2DFallback } from './Canvas2DFallback';\nimport { EffectManager, IEffect } from './EffectManager';\nimport { registerDefaultEffects } from '../effects';\n\nexport interface CarouselCoreOptions {\n  canvas: HTMLCanvasElement;\n  images: string[];\n  effect?: string;\n  autoplay?: boolean;\n  autoplayInterval?: number;\n  transitionDuration?: number;\n  loop?: boolean;\n  fallbackToCanvas?: boolean;\n  onTransitionStart?: (from: number, to: number) => void;\n  onTransitionEnd?: (current: number) => void;\n}\n\nexport interface CarouselCoreEvents extends Record<string, unknown[]> {\n  ready: [];\n  error: [Error];\n  imageLoaded: [number, LoadedImage];\n  allImagesLoaded: [LoadedImage[]];\n  transitionStart: [number, number];\n  transitionEnd: [number];\n  play: [];\n  pause: [];\n}\n\nexport class CarouselCore extends EventEmitter<CarouselCoreEvents> {\n  private stateManager: StateManager;\n  private imageLoader: ImageLoader;\n  private renderer: WebGLRenderer | WebGL2Renderer | Canvas2DFallback | null = null;\n  private effectManager: EffectManager;\n  private canvas: HTMLCanvasElement;\n  private options: CarouselCoreOptions;\n  private loadedImages: Map<string, LoadedImage> = new Map();\n  private textures: Map<string, WebGLTexture> = new Map();\n  private animationId: number | null = null;\n  private transitionStartTime: number | null = null;\n  private autoplayTimer: NodeJS.Timeout | null = null;\n  private isWebGL = false;\n  private validImageIndices: number[] = []; // Track which image indices loaded successfully\n\n  constructor(options: CarouselCoreOptions) {\n    super();\n    this.options = options;\n    this.canvas = options.canvas;\n\n    // Initialize components\n    this.stateManager = new StateManager({\n      images: options.images,\n      currentIndex: 0,\n      effect: options.effect || 'fade',\n      autoplayInterval: options.autoplayInterval || 3000,\n      transitionDuration: options.transitionDuration || 1000,\n      loop: options.loop !== false,\n      isPlaying: options.autoplay || false,\n    });\n\n    this.imageLoader = new ImageLoader({\n      crossOrigin: 'anonymous', // Enable CORS for images\n    });\n    this.effectManager = new EffectManager();\n\n    // Register default effects\n    registerDefaultEffects(this.effectManager);\n\n    // Setup state event listeners\n    this.setupStateListeners();\n\n    // Setup callbacks\n    if (options.onTransitionStart) {\n      this.on('transitionStart', options.onTransitionStart);\n    }\n    if (options.onTransitionEnd) {\n      this.on('transitionEnd', options.onTransitionEnd);\n    }\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      // Initialize renderer\n      if (!this.initializeRenderer()) {\n        throw new Error('Failed to initialize renderer');\n      }\n\n      // Preload images\n      await this.preloadImages();\n\n      // Start autoplay if enabled\n      if (this.stateManager.get('isPlaying')) {\n        this.startAutoplay();\n      }\n\n      this.emit('ready');\n    } catch (error) {\n      this.emit('error', error as Error);\n      throw error;\n    }\n  }\n\n  private initializeRenderer(): boolean {\n    // Try WebGL 2.0 first (it's backwards compatible and supports more features)\n    if (this.options.fallbackToCanvas !== false) {\n      const webgl2Renderer = new WebGL2Renderer();\n      if (webgl2Renderer.initialize(this.canvas)) {\n        this.renderer = webgl2Renderer;\n        this.isWebGL = true;\n\n        // Setup WebGL 2.0 event listeners\n        webgl2Renderer.on('error', (error) => this.emit('error', error));\n        webgl2Renderer.on('contextLost', () => this.handleContextLost());\n        webgl2Renderer.on('contextRestored', () => this.handleContextRestored());\n\n        return true;\n      }\n      webgl2Renderer.dispose();\n    }\n\n    // Try WebGL 1.0 if WebGL 2.0 is not available\n    if (this.options.fallbackToCanvas !== false) {\n      const webglRenderer = new WebGLRenderer();\n      if (webglRenderer.initialize(this.canvas)) {\n        this.renderer = webglRenderer;\n        this.isWebGL = true;\n\n        // Setup WebGL event listeners\n        webglRenderer.on('error', (error) => this.emit('error', error));\n        webglRenderer.on('contextLost', () => this.handleContextLost());\n        webglRenderer.on('contextRestored', () => this.handleContextRestored());\n\n        return true;\n      }\n      webglRenderer.dispose();\n    }\n\n    // Fallback to Canvas2D\n    const canvas2DFallback = new Canvas2DFallback();\n    if (canvas2DFallback.initialize(this.canvas)) {\n      this.renderer = canvas2DFallback;\n      this.isWebGL = false;\n      return true;\n    }\n\n    return false;\n  }\n\n  private setupStateListeners(): void {\n    this.stateManager.on('transitionStart', (from, to) => {\n      this.emit('transitionStart', from, to);\n      this.startTransition(from, to);\n    });\n\n    this.stateManager.on('transitionEnd', (index) => {\n      this.emit('transitionEnd', index);\n    });\n\n    this.stateManager.on('playStateChange', (isPlaying) => {\n      if (isPlaying) {\n        this.emit('play');\n        this.startAutoplay();\n      } else {\n        this.emit('pause');\n        this.stopAutoplay();\n      }\n    });\n\n    this.stateManager.on('indexChange', (oldIndex, newIndex) => {\n      this.emit('imageChange', newIndex);\n    });\n  }\n\n  private async preloadImages(): Promise<void> {\n    const images = this.stateManager.get('images');\n\n    const loadedImages = await this.imageLoader.preloadWithProgress(images, (loaded, _total) => {\n      if (loaded === 1 && this.loadedImages.size === 0) {\n        // First image loaded, can start rendering\n        const startIndex = this.stateManager.get('currentIndex');\n        const imageUrl = images[startIndex];\n        if (imageUrl) {\n          const initialImage = this.imageLoader.getFromCache(imageUrl);\n          if (initialImage) {\n            this.loadedImages.set(imageUrl, initialImage);\n            this.emit('imageLoaded', startIndex, initialImage);\n            this.prepareInitialRender(initialImage, startIndex);\n          }\n        }\n      }\n    });\n\n    // Store all loaded images\n    loadedImages.forEach((image, index) => {\n      this.loadedImages.set(images[index]!, image);\n      this.emit('imageLoaded', index, image);\n\n      // Create WebGL texture if using WebGL\n      if (\n        this.isWebGL &&\n        (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer)\n      ) {\n        const texture = this.renderer.loadTexture(image.element);\n        if (texture) {\n          this.textures.set(images[index]!, texture);\n        }\n      }\n    });\n\n    this.emit('allImagesLoaded', loadedImages);\n  }\n\n  private prepareInitialRender(image: LoadedImage, imageIndex?: number): void {\n    if (\n      this.isWebGL &&\n      (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer)\n    ) {\n      const images = this.stateManager.get('images');\n      const index = imageIndex ?? this.stateManager.get('currentIndex');\n      const imageSrc = images[index]!;\n      \n      // Ensure the renderer has the image element to get size info\n      \n      // Load texture (this will also cache the image size)\n      let texture = this.renderer.loadTexture(image.element);\n      if (texture) {\n        this.textures.set(imageSrc, texture);\n      }\n\n      if (texture) {\n        // Get current effect and its uniforms\n        const effectName = this.stateManager.get('effect');\n        const effect = this.effectManager.get(effectName);\n        const uniforms = effect ? effect.getUniforms(0) : {};\n\n        \n        // Set the effect to renderer before initial render\n        if (effect) {\n          this.renderer.setEffect({\n            vertexShader: effect.vertexShader,\n            fragmentShader: effect.fragmentShader,\n          });\n        }\n        \n        // For initial render, pass the same image as both textures\n        this.renderer.render(texture, texture, 0, uniforms, imageSrc, imageSrc);\n      }\n    } else if (this.renderer instanceof Canvas2DFallback) {\n      this.renderer.setImages(image.element, null);\n      this.renderer.render(0);\n    }\n  }\n\n  private startTransition(from: number, to: number): void {\n    const images = this.stateManager.get('images');\n    const fromImage = this.loadedImages.get(images[from]!);\n    const toImage = this.loadedImages.get(images[to]!);\n\n    if (!fromImage || !toImage) {\n      // Images not loaded yet, skip transition\n      this.stateManager.endTransition(to);\n      return;\n    }\n\n    this.transitionStartTime = performance.now();\n\n    if (\n      this.isWebGL &&\n      (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer)\n    ) {\n      const fromTexture = this.textures.get(images[from]!);\n      const toTexture = this.textures.get(images[to]!);\n\n      if (fromTexture && toTexture) {\n        // Set effect if needed\n        const effectName = this.stateManager.get('effect');\n        let effect = this.effectManager.get(effectName);\n\n        // If TrianglePeelV2, check if it's going to work\n        if (effectName === 'trianglePeelV2' && effect) {\n          try {\n            // Check if effect requires custom mesh (WebGL 2.0)\n            if (this.renderer instanceof WebGL2Renderer && effect.requiresCustomMesh) {\n              const mesh = effect.getMesh?.();\n              if (!mesh || !mesh.positions || !mesh.indices) {\n                console.error(\n                  '[CarouselCore.startTransition] TrianglePeelV2 mesh is invalid, falling back to fade',\n                );\n                effect = this.effectManager.get('fade');\n                this.stateManager.set('effect', 'fade');\n              } else {\n                this.renderer.setMesh({\n                  vertices: mesh.positions,\n                  indices: mesh.indices,\n                  texCoords: mesh.texCoords,\n                  normals: mesh.normals,\n                  instanceData: effect.getInstanceData?.()?.positions || undefined,\n                });\n              }\n            }\n          } catch (error) {\n            console.error('[CarouselCore.startTransition] Error setting up TrianglePeelV2:', error);\n            effect = this.effectManager.get('fade');\n            this.stateManager.set('effect', 'fade');\n          }\n        }\n\n        if (effect) {\n          this.renderer.setEffect({\n            vertexShader: effect.vertexShader,\n            fragmentShader: effect.fragmentShader,\n          });\n        }\n\n        this.animateTransition(fromTexture, toTexture, to);\n      } else {\n        console.error('[CarouselCore.startTransition] Missing texture:', {\n          fromTexture: !!fromTexture,\n          toTexture: !!toTexture,\n        });\n      }\n    } else if (this.renderer instanceof Canvas2DFallback) {\n      this.renderer.setImages(fromImage.element, toImage.element);\n      this.animateTransition(null, null, to);\n    }\n  }\n\n  private animateTransition(\n    fromTexture: WebGLTexture | null,\n    toTexture: WebGLTexture | null,\n    toIndex: number,\n  ): void {\n    const animate = () => {\n      if (!this.transitionStartTime) {\n        return;\n      }\n\n      const elapsed = performance.now() - this.transitionStartTime;\n      const duration = this.stateManager.get('transitionDuration');\n      const progress = Math.min(elapsed / duration, 1);\n\n      try {\n        if (\n          this.isWebGL &&\n          (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer) &&\n          fromTexture &&\n          toTexture\n        ) {\n          const effect = this.effectManager.get(this.stateManager.get('effect'));\n          const uniforms = effect ? effect.getUniforms(progress) : {};\n          const images = this.stateManager.get('images');\n          const currentIndex = this.stateManager.get('currentIndex');\n          const fromSrc = images[currentIndex];\n          const toSrc = images[toIndex];\n\n          if (this.renderer instanceof WebGL2Renderer && effect?.getInstanceData) {\n            const instanceData = effect.getInstanceData();\n            const instanceCount = instanceData?.positions\n              ? instanceData.positions.length / 12\n              : undefined;\n            // Only use instanced rendering if we actually have instance data\n            if (instanceCount && instanceCount > 0) {\n              this.renderer.render(\n                fromTexture,\n                toTexture,\n                progress,\n                uniforms,\n                fromSrc,\n                toSrc,\n                instanceCount,\n              );\n            } else {\n              this.renderer.render(fromTexture, toTexture, progress, uniforms, fromSrc, toSrc);\n            }\n          } else {\n            this.renderer.render(fromTexture, toTexture, progress, uniforms, fromSrc, toSrc);\n          }\n        } else if (this.renderer instanceof Canvas2DFallback) {\n          this.renderer.render(progress);\n        }\n      } catch (error) {\n        console.error('[CarouselCore.animate] Error during render:', error);\n        // End transition on error\n        this.animationId = null;\n        this.transitionStartTime = null;\n        this.stateManager.endTransition(toIndex);\n        return;\n      }\n\n      if (progress < 1) {\n        this.animationId = requestAnimationFrame(animate);\n      } else {\n        this.animationId = null;\n        this.transitionStartTime = null;\n        this.stateManager.endTransition(toIndex);\n\n        // Schedule next transition if autoplay\n        if (this.stateManager.get('isPlaying')) {\n          this.scheduleNextTransition();\n        }\n      }\n    };\n\n    animate();\n  }\n\n  private handleContextLost(): void {\n    // Cancel any ongoing animation\n    if (this.animationId) {\n      cancelAnimationFrame(this.animationId);\n      this.animationId = null;\n    }\n\n    // Clear textures\n    this.textures.clear();\n  }\n\n  private handleContextRestored(): void {\n    // Recreate textures\n    if (\n      this.isWebGL &&\n      (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer)\n    ) {\n      for (const [url, image] of this.loadedImages) {\n        const texture = this.renderer.loadTexture(image.element);\n        if (texture) {\n          this.textures.set(url, texture);\n        }\n      }\n    }\n\n    // Redraw current image\n    const currentIndex = this.stateManager.get('currentIndex');\n    const images = this.stateManager.get('images');\n    const currentImage = this.loadedImages.get(images[currentIndex]!);\n\n    if (currentImage) {\n      this.prepareInitialRender(currentImage);\n    }\n  }\n\n  private startAutoplay(): void {\n    this.stopAutoplay();\n    this.scheduleNextTransition();\n  }\n\n  private stopAutoplay(): void {\n    if (this.autoplayTimer) {\n      clearTimeout(this.autoplayTimer);\n      this.autoplayTimer = null;\n    }\n  }\n\n  private scheduleNextTransition(): void {\n    if (!this.stateManager.get('isPlaying')) return;\n\n    // Clear any existing timer to prevent duplicates\n    this.stopAutoplay();\n\n    const interval = this.stateManager.get('autoplayInterval');\n    this.autoplayTimer = setTimeout(() => {\n      if (this.stateManager.get('isPlaying') && !this.stateManager.get('isTransitioning')) {\n        this.next();\n      }\n    }, interval);\n  }\n\n  // Public API\n  next(): void {\n    if (!this.stateManager.get('isTransitioning') && this.stateManager.canGoNext()) {\n      const nextIndex = this.stateManager.getNextIndex();\n      this.stateManager.startTransition(nextIndex);\n    }\n  }\n\n  previous(): void {\n    if (!this.stateManager.get('isTransitioning') && this.stateManager.canGoPrevious()) {\n      const prevIndex = this.stateManager.getPreviousIndex();\n      this.stateManager.startTransition(prevIndex);\n    }\n  }\n\n  goTo(index: number): void {\n    const images = this.stateManager.get('images');\n    if (\n      index >= 0 &&\n      index < images.length &&\n      index !== this.stateManager.get('currentIndex') &&\n      !this.stateManager.get('isTransitioning')\n    ) {\n      this.stateManager.startTransition(index);\n    }\n  }\n\n  play(): void {\n    this.stateManager.set('isPlaying', true);\n  }\n\n  pause(): void {\n    this.stateManager.set('isPlaying', false);\n  }\n\n  setAutoplay(enabled: boolean, interval?: number): void {\n    if (interval !== undefined) {\n      this.stateManager.set('autoplayInterval', interval);\n    }\n    this.stateManager.set('isPlaying', enabled);\n  }\n\n  setTransitionDuration(duration: number): void {\n    this.stateManager.set('transitionDuration', duration);\n  }\n\n  setEffect(effectName: string): boolean {\n    if (this.effectManager.has(effectName)) {\n      const effect = this.effectManager.get(effectName);\n\n      // Check if effect requires WebGL 2.0\n      if (effect && effect.requiresWebGL2) {\n        if (!(this.renderer instanceof WebGL2Renderer)) {\n          console.warn(\n            `Effect \"${effectName}\" requires WebGL 2.0, but current renderer is ${this.renderer?.constructor.name}. Falling back to fade effect.`,\n          );\n          // Fallback to fade effect\n          return this.setEffect('fade');\n        }\n      }\n\n      this.stateManager.set('effect', effectName);\n\n      // Update renderer with new effect\n      if (\n        this.isWebGL &&\n        (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer) &&\n        effect\n      ) {\n        this.renderer.setEffect({\n          vertexShader: effect.vertexShader,\n          fragmentShader: effect.fragmentShader,\n        });\n\n        // Re-render current image with new effect\n        const currentIndex = this.stateManager.get('currentIndex');\n        const images = this.stateManager.get('images');\n        const currentImageSrc = images[currentIndex];\n\n        if (currentImageSrc) {\n          const texture = this.textures.get(currentImageSrc);\n          if (texture) {\n            this.renderer.render(texture, null, 0, effect.getUniforms(0), currentImageSrc);\n          }\n        }\n      }\n\n      return true;\n    }\n    return false;\n  }\n\n  registerEffect(effect: IEffect): void {\n    this.effectManager.register(effect);\n  }\n\n  getCurrentIndex(): number {\n    return this.stateManager.get('currentIndex');\n  }\n\n  getImages(): LoadedImage[] {\n    const urls = this.stateManager.get('images');\n    return urls\n      .map((url) => this.loadedImages.get(url))\n      .filter((img): img is LoadedImage => img !== undefined);\n  }\n\n  resize(width?: number, height?: number): void {\n    if (!this.renderer) return;\n\n    // Use provided dimensions or get from canvas\n    const actualWidth = width ?? this.canvas.width;\n    const actualHeight = height ?? this.canvas.height;\n\n    this.renderer.resize(actualWidth, actualHeight);\n\n    // Redraw current state\n    const currentIndex = this.stateManager.get('currentIndex');\n    const images = this.stateManager.get('images');\n    const currentImageSrc = images[currentIndex];\n\n    if (!currentImageSrc) return;\n\n    const currentImage = this.loadedImages.get(currentImageSrc);\n    if (!currentImage) return;\n\n    // If transitioning, let the animation loop handle it\n    if (this.stateManager.get('isTransitioning')) {\n      return;\n    }\n\n    // Redraw the current image\n    if (\n      this.isWebGL &&\n      (this.renderer instanceof WebGLRenderer || this.renderer instanceof WebGL2Renderer)\n    ) {\n      const texture = this.textures.get(currentImageSrc);\n      if (texture) {\n        // Get current effect and its uniforms\n        const effectName = this.stateManager.get('effect');\n        const effect = this.effectManager.get(effectName);\n        const uniforms = effect ? effect.getUniforms(0) : {};\n\n        this.renderer.render(texture, null, 0, uniforms, currentImageSrc);\n      }\n    } else if (this.renderer instanceof Canvas2DFallback) {\n      this.renderer.setImages(currentImage.element, null);\n      this.renderer.render(0);\n    }\n  }\n\n  dispose(): void {\n    // Stop animations\n    if (this.animationId) {\n      cancelAnimationFrame(this.animationId);\n      this.animationId = null;\n    }\n\n    // Stop autoplay\n    this.stopAutoplay();\n\n    // Clean up renderer\n    if (this.renderer) {\n      this.renderer.dispose();\n      this.renderer = null;\n    }\n\n    // Clear caches\n    this.imageLoader.clearCache();\n    this.loadedImages.clear();\n    this.textures.clear();\n\n    // Remove all listeners\n    this.removeAllListeners();\n    this.stateManager.removeAllListeners();\n  }\n\n  isReady(): boolean {\n    return this.renderer !== null && this.loadedImages.size > 0;\n  }\n\n  isUsingWebGL(): boolean {\n    return this.isWebGL;\n  }\n}\n","import { CarouselCore } from './core/CarouselCore';\nimport { EventEmitter } from './core/EventEmitter';\nimport type { IEffect } from './core/EffectManager';\n\nimport type { WebGLCarouselOptions, WebGLCarouselEvents } from './types';\n\nexport type { WebGLCarouselOptions, WebGLCarouselEvents };\n\nexport class WebGLCarousel extends EventEmitter<WebGLCarouselEvents> {\n  private core: CarouselCore;\n  private container: HTMLElement;\n  private canvas: HTMLCanvasElement;\n  private options: Required<WebGLCarouselOptions>;\n  private isInitialized = false;\n  private images: string[];\n\n  constructor(options: WebGLCarouselOptions) {\n    super();\n\n    // Validate and set options\n    this.options = this.validateOptions(options);\n    this.images = this.options.images;\n\n    // Get container element\n    this.container = this.getContainer(this.options.container);\n\n    // Create canvas\n    this.canvas = this.createCanvas();\n\n    // Initialize core\n    this.core = this.createCore();\n\n    // Initialize\n    void this.initialize();\n  }\n\n  private validateOptions(options: WebGLCarouselOptions): Required<WebGLCarouselOptions> {\n    if (!options.container) {\n      throw new Error('Container is required');\n    }\n\n    if (!options.images || options.images.length === 0) {\n      throw new Error('At least one image is required');\n    }\n\n    return {\n      container: options.container,\n      images: options.images,\n      effect: options.effect || 'fade',\n      effects: options.effects || [],\n      autoplay: options.autoplay ?? false,\n      autoplayInterval: options.autoplayInterval ?? 3000,\n      navigation: options.navigation ?? true,\n      pagination: options.pagination ?? true,\n      loop: options.loop ?? true,\n      preload: options.preload ?? true,\n      fallbackToCanvas2D: options.fallbackToCanvas2D ?? true,\n      transitionDuration: options.transitionDuration ?? 1000,\n      startIndex: options.startIndex ?? 0,\n      easing: options.easing || ((t: number) => t),\n      onImageChange: options.onImageChange || (() => {}),\n      onTransitionStart: options.onTransitionStart || (() => {}),\n      onTransitionEnd: options.onTransitionEnd || (() => {}),\n      onError: options.onError || (() => {}),\n    };\n  }\n\n  private getContainer(container: string | HTMLElement): HTMLElement {\n    if (typeof container === 'string') {\n      const element = document.querySelector(container);\n      if (!element) {\n        throw new Error(`Container element not found: ${container}`);\n      }\n      return element as HTMLElement;\n    }\n    return container;\n  }\n\n  private createCanvas(): HTMLCanvasElement {\n    // Ensure container has position for absolute children\n    const containerPosition = window.getComputedStyle(this.container).position;\n    if (containerPosition === 'static') {\n      this.container.style.position = 'relative';\n    }\n\n    const canvas = document.createElement('canvas');\n    canvas.style.width = '100%';\n    canvas.style.height = '100%';\n    canvas.style.display = 'block';\n    this.container.appendChild(canvas);\n\n    return canvas;\n  }\n\n  private resizeCanvas(): void {\n    const rect = this.container.getBoundingClientRect();\n    this.canvas.width = rect.width * window.devicePixelRatio;\n    this.canvas.height = rect.height * window.devicePixelRatio;\n    this.canvas.style.width = `${rect.width}px`;\n    this.canvas.style.height = `${rect.height}px`;\n  }\n\n  private createCore(): CarouselCore {\n    // Extract effect name if it's an IEffect object\n    const effectName =\n      typeof this.options.effect === 'string'\n        ? this.options.effect\n        : this.options.effect?.name || 'fade';\n\n    return new CarouselCore({\n      canvas: this.canvas,\n      images: this.options.images,\n      effect: effectName,\n      autoplay: this.options.autoplay,\n      autoplayInterval: this.options.autoplayInterval,\n      transitionDuration: this.options.transitionDuration,\n      loop: this.options.loop,\n      fallbackToCanvas: this.options.fallbackToCanvas2D,\n      // Remove callbacks here to avoid duplicate events\n    });\n  }\n\n  private async initialize(): Promise<void> {\n    try {\n      // Resize canvas before initialization\n      this.resizeCanvas();\n\n      // Set up event listeners\n      this.setupEventListeners();\n\n      // Initialize core\n      await this.core.initialize();\n\n      // Set initial effect\n      if (typeof this.options.effect === 'object') {\n        // Register and use custom effect\n        this.registerEffect(this.options.effect);\n        this.setEffect(this.options.effect.name);\n      } else {\n        this.setEffect(this.options.effect);\n      }\n\n      // Register additional effects if provided\n      if (this.options.effects) {\n        this.options.effects.forEach((effect) => {\n          this.registerEffect(effect);\n        });\n      }\n\n      // Set up autoplay\n      if (this.options.autoplay) {\n        this.core.setAutoplay(true, this.options.autoplayInterval);\n      }\n\n      // Set transition duration\n      this.core.setTransitionDuration(this.options.transitionDuration);\n\n      // Create UI controls\n      if (this.options.navigation) {\n        this.createNavigationControls();\n      }\n\n      if (this.options.pagination) {\n        this.createPaginationControls();\n        // Set initial active state\n        this.updatePagination(this.options.startIndex || 0);\n      }\n\n      // Set initial canvas size\n      this.resizeCanvas();\n\n      // Handle window resize\n      window.addEventListener('resize', this.handleResize);\n\n      this.isInitialized = true;\n      this.emit('ready');\n    } catch (error) {\n      this.handleError(error as Error);\n    }\n  }\n\n  private setupEventListeners(): void {\n    // Forward core events\n    this.core.on('imageChange', (...args: unknown[]) => {\n      const index = args[0] as number;\n      this.emit('imageChange', index);\n      this.options.onImageChange?.(index);\n      this.updatePagination(index);\n    });\n\n    this.core.on('transitionStart', (from: number, to: number) => {\n      this.emit('transitionStart', from, to);\n      this.options.onTransitionStart?.(from, to);\n    });\n\n    this.core.on('transitionEnd', (index: number) => {\n      this.emit('transitionEnd', index);\n      this.options.onTransitionEnd?.(index);\n    });\n\n    this.core.on('error', (error) => {\n      this.handleError(error);\n    });\n\n    this.core.on('ready', () => {});\n  }\n\n  private handleError(error: Error): void {\n    this.emit('error', error);\n    this.options.onError?.(error);\n    console.error('WebGLCarousel error:', error);\n  }\n\n  private handleResize = (): void => {\n    this.resizeCanvas();\n    this.core.resize(this.canvas.width, this.canvas.height);\n  };\n\n  private createNavigationControls(): void {\n    const prevButton = document.createElement('button');\n    prevButton.className = 'webgl-carousel-prev';\n    prevButton.innerHTML = '&lsaquo;';\n    prevButton.setAttribute('aria-label', 'Previous image');\n    prevButton.addEventListener('click', () => this.previous());\n\n    const nextButton = document.createElement('button');\n    nextButton.className = 'webgl-carousel-next';\n    nextButton.innerHTML = '&rsaquo;';\n    nextButton.setAttribute('aria-label', 'Next image');\n    nextButton.addEventListener('click', () => this.next());\n\n    this.container.appendChild(prevButton);\n    this.container.appendChild(nextButton);\n\n    // Add default styles\n    this.addNavigationStyles();\n  }\n\n  private createPaginationControls(): void {\n    const pagination = document.createElement('div');\n    pagination.className = 'webgl-carousel-pagination';\n\n    const imageCount = this.options.images.length;\n    for (let i = 0; i < imageCount; i++) {\n      const dot = document.createElement('button');\n      dot.className = 'webgl-carousel-dot';\n      dot.setAttribute('aria-label', `Go to image ${i + 1}`);\n      dot.addEventListener('click', () => this.goTo(i));\n\n      if (i === 0) {\n        dot.classList.add('active');\n      }\n\n      pagination.appendChild(dot);\n    }\n\n    this.container.appendChild(pagination);\n\n    // Add default styles\n    this.addPaginationStyles();\n  }\n\n  private updatePagination(index: number): void {\n    const dots = this.container.querySelectorAll('.webgl-carousel-dot');\n    dots.forEach((dot, i) => {\n      dot.classList.toggle('active', i === index);\n    });\n  }\n\n  private addNavigationStyles(): void {\n    if (document.getElementById('webgl-carousel-nav-styles')) return;\n\n    const style = document.createElement('style');\n    style.id = 'webgl-carousel-nav-styles';\n    style.textContent = `\n      .webgl-carousel-prev,\n      .webgl-carousel-next {\n        position: absolute;\n        top: 50%;\n        transform: translateY(-50%);\n        background: rgba(0, 0, 0, 0.5);\n        color: white;\n        border: none;\n        font-size: 2rem;\n        padding: 0.5rem 1rem;\n        cursor: pointer;\n        transition: background-color 0.3s;\n        z-index: 10;\n      }\n      \n      .webgl-carousel-prev:hover,\n      .webgl-carousel-next:hover {\n        background: rgba(0, 0, 0, 0.7);\n      }\n      \n      .webgl-carousel-prev {\n        left: 1rem;\n      }\n      \n      .webgl-carousel-next {\n        right: 1rem;\n      }\n    `;\n\n    document.head.appendChild(style);\n  }\n\n  private addPaginationStyles(): void {\n    if (document.getElementById('webgl-carousel-pagination-styles')) return;\n\n    const style = document.createElement('style');\n    style.id = 'webgl-carousel-pagination-styles';\n    style.textContent = `\n      .webgl-carousel-pagination {\n        position: absolute;\n        bottom: 1rem;\n        left: 50%;\n        transform: translateX(-50%);\n        display: flex;\n        gap: 0.5rem;\n        z-index: 10;\n      }\n      \n      .webgl-carousel-dot {\n        width: 0.75rem;\n        height: 0.75rem;\n        border-radius: 50%;\n        border: 2px solid white;\n        background: transparent;\n        cursor: pointer;\n        transition: background-color 0.3s;\n      }\n      \n      .webgl-carousel-dot:hover {\n        background: rgba(255, 255, 255, 0.5);\n      }\n      \n      .webgl-carousel-dot.active {\n        background: white;\n      }\n    `;\n\n    document.head.appendChild(style);\n  }\n\n  // Public API methods\n\n  next(): void {\n    if (!this.isInitialized) return;\n    this.core.next();\n  }\n\n  previous(): void {\n    if (!this.isInitialized) return;\n    this.core.previous();\n  }\n\n  goTo(index: number): void {\n    if (!this.isInitialized) return;\n    this.core.goTo(index);\n  }\n\n  setEffect(effectName: string): void {\n    if (!this.isInitialized) return;\n\n    const success = this.core.setEffect(effectName);\n    if (success) {\n      this.emit('effectChange', effectName);\n    }\n  }\n\n  getAvailableEffects(): string[] {\n    // Return list of available effects\n    return [\n      'fade',\n      'slideLeft',\n      'slideRight',\n      'slideUp',\n      'slideDown',\n      'flipHorizontal',\n      'flipVertical',\n      'wave',\n      'distortion',\n      'dissolve',\n      'pixelDissolve',\n      'circle',\n      'morph',\n      'glitch',\n      'pageFlip',\n    ];\n  }\n\n  registerEffect(effect: IEffect): void {\n    if (!this.isInitialized) return;\n    this.core.registerEffect(effect);\n  }\n\n  play(): void {\n    if (!this.isInitialized) return;\n    this.core.setAutoplay(true, this.options.autoplayInterval);\n  }\n\n  pause(): void {\n    if (!this.isInitialized) return;\n    this.core.setAutoplay(false);\n  }\n\n  setAutoplay(enabled: boolean, interval?: number): void {\n    if (!this.isInitialized) return;\n    this.core.setAutoplay(enabled, interval);\n  }\n\n  setTransitionDuration(duration: number): void {\n    if (!this.isInitialized) return;\n    this.core.setTransitionDuration(duration);\n  }\n\n  getCurrentIndex(): number {\n    return this.core.getCurrentIndex();\n  }\n\n  getImageCount(): number {\n    // Return the actual number of successfully loaded images\n    return this.images.length;\n  }\n\n  destroy(): void {\n    if (!this.isInitialized) return;\n\n    // Remove event listener\n    window.removeEventListener('resize', this.handleResize);\n\n    // Destroy core\n    this.core.dispose();\n\n    // Remove canvas\n    if (this.canvas && this.canvas.parentNode) {\n      this.canvas.parentNode.removeChild(this.canvas);\n    }\n\n    // Remove controls\n    const controls = this.container.querySelectorAll(\n      '.webgl-carousel-prev, .webgl-carousel-next, .webgl-carousel-pagination',\n    );\n    controls.forEach((control) => control.remove());\n\n    // Clear container styles if needed\n    this.container.style.position = '';\n\n    this.isInitialized = false;\n    this.removeAllListeners();\n  }\n\n  isReady(): boolean {\n    return this.isInitialized;\n  }\n\n  isUsingWebGL(): boolean {\n    return this.core.isUsingWebGL();\n  }\n\n  updateImages(images: string[]): void {\n    if (!this.isInitialized) return;\n    this.options.images = images;\n    // Note: This would need to be implemented in CarouselCore\n    // For now, this is a placeholder\n  }\n\n  getImages(): string[] {\n    return this.options.images;\n  }\n}\n","import React, { useEffect, useRef, useImperativeHandle, forwardRef } from 'react';\nimport { WebGLCarousel } from '../../WebGLCarousel';\nimport type { WebGLCarouselOptions } from '../../WebGLCarousel';\nimport type { IEffect } from '../../core/EffectManager';\n\nexport interface WebGLCarouselReactProps extends Omit<WebGLCarouselOptions, 'container'> {\n  className?: string;\n  style?: React.CSSProperties;\n  width?: string | number;\n  height?: string | number;\n  // Event handlers\n  onReady?: () => void;\n  onImageChange?: (index: number) => void;\n  onTransitionStart?: (from: number, to: number) => void;\n  onTransitionEnd?: (index: number) => void;\n  onError?: (error: Error) => void;\n  onEffectChange?: (effectName: string) => void;\n}\n\nexport interface WebGLCarouselReactRef {\n  next: () => void;\n  previous: () => void;\n  goTo: (index: number) => void;\n  setEffect: (effectName: string) => void;\n  getAvailableEffects: () => string[];\n  registerEffect: (effect: IEffect) => void;\n  play: () => void;\n  pause: () => void;\n  setTransitionDuration: (duration: number) => void;\n  getCurrentIndex: () => number;\n  getImageCount: () => number;\n  isReady: () => boolean;\n}\n\nexport const WebGLCarouselReact = forwardRef<WebGLCarouselReactRef, WebGLCarouselReactProps>(\n  (props, ref) => {\n    const {\n      className,\n      style,\n      width = '100%',\n      height = '400px',\n      onReady,\n      onImageChange,\n      onTransitionStart,\n      onTransitionEnd,\n      onError,\n      onEffectChange,\n      ...carouselOptions\n    } = props;\n\n    const containerRef = useRef<HTMLDivElement>(null);\n    const carouselRef = useRef<WebGLCarousel | null>(null);\n\n    // Expose methods via ref\n    useImperativeHandle(\n      ref,\n      () => ({\n        next: () => carouselRef.current?.next(),\n        previous: () => carouselRef.current?.previous(),\n        goTo: (index: number) => carouselRef.current?.goTo(index),\n        setEffect: (effectName: string) => carouselRef.current?.setEffect(effectName),\n        getAvailableEffects: () => carouselRef.current?.getAvailableEffects() || [],\n        registerEffect: (effect: IEffect) => carouselRef.current?.registerEffect(effect),\n        play: () => carouselRef.current?.play(),\n        pause: () => carouselRef.current?.pause(),\n        setTransitionDuration: (duration: number) =>\n          carouselRef.current?.setTransitionDuration(duration),\n        getCurrentIndex: () => carouselRef.current?.getCurrentIndex() || 0,\n        getImageCount: () => carouselRef.current?.getImageCount() || 0,\n        isReady: () => carouselRef.current?.isReady() || false,\n      }),\n      [],\n    );\n\n    useEffect(() => {\n      if (!containerRef.current) return;\n\n      // Create carousel instance\n      const carousel = new WebGLCarousel({\n        ...carouselOptions,\n        container: containerRef.current,\n        onImageChange: onImageChange,\n        onTransitionStart: onTransitionStart,\n        onTransitionEnd: onTransitionEnd,\n        onError: onError,\n      });\n\n      carouselRef.current = carousel;\n\n      // Set up event listeners\n      if (onReady) {\n        carousel.on('ready', onReady);\n      }\n\n      if (onImageChange) {\n        carousel.on('imageChange', onImageChange);\n      }\n\n      if (onTransitionStart) {\n        carousel.on('transitionStart', onTransitionStart);\n      }\n\n      if (onTransitionEnd) {\n        carousel.on('transitionEnd', onTransitionEnd);\n      }\n\n      if (onError) {\n        carousel.on('error', onError);\n      }\n\n      if (onEffectChange) {\n        carousel.on('effectChange', onEffectChange);\n      }\n\n      // Cleanup\n      return () => {\n        carousel.destroy();\n        carouselRef.current = null;\n      };\n    }, []); // Only run once on mount\n\n    // Handle prop changes that require carousel updates\n    useEffect(() => {\n      if (!carouselRef.current || !carouselRef.current.isReady()) return;\n\n      if (carouselOptions.effect) {\n        if (typeof carouselOptions.effect === 'object') {\n          // Register and use custom effect\n          carouselRef.current.registerEffect(carouselOptions.effect);\n          carouselRef.current.setEffect(carouselOptions.effect.name);\n        } else {\n          carouselRef.current.setEffect(carouselOptions.effect);\n        }\n      }\n    }, [carouselOptions.effect]);\n\n    useEffect(() => {\n      if (!carouselRef.current || !carouselRef.current.isReady()) return;\n\n      if (carouselOptions.autoplay !== undefined) {\n        if (carouselOptions.autoplay) {\n          carouselRef.current.play();\n        } else {\n          carouselRef.current.pause();\n        }\n      }\n    }, [carouselOptions.autoplay]);\n\n    useEffect(() => {\n      if (!carouselRef.current || !carouselRef.current.isReady()) return;\n\n      if (carouselOptions.transitionDuration !== undefined) {\n        carouselRef.current.setTransitionDuration(carouselOptions.transitionDuration);\n      }\n    }, [carouselOptions.transitionDuration]);\n\n    const containerStyle: React.CSSProperties = {\n      width,\n      height,\n      position: 'relative',\n      overflow: 'hidden',\n      ...style,\n    };\n\n    return (\n      <div\n        ref={containerRef}\n        className={className}\n        style={containerStyle}\n        role=\"region\"\n        aria-label=\"Image carousel\"\n      />\n    );\n  },\n);\n\nWebGLCarouselReact.displayName = 'WebGLCarouselReact';\n\n// Export convenience hooks\nexport function useWebGLCarousel() {\n  const ref = useRef<WebGLCarouselReactRef>(null);\n\n  return {\n    ref,\n    next: () => ref.current?.next(),\n    previous: () => ref.current?.previous(),\n    goTo: (index: number) => ref.current?.goTo(index),\n    setEffect: (effectName: string) => ref.current?.setEffect(effectName),\n    getAvailableEffects: () => ref.current?.getAvailableEffects() || [],\n    registerEffect: (effect: IEffect) => ref.current?.registerEffect(effect),\n    play: () => ref.current?.play(),\n    pause: () => ref.current?.pause(),\n    setTransitionDuration: (duration: number) => ref.current?.setTransitionDuration(duration),\n    getCurrentIndex: () => ref.current?.getCurrentIndex() || 0,\n    getImageCount: () => ref.current?.getImageCount() || 0,\n    isReady: () => ref.current?.isReady() || false,\n  };\n}\n","import { defineComponent, h, onMounted, onUnmounted, ref, watch, PropType } from 'vue';\nimport { WebGLCarousel } from '../../WebGLCarousel';\nimport type { WebGLCarouselOptions } from '../../types';\nimport type { BaseEffect } from '../../effects/BaseEffect';\n\nexport interface WebGLCarouselVueProps {\n  images: string[];\n  autoplay?: boolean;\n  interval?: number;\n  transitionDuration?: number;\n  effect?: string | BaseEffect;\n  effects?: BaseEffect[];\n  showControls?: boolean;\n  enableTouch?: boolean;\n  startIndex?: number;\n  fallbackRenderer?: 'canvas2d' | null;\n  webglOptions?: WebGLContextAttributes;\n  easing?: (t: number) => number;\n  onTransitionStart?: (event: { from: number; to: number }) => void;\n  onTransitionEnd?: (event: { from: number; to: number }) => void;\n  onError?: (error: Error) => void;\n  onWebGLContextLost?: () => void;\n  onWebGLContextRestored?: () => void;\n  onImageLoad?: (event: { index: number; src: string }) => void;\n  onImageError?: (event: { index: number; src: string; error: Error }) => void;\n  onReady?: () => void;\n}\n\nexport const WebGLCarouselVue = defineComponent({\n  name: 'WebGLCarouselVue',\n  props: {\n    images: {\n      type: Array as PropType<string[]>,\n      required: true,\n    },\n    autoplay: {\n      type: Boolean,\n      default: false,\n    },\n    interval: {\n      type: Number,\n      default: 3000,\n    },\n    transitionDuration: {\n      type: Number,\n      default: 1000,\n    },\n    effect: {\n      type: [String, Object] as PropType<string | BaseEffect>,\n      default: 'fade',\n    },\n    effects: {\n      type: Array as PropType<BaseEffect[]>,\n      default: undefined,\n    },\n    showControls: {\n      type: Boolean,\n      default: true,\n    },\n    enableTouch: {\n      type: Boolean,\n      default: true,\n    },\n    startIndex: {\n      type: Number,\n      default: 0,\n    },\n    fallbackRenderer: {\n      type: String as PropType<'canvas2d' | null>,\n      default: 'canvas2d',\n    },\n    webglOptions: {\n      type: Object as PropType<WebGLContextAttributes>,\n      default: undefined,\n    },\n    easing: {\n      type: Function as PropType<(t: number) => number>,\n      default: undefined,\n    },\n    onTransitionStart: {\n      type: Function as PropType<(event: { from: number; to: number }) => void>,\n      default: undefined,\n    },\n    onTransitionEnd: {\n      type: Function as PropType<(event: { from: number; to: number }) => void>,\n      default: undefined,\n    },\n    onError: {\n      type: Function as PropType<(error: Error) => void>,\n      default: undefined,\n    },\n    onWebGLContextLost: {\n      type: Function as PropType<() => void>,\n      default: undefined,\n    },\n    onWebGLContextRestored: {\n      type: Function as PropType<() => void>,\n      default: undefined,\n    },\n    onImageLoad: {\n      type: Function as PropType<(event: { index: number; src: string }) => void>,\n      default: undefined,\n    },\n    onImageError: {\n      type: Function as PropType<(event: { index: number; src: string; error: Error }) => void>,\n      default: undefined,\n    },\n    onReady: {\n      type: Function as PropType<() => void>,\n      default: undefined,\n    },\n  },\n  setup(props, { expose }) {\n    const containerRef = ref<HTMLDivElement | null>(null);\n    let carousel: WebGLCarousel | null = null;\n\n    const initCarousel = () => {\n      if (!containerRef.value || carousel) return;\n\n      const options: WebGLCarouselOptions = {\n        container: containerRef.value,\n        images: props.images,\n        autoplay: props.autoplay,\n        autoplayInterval: props.interval,\n        transitionDuration: props.transitionDuration,\n        effect: typeof props.effect === 'string' ? props.effect : undefined,\n        startIndex: props.startIndex,\n      };\n\n      // Add custom effects if provided\n      if (props.effects) {\n        options.effects = props.effects;\n      }\n\n      // Add custom effect object if provided\n      if (typeof props.effect === 'object') {\n        options.effects = [props.effect];\n      }\n\n      // Add easing function if provided\n      if (props.easing) {\n        options.easing = props.easing;\n      }\n\n      carousel = new WebGLCarousel(options);\n\n      // Setup event listeners\n      if (props.onTransitionStart) {\n        carousel.on('transitionStart', (from: number, to: number) => {\n          props.onTransitionStart?.({ from, to });\n        });\n      }\n      if (props.onTransitionEnd) {\n        carousel.on('transitionEnd', (_index: number) => {\n          // Vue component expects different signature\n          props.onTransitionEnd?.({ from: 0, to: 0 });\n        });\n      }\n      if (props.onError) {\n        carousel.on('error', props.onError);\n      }\n      // These events are not part of WebGLCarousel's public API\n      if (props.onReady) {\n        carousel.on('ready', props.onReady);\n      }\n    };\n\n    const destroyCarousel = () => {\n      if (carousel) {\n        carousel.destroy();\n        carousel = null;\n      }\n    };\n\n    // Watch for prop changes\n    watch(\n      () => props.images,\n      (newImages) => {\n        if (carousel) {\n          carousel.updateImages(newImages);\n        }\n      },\n    );\n\n    watch(\n      () => props.autoplay,\n      (newAutoplay) => {\n        if (carousel) {\n          if (newAutoplay) {\n            carousel.play();\n          } else {\n            carousel.pause();\n          }\n        }\n      },\n    );\n\n    watch(\n      () => props.interval,\n      (newInterval) => {\n        if (carousel) {\n          carousel.setAutoplay(props.autoplay, newInterval);\n        }\n      },\n    );\n\n    watch(\n      () => props.effect,\n      (newEffect) => {\n        if (carousel && typeof newEffect === 'string') {\n          carousel.setEffect(newEffect);\n        }\n      },\n    );\n\n    onMounted(() => {\n      initCarousel();\n    });\n\n    onUnmounted(() => {\n      destroyCarousel();\n    });\n\n    // Expose methods\n    const next = () => {\n      carousel?.next();\n    };\n\n    const previous = () => {\n      carousel?.previous();\n    };\n\n    const goTo = (index: number) => {\n      carousel?.goTo(index);\n    };\n\n    const getCurrentIndex = () => {\n      return carousel?.getCurrentIndex() ?? 0;\n    };\n\n    const getTotalImages = () => {\n      return carousel?.getImageCount() ?? 0;\n    };\n\n    const setEffect = (effect: string | BaseEffect) => {\n      if (carousel && typeof effect === 'string') {\n        carousel.setEffect(effect);\n      }\n    };\n\n    const getAvailableEffects = () => {\n      return carousel?.getAvailableEffects() ?? [];\n    };\n\n    const registerEffect = (effect: BaseEffect) => {\n      // BaseEffect already implements IEffect\n      carousel?.registerEffect(effect);\n    };\n\n    const play = () => {\n      carousel?.play();\n    };\n\n    const pause = () => {\n      carousel?.pause();\n    };\n\n    const isPlaying = () => {\n      // WebGLCarousel doesn't have isPlaying method\n      return false;\n    };\n\n    const setAutoplayInterval = (interval: number) => {\n      carousel?.setAutoplay(true, interval);\n    };\n\n    const updateImages = (_images: string[]) => {\n      // WebGLCarousel doesn't support updating images dynamically\n    };\n\n    const isTransitioning = () => {\n      // WebGLCarousel doesn't have isTransitioning method\n      return false;\n    };\n\n    expose({\n      next,\n      previous,\n      goTo,\n      getCurrentIndex,\n      getTotalImages,\n      setEffect,\n      getAvailableEffects,\n      registerEffect,\n      play,\n      pause,\n      isPlaying,\n      setAutoplayInterval,\n      updateImages,\n      isTransitioning,\n    });\n\n    return () =>\n      h('div', {\n        ref: containerRef,\n        class: 'webgl-carousel-container',\n        style: {\n          width: '100%',\n          height: '100%',\n          position: 'relative',\n        },\n      });\n  },\n});\n","// Main entry point for webgl-carousel\nexport const VERSION = '0.1.0';\n\n// Main API\nexport { WebGLCarousel } from './WebGLCarousel';\nexport type { WebGLCarouselOptions, WebGLCarouselEvents } from './WebGLCarousel';\n\n// Core exports for advanced usage\nexport { EventEmitter } from './core/EventEmitter';\nexport { StateManager } from './core/StateManager';\nexport { ImageLoader } from './core/ImageLoader';\nexport { WebGLRenderer } from './core/WebGLRenderer';\nexport { Canvas2DFallback } from './core/Canvas2DFallback';\nexport { EffectManager, createEffectManager } from './core/EffectManager';\nexport { CarouselCore } from './core/CarouselCore';\n\n// Effect exports\nexport {\n  BaseEffect,\n  FadeEffect,\n  SlideEffect,\n  FlipEffect,\n  WaveEffect,\n  DistortionEffect,\n  DissolveEffect,\n  CircleEffect,\n  // Preset instances\n  fadeEffect,\n  slideLeftEffect,\n  slideRightEffect,\n  slideUpEffect,\n  slideDownEffect,\n  flipHorizontalEffect,\n  flipVerticalEffect,\n  waveEffect,\n  gentleWaveEffect,\n  intenseWaveEffect,\n  distortionEffect,\n  subtleDistortionEffect,\n  extremeDistortionEffect,\n  dissolveEffect,\n  pixelDissolveEffect,\n  smoothDissolveEffect,\n  circleEffect,\n  circleFromCenterEffect,\n  circleFromCornerEffect,\n  // Utilities\n  getDefaultEffects,\n  registerDefaultEffects,\n  createFragmentShader,\n  commonShaderFunctions,\n  // Custom effect utilities\n  CustomEffect,\n  createCustomEffect,\n  createCustomEffectFromFiles,\n} from './effects';\n\n// Type exports\nexport type { IEffect } from './core/EffectManager';\nexport type {\n  SlideDirection,\n  FlipAxis,\n  WaveOptions,\n  DistortionOptions,\n  CustomEffectOptions,\n} from './effects';\nexport type {\n  CarouselState,\n  LoadedImage,\n  TransitionState,\n  CarouselTransitionOptions,\n} from './types';\n\n// Export React adapter\nexport { WebGLCarouselReact } from './adapters/react/WebGLCarouselReact';\nexport type { WebGLCarouselReactProps } from './adapters/react/WebGLCarouselReact';\n\n// Export Vue adapter\nexport { WebGLCarouselVue } from './adapters/vue/WebGLCarouselVue';\nexport type { WebGLCarouselVueProps } from './adapters/vue/WebGLCarouselVue';\n\n// Export Svelte adapter reference\n// Note: Svelte components cannot be directly exported in bundled JS\n// Users should import the .svelte file directly from their Svelte projects\n\n// Default export for convenience\nimport { WebGLCarousel as WGLCarousel } from './WebGLCarousel';\nexport default WGLCarousel;\n"],"names":["forwardRef","useRef","useImperativeHandle","useEffect","defineComponent","ref","watch","onMounted","onUnmounted","h"],"mappings":";;;;;;;MAMa,YAAY,CAAA;AAAzB,IAAA,WAAA,GAAA;AACU,QAAA,IAAA,CAAA,MAAM,GAAoC,IAAI,GAAG,EAAE;IAwD7D;IAtDE,EAAE,CAAoB,KAAQ,EAAE,OAAgC,EAAA;QAC9D,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;YAC3B,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,GAAG,EAAE,CAAC;QACnC;AACA,QAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAE,CAAC,GAAG,CAAC,OAAuB,CAAC;AACpD,QAAA,OAAO,IAAI;IACb;IAEA,GAAG,CAAoB,KAAQ,EAAE,OAAgC,EAAA;QAC/D,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC;QACvC,IAAI,QAAQ,EAAE;AACZ,YAAA,QAAQ,CAAC,MAAM,CAAC,OAAuB,CAAC;AACxC,YAAA,IAAI,QAAQ,CAAC,IAAI,KAAK,CAAC,EAAE;AACvB,gBAAA,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC;YAC3B;QACF;AACA,QAAA,OAAO,IAAI;IACb;AAEA,IAAA,IAAI,CAAoB,KAAQ,EAAE,GAAG,IAAU,EAAA;QAC7C,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC;QACvC,IAAI,QAAQ,EAAE;AACZ,YAAA,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,KAAI;AAC3B,gBAAA,IAAI;AACF,oBAAA,OAAO,CAAC,GAAG,IAAI,CAAC;gBAClB;gBAAE,OAAO,KAAK,EAAE;AACd,oBAAA,OAAO,CAAC,KAAK,CAAC,CAAA,4BAAA,EAA+B,MAAM,CAAC,KAAK,CAAC,CAAA,EAAA,CAAI,EAAE,KAAK,CAAC;gBACxE;AACF,YAAA,CAAC,CAAC;QACJ;AACA,QAAA,OAAO,IAAI;IACb;IAEA,IAAI,CAAoB,KAAQ,EAAE,OAAgC,EAAA;AAChE,QAAA,MAAM,WAAW,GAAG,CAAC,GAAG,IAAU,KAAI;AACpC,YAAA,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,CAAC;AAC5B,YAAA,OAAO,CAAC,GAAG,IAAI,CAAC;AAClB,QAAA,CAAC;QACD,OAAO,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,WAAW,CAAC;IACpC;AAEA,IAAA,kBAAkB,CAAC,KAAe,EAAA;QAChC,IAAI,KAAK,EAAE;AACT,YAAA,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC;QAC3B;aAAO;AACL,YAAA,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;QACrB;AACA,QAAA,OAAO,IAAI;IACb;AAEA,IAAA,aAAa,CAAC,KAAc,EAAA;QAC1B,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC;QACvC,OAAO,QAAQ,GAAG,QAAQ,CAAC,IAAI,GAAG,CAAC;IACrC;AACD;;AC1CK,MAAO,YAAa,SAAQ,YAAyB,CAAA;AAGzD,IAAA,WAAA,CAAY,eAAuC,EAAE,EAAA;AACnD,QAAA,KAAK,EAAE;QACP,IAAI,CAAC,KAAK,GAAG;AACX,YAAA,YAAY,EAAE,CAAC;AACf,YAAA,MAAM,EAAE,EAAE;AACV,YAAA,SAAS,EAAE,KAAK;AAChB,YAAA,eAAe,EAAE,KAAK;AACtB,YAAA,MAAM,EAAE,MAAM;AACd,YAAA,kBAAkB,EAAE,IAAI;AACxB,YAAA,gBAAgB,EAAE,IAAI;AACtB,YAAA,IAAI,EAAE,IAAI;AACV,YAAA,GAAG,YAAY;SAChB;IACH;IAEA,QAAQ,GAAA;AACN,QAAA,OAAO,EAAE,GAAG,IAAI,CAAC,KAAK,EAAE;IAC1B;AAEA,IAAA,GAAG,CAAgC,GAAM,EAAA;AACvC,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;IACxB;IAEA,GAAG,CAAgC,GAAM,EAAE,KAAuB,EAAA;QAChE,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;AAChC,QAAA,IAAI,QAAQ,KAAK,KAAK,EAAE;AACtB,YAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,KAAK;YACvB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,CAAC;;AAG9C,YAAA,IAAI,GAAG,KAAK,cAAc,EAAE;gBAC1B,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAkB,EAAE,KAAe,CAAC;YAC/D;AAAO,iBAAA,IAAI,GAAG,KAAK,WAAW,EAAE;AAC9B,gBAAA,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,KAAgB,CAAC;YAChD;QACF;IACF;AAEA,IAAA,MAAM,CAAC,OAA+B,EAAA;AACpC,QAAA,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,KAAI;AAC/C,YAAA,IAAI,CAAC,GAAG,CAAC,GAA0B,EAAE,KAAK,CAAC;AAC7C,QAAA,CAAC,CAAC;IACJ;IAEA,SAAS,GAAA;QACP,MAAM,EAAE,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK;QACjD,OAAO,IAAI,IAAI,YAAY,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC;IACjD;IAEA,aAAa,GAAA;QACX,MAAM,EAAE,YAAY,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK;AACzC,QAAA,OAAO,IAAI,IAAI,YAAY,GAAG,CAAC;IACjC;IAEA,YAAY,GAAA;QACV,MAAM,EAAE,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK;QACjD,IAAI,YAAY,KAAK,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACtC,OAAO,IAAI,GAAG,CAAC,GAAG,YAAY;QAChC;QACA,OAAO,YAAY,GAAG,CAAC;IACzB;IAEA,gBAAgB,GAAA;QACd,MAAM,EAAE,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK;AACjD,QAAA,IAAI,YAAY,KAAK,CAAC,EAAE;AACtB,YAAA,OAAO,IAAI,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,YAAY;QAChD;QACA,OAAO,YAAY,GAAG,CAAC;IACzB;AAEA,IAAA,eAAe,CAAC,OAAe,EAAA;AAC7B,QAAA,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE;AAC/B,YAAA,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY;AACzC,YAAA,IAAI,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,SAAS,EAAE,OAAO,CAAC;QAClD;IACF;AAEA,IAAA,aAAa,CAAC,QAAgB,EAAA;AAC5B,QAAA,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE;AAC9B,YAAA,IAAI,CAAC,GAAG,CAAC,iBAAiB,EAAE,KAAK,CAAC;AAClC,YAAA,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,QAAQ,CAAC;AAClC,YAAA,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,QAAQ,CAAC;QACtC;IACF;IAEA,KAAK,GAAA;QACH,IAAI,CAAC,MAAM,CAAC;AACV,YAAA,YAAY,EAAE,CAAC;AACf,YAAA,SAAS,EAAE,KAAK;AAChB,YAAA,eAAe,EAAE,KAAK;AACvB,SAAA,CAAC;IACJ;AACD;;MCxGY,WAAW,CAAA;AAKtB,IAAA,WAAA,CAAY,UAA8B,EAAE,EAAA;AAJpC,QAAA,IAAA,CAAA,KAAK,GAA6B,IAAI,GAAG,EAAE;AAC3C,QAAA,IAAA,CAAA,eAAe,GAAsC,IAAI,GAAG,EAAE;QAIpE,IAAI,CAAC,OAAO,GAAG;AACb,YAAA,WAAW,EAAE,WAAW;AACxB,YAAA,OAAO,EAAE,KAAK;AACd,YAAA,GAAG,OAAO;SACX;IACH;IAEA,MAAM,IAAI,CAAC,GAAW,EAAA;;QAEpB,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;QAClC,IAAI,MAAM,EAAE;AACV,YAAA,OAAO,MAAM;QACf;;QAGA,MAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG,CAAC;QAC7C,IAAI,OAAO,EAAE;AACX,YAAA,OAAO,OAAO;QAChB;;QAGA,MAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;QACvC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG,EAAE,WAAW,CAAC;AAE1C,QAAA,IAAI;AACF,YAAA,MAAM,WAAW,GAAG,MAAM,WAAW;YACrC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,WAAW,CAAC;AAChC,YAAA,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,CAAC;AAChC,YAAA,OAAO,WAAW;QACpB;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,CAAC;AAChC,YAAA,MAAM,KAAK;QACb;IACF;IAEA,MAAM,OAAO,CAAC,IAAc,EAAA;QAC1B,OAAO,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;IACvD;AAEA,IAAA,MAAM,mBAAmB,CACvB,IAAc,EACd,UAAoD,EAAA;AAEpD,QAAA,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM;QACzB,IAAI,MAAM,GAAG,CAAC;QACd,MAAM,OAAO,GAAkB,EAAE;AAEjC,QAAA,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;AACtB,YAAA,IAAI;gBACF,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;AAClC,gBAAA,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;AACnB,gBAAA,MAAM,EAAE;AACR,gBAAA,UAAU,GAAG,MAAM,EAAE,KAAK,CAAC;YAC7B;YAAE,OAAO,KAAK,EAAE;;gBAEd,OAAO,CAAC,IAAI,CAAC,CAAA,sBAAA,EAAyB,GAAG,CAAA,CAAE,EAAE,KAAK,CAAC;;gBAGnD,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;AAC/C,gBAAA,MAAM,CAAC,KAAK,GAAG,CAAC;AAChB,gBAAA,MAAM,CAAC,MAAM,GAAG,CAAC;gBACjB,MAAM,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;gBACnC,IAAI,GAAG,EAAE;AACP,oBAAA,GAAG,CAAC,SAAS,GAAG,kBAAkB;oBAClC,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;gBAC1B;;AAGA,gBAAA,MAAM,GAAG,GAAG,IAAI,KAAK,EAAE;AACvB,gBAAA,GAAG,CAAC,GAAG,GAAG,MAAM,CAAC,SAAS,EAAE;AAE5B,gBAAA,MAAM,gBAAgB,GAAgB;AACpC,oBAAA,GAAG,EAAE,GAAG;AACR,oBAAA,OAAO,EAAE,GAAG;AACZ,oBAAA,KAAK,EAAE,CAAC;AACR,oBAAA,MAAM,EAAE,CAAC;AACT,oBAAA,WAAW,EAAE,CAAC;iBACf;AAED,gBAAA,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC;AAC9B,gBAAA,MAAM,EAAE;AACR,gBAAA,UAAU,GAAG,MAAM,EAAE,KAAK,CAAC;YAC7B;QACF;AAEA,QAAA,OAAO,OAAO;IAChB;AAEA,IAAA,YAAY,CAAC,GAAW,EAAA;QACtB,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI;IACpC;AAEA,IAAA,UAAU,CAAC,GAAY,EAAA;QACrB,IAAI,GAAG,EAAE;AACP,YAAA,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC;AACtB,YAAA,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,CAAC;QAClC;aAAO;AACL,YAAA,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;AAClB,YAAA,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE;QAC9B;IACF;IAEA,YAAY,GAAA;AACV,QAAA,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI;IACxB;AAEQ,IAAA,SAAS,CAAC,GAAW,EAAA;QAC3B,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAI;AACrC,YAAA,MAAM,GAAG,GAAG,IAAI,KAAK,EAAE;YACvB,IAAI,SAAS,GAA0B,IAAI;YAE3C,MAAM,OAAO,GAAG,MAAK;gBACnB,IAAI,SAAS,EAAE;oBACb,YAAY,CAAC,SAAS,CAAC;oBACvB,SAAS,GAAG,IAAI;gBAClB;AACA,gBAAA,GAAG,CAAC,MAAM,GAAG,IAAI;AACjB,gBAAA,GAAG,CAAC,OAAO,GAAG,IAAI;AACpB,YAAA,CAAC;YAED,MAAM,UAAU,GAAG,MAAK;AACtB,gBAAA,OAAO,EAAE;gBACT,MAAM,KAAK,GAAG,GAAG,CAAC,YAAY,IAAI,GAAG,CAAC,KAAK;gBAC3C,MAAM,MAAM,GAAG,GAAG,CAAC,aAAa,IAAI,GAAG,CAAC,MAAM;AAC9C,gBAAA,OAAO,CAAC;oBACN,GAAG;AACH,oBAAA,OAAO,EAAE,GAAG;oBACZ,KAAK;oBACL,MAAM;oBACN,WAAW,EAAE,KAAK,GAAG,MAAM;AAC5B,iBAAA,CAAC;AACJ,YAAA,CAAC;AAED,YAAA,MAAM,WAAW,GAAG,CAAC,KAAsB,KAAI;AAC7C,gBAAA,OAAO,EAAE;AACT,gBAAA,MAAM,CAAC,IAAI,KAAK,CAAC,CAAA,sBAAA,EAAyB,GAAG,CAAA,EAAA,EAAK,KAAK,IAAI,EAAE,CAAA,CAAE,CAAC,CAAC;AACnE,YAAA,CAAC;;AAGD,YAAA,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,CAAC,EAAE;AACpD,gBAAA,SAAS,GAAG,UAAU,CAAC,MAAK;oBAC1B,WAAW,CAAC,SAAS,CAAC;AACxB,gBAAA,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;YAC1B;;;AAIA,YAAA,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;gBAC5B,GAAG,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW;YAC5C;AAEA,YAAA,GAAG,CAAC,MAAM,GAAG,UAAU;AACvB,YAAA,GAAG,CAAC,OAAO,GAAG,WAAW;AACzB,YAAA,GAAG,CAAC,GAAG,GAAG,GAAG;AACf,QAAA,CAAC,CAAC;IACJ;AACD;;ACvKK,MAAgB,iBAEpB,SAAQ,YAAiC,CAAA;AAF3C,IAAA,WAAA,GAAA;;QAGY,IAAA,CAAA,MAAM,GAA6B,IAAI;QACvC,IAAA,CAAA,EAAE,GAAoB,IAAI;QAC1B,IAAA,CAAA,OAAO,GAAwB,IAAI;AACnC,QAAA,IAAA,CAAA,QAAQ,GAA8B,IAAI,GAAG,EAAE;AAC/C,QAAA,IAAA,CAAA,UAAU,GAAmD,IAAI,GAAG,EAAE;AACtE,QAAA,IAAA,CAAA,QAAQ,GAAsC,IAAI,GAAG,EAAE;AACvD,QAAA,IAAA,CAAA,UAAU,GAAwB,IAAI,GAAG,EAAE;;AAwK3C,QAAA,IAAA,CAAA,iBAAiB,GAAG,CAAC,KAAY,KAAU;YACnD,KAAK,CAAC,cAAc,EAAE;AACtB,YAAA,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC;AAC1B,QAAA,CAAC;QAES,IAAA,CAAA,qBAAqB,GAAG,MAAW;AAC3C,YAAA,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAO,CAAC;AAC7B,YAAA,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC;AAC9B,QAAA,CAAC;IA6EH;;AA7OE,IAAA,WAAW,CAAC,KAAuB,EAAA;QACjC,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;AAEzB,QAAmB,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG;;AAGhD,QAAA,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;AACnC,YAAA,MAAM,SAAS,GAAG;AAChB,gBAAA,KAAK,EAAE,KAAK,CAAC,YAAY,IAAI,KAAK,CAAC,KAAK;AACxC,gBAAA,MAAM,EAAE,KAAK,CAAC,aAAa,IAAI,KAAK,CAAC,MAAM;aAC5C;YACD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,CAAC;QAC3C;aAAO;AACL,YAAmB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG;QAClD;;AAGA,QAAA,MAAM,eAAe,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC;QACpD,IAAI,eAAe,EAAE;AACnB,YAAA,OAAO,eAAe;QACxB;QAEA,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC;QACzC,IAAI,OAAO,EAAE;;YAEX,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC;QACvC;AAEA,QAAA,OAAO,OAAO;IAChB;;AAGU,IAAA,aAAa,CAAC,KAAuB,EAAA;QAC7C,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;QAEzB,MAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;AACvC,QAAA,IAAI,CAAC,OAAO;AAAE,YAAA,OAAO,IAAI;AAEzB,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC;AAChD,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAChB,IAAI,CAAC,EAAE,CAAC,UAAU,EAClB,CAAC,EACD,IAAI,CAAC,EAAE,CAAC,IAAI,EACZ,IAAI,CAAC,EAAE,CAAC,IAAI,EACZ,IAAI,CAAC,EAAE,CAAC,aAAa,EACrB,KAAK,CACN;;QAGD,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QACxF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QACxF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC;QACrF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC;AAErF,QAAA,OAAO,OAAO;IAChB;;IAGU,aAAa,CAAC,MAAc,EAAE,IAAY,EAAA;QAClD,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;QAEzB,MAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC;QACzC,IAAI,CAAC,MAAM,EAAE;AACX,YAAA,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC;QAC5C;QAEA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;AACpC,QAAA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC;AAE7B,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,CAAC,EAAE;YAC/D,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,MAAM,CAAC;AAC9C,YAAA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC;AAC5B,YAAA,MAAM,IAAI,KAAK,CAAC,6BAA6B,KAAK,CAAA,CAAE,CAAC;QACvD;AAEA,QAAA,OAAO,MAAM;IACf;;IAGU,aAAa,CAAC,YAAoB,EAAE,cAAsB,EAAA;QAClE,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;AAEzB,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;AAC5E,QAAA,MAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC;AAElF,QAAA,IAAI,CAAC,YAAY,IAAI,CAAC,cAAc;AAAE,YAAA,OAAO,IAAI;QAEjD,MAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;QACvC,IAAI,CAAC,OAAO,EAAE;AACZ,YAAA,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC;QACpD;QAEA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,YAAY,CAAC;QAC3C,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,cAAc,CAAC;AAC7C,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC;AAE5B,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,EAAE;YAC9D,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,OAAO,CAAC;AAChD,YAAA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC;AAC9B,YAAA,MAAM,IAAI,KAAK,CAAC,kCAAkC,KAAK,CAAA,CAAE,CAAC;QAC5D;AAEA,QAAA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC;AAClC,QAAA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC;AAEpC,QAAA,OAAO,OAAO;IAChB;;IAGU,0BAA0B,GAAA;QAClC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO;YAAE;AAE/B,QAAA,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;AACrB,QAAA,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE;;AAGvB,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC;AAEtF,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,CAAC,EAAE,EAAE;AACpC,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;YACtD,IAAI,IAAI,EAAE;AACR,gBAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC;gBACpE,IAAI,QAAQ,EAAE;oBACZ,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;gBACxC;YACF;QACF;;AAGA,QAAA,MAAM,aAAa,GAAG,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC;AAE1F,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,EAAE,CAAC,EAAE,EAAE;AACtC,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;YACrD,IAAI,IAAI,EAAE;AACR,gBAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC;AACnE,gBAAA,IAAI,QAAQ,IAAI,CAAC,EAAE;oBACjB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;gBAC1C;YACF;QACF;IACF;;IAGA,MAAM,CAAC,KAAa,EAAE,MAAc,EAAA;QAClC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE;AAE9B,QAAA,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK;AACzB,QAAA,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,MAAM;AAC3B,QAAA,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC;IACvC;;IAcU,oBAAoB,CAC5B,eAAwB,EACxB,YAAqB,EAAA;QAErB,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE;QAE9B,MAAM,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC;QACtD,MAAM,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC;QAEtD,IAAI,aAAa,EAAE;AACjB,YAAA,MAAM,IAAI,GAAG,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,GAAG,IAAI;AAC1E,YAAA,IAAI,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;AAC7C,gBAAA,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC;YAC3D;iBAAO;;AAEL,gBAAA,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;gBACnE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,WAAW,EAAE,WAAW,CAAC;YAC5D;QACF;QAEA,IAAI,aAAa,EAAE;YACjB,IAAI,IAAI,GAAG,IAAI;YACf,IAAI,YAAY,EAAE;gBAChB,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,YAAY,CAAC;YAC1C;iBAAO,IAAI,eAAe,EAAE;;gBAE1B,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC;YAC7C;AAEA,YAAA,IAAI,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;AAC7C,gBAAA,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC;YAC3D;iBAAO;;AAEL,gBAAA,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;gBACnE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,WAAW,EAAE,WAAW,CAAC;YAC5D;QACF;IACF;;IAGU,aAAa,GAAA;QACrB,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;;QAGd,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,KAAI;AAChC,YAAA,IAAI,CAAC,EAAG,CAAC,aAAa,CAAC,OAAO,CAAC;AACjC,QAAA,CAAC,CAAC;AACF,QAAA,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;AACrB,QAAA,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE;;AAGvB,QAAA,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC;AACnC,YAAA,IAAI,CAAC,OAAO,GAAG,IAAI;QACrB;;AAGA,QAAA,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,IAAI,CAAC,iBAAiB,CAAC;YAC3E,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,sBAAsB,EAAE,IAAI,CAAC,qBAAqB,CAAC;QACrF;AAEA,QAAA,IAAI,CAAC,EAAE,GAAG,IAAI;AACd,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI;QAClB,IAAI,CAAC,kBAAkB,EAAE;IAC3B;IAEA,aAAa,GAAA;QACX,OAAO,IAAI,CAAC,EAAE,KAAK,IAAI,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI;IAClD;IAEA,UAAU,GAAA;QACR,OAAO,IAAI,CAAC,EAAE;IAChB;AACD;;ACrQK,MAAO,aAAc,SAAQ,iBAAwC,CAAA;AAIzE,IAAA,WAAA,CAAY,UAAgC,EAAE,EAAA;AAC5C,QAAA,KAAK,EAAE;QAJD,IAAA,CAAA,YAAY,GAAuB,IAAI;QAK7C,IAAI,CAAC,OAAO,GAAG;AACb,YAAA,SAAS,EAAE,IAAI;AACf,YAAA,KAAK,EAAE,IAAI;AACX,YAAA,kBAAkB,EAAE,IAAI;AACxB,YAAA,qBAAqB,EAAE,KAAK;AAC5B,YAAA,GAAG,OAAO;SACX;IACH;AAEA,IAAA,UAAU,CAAC,MAAyB,EAAA;AAClC,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM;AAEpB,QAAA,IAAI;AACF,YAAA,IAAI,CAAC,EAAE;gBACJ,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAkC;oBACzE,MAAM,CAAC,UAAU,CAAC,oBAAoB,EAAE,IAAI,CAAC,OAAO,CAAkC;AAEzF,YAAA,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE;AACZ,gBAAA,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC;YACxC;YAEA,IAAI,CAAC,mBAAmB,EAAE;YAC1B,IAAI,CAAC,sBAAsB,EAAE;YAC7B,IAAI,CAAC,gBAAgB,EAAE;AAEvB,YAAA,OAAO,IAAI;QACb;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAc,CAAC;AAClC,YAAA,OAAO,KAAK;QACd;IACF;IAEQ,mBAAmB,GAAA;QACzB,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE;QAElB,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,IAAI,CAAC,iBAAiB,CAAC;QACxE,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,sBAAsB,EAAE,IAAI,CAAC,qBAAqB,CAAC;IAClF;IAEQ,sBAAsB,GAAA;QAC5B,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;;AAGd,QAAA,MAAM,QAAQ,GAAG,IAAI,YAAY,CAAC;AAChC,YAAA,EAAI;AACJ,YAAA,EAAI;YACJ,GAAG;AACH,YAAA,GAAG;YACH,GAAG;AACH,YAAA,EAAI;YACJ,GAAG;AACH,YAAA,GAAG;AACH,YAAA,EAAI;YACJ,GAAG;YACH,GAAG;AACH,YAAA,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;AACH,YAAA,GAAG;AACJ,SAAA,CAAC;QAEF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;AAC1C,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC;AAC3D,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,QAAQ,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC;IACzE;IAEQ,gBAAgB,GAAA;AACtB,QAAA,MAAM,YAAY,GAAG;;;;;;;;;;;;KAYpB;AAED,QAAA,MAAM,cAAc,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAmCtB;QAED,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,cAAc,EAAE,CAAC;IAClD;AAEA,IAAA,SAAS,CAAC,MAAwD,EAAA;QAChE,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;AAEd,QAAA,IAAI;AACF,YAAA,MAAM,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,YAAY,EAAE,MAAM,CAAC,cAAc,CAAC;YAC/E,IAAI,OAAO,EAAE;AACX,gBAAA,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC;gBACrC;AACA,gBAAA,IAAI,CAAC,OAAO,GAAG,OAAO;gBACtB,KAAK,CAAC,0BAA0B,EAAE;YACpC;QACF;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAc,CAAC;QACpC;IACF;IAMA,MAAM,CACJ,cAAmC,EACnC,WAAgC,EAChC,QAAgB,EAChB,kBAAqE,EACrE,eAAwB,EACxB,YAAqB,EAAA;QAErB,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,cAAc;YAAE;QAElD,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC;;AAGhC,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC;;AAGvC,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC;;QAG3D,MAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC;QACpD,MAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC;AAEpD,QAAA,IAAI,WAAW,KAAK,SAAS,EAAE;AAC7B,YAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,WAAW,CAAC;YAC5C,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QAC7E;AAEA,QAAA,IAAI,WAAW,KAAK,SAAS,EAAE;AAC7B,YAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,WAAW,CAAC;YAC5C,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QACjF;;QAGA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC;AACvC,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,cAAc,CAAC;;QAGvD,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC;QACvC,IAAI,WAAW,EAAE;AACf,YAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC;QACtD;aAAO;;AAEL,YAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,cAAc,CAAC;QACzD;;QAGA,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC;QAClD,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC;QAClD,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC;AAElD,QAAA,IAAI,WAAW;YAAE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;AAClD,QAAA,IAAI,WAAW;YAAE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;AAClD,QAAA,IAAI,WAAW;YAAE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,QAAQ,CAAC;;QAGzD,MAAM,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC;AACtD,QAAA,IAAI,aAAa,IAAI,IAAI,CAAC,MAAM,EAAE;AAChC,YAAA,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QACzE;;AAGA,QAAA,KAAK,CAAC,oBAAoB,CAAC,eAAe,EAAE,YAAY,CAAC;;QAGzD,IAAI,kBAAkB,EAAE;AACtB,YAAA,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,KAAI;AAC3D,gBAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAG,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAQ,EAAE,IAAI,CAAC;gBACjE,IAAI,QAAQ,EAAE;oBACZ,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,KAAK,YAAY,YAAY,EAAE;AACzD,wBAAA,MAAM,GAAG,GAAG,KAAK,CAAC,MAAM;wBACxB,QAAQ,GAAG;AACT,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAgC,CAAC;gCAC/D;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAgC,CAAC;gCAC/D;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAgC,CAAC;gCAC/D;AACF,4BAAA;AACE,gCAAA,IAAI,GAAG,KAAK,CAAC,EAAE;AACb,oCAAA,IAAI,CAAC,EAAG,CAAC,SAAS,CAAC,QAAQ,EAAG,KAAkB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;gCAC3D;gCACA;;oBAEN;AAAO,yBAAA,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;wBACpC,IAAI,CAAC,EAAG,CAAC,SAAS,CAAC,QAAQ,EAAE,KAAK,CAAC;oBACrC;gBACF;AACF,YAAA,CAAC,CAAC;QACJ;;AAGA,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC,EAAE,CAAC,CAAC;IAClD;IAGA,OAAO,GAAA;QACL,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;;AAGd,QAAA,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC;AACvC,YAAA,IAAI,CAAC,YAAY,GAAG,IAAI;QAC1B;;QAGA,KAAK,CAAC,aAAa,EAAE;IACvB;AAED;;ACvPK,MAAO,cAAe,SAAQ,iBAAyC,CAAA;AAU3E,IAAA,WAAA,CAAY,UAAiC,EAAE,EAAA;AAC7C,QAAA,KAAK,EAAE;QAVD,IAAA,CAAA,WAAW,GAAkC,IAAI;QACjD,IAAA,CAAA,YAAY,GAAuB,IAAI;QACvC,IAAA,CAAA,WAAW,GAAuB,IAAI;AACtC,QAAA,IAAA,CAAA,mBAAmB,GAAwB,IAAI,GAAG,EAAE;QAEpD,IAAA,CAAA,QAAQ,GAAoB,IAAI;QAChC,IAAA,CAAA,iBAAiB,GAAkC,IAAI;AACvD,QAAA,IAAA,CAAA,eAAe,GAA8B,IAAI,GAAG,EAAE;QAI5D,IAAI,CAAC,OAAO,GAAG;AACb,YAAA,SAAS,EAAE,IAAI;AACf,YAAA,KAAK,EAAE,IAAI;AACX,YAAA,kBAAkB,EAAE,IAAI;AACxB,YAAA,qBAAqB,EAAE,KAAK;AAC5B,YAAA,eAAe,EAAE,kBAAkB;AACnC,YAAA,GAAG,OAAO;SACX;IACH;AAEA,IAAA,UAAU,CAAC,MAAyB,EAAA;AAClC,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM;AAEpB,QAAA,IAAI;AACF,YAAA,IAAI,CAAC,EAAE,GAAG,MAAM,CAAC,UAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAkC;AAEpF,YAAA,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE;AACZ,gBAAA,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC;YAC5C;;YAGA,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC;YAClC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC;YACjC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC;YAE9B,IAAI,CAAC,mBAAmB,EAAE;YAC1B,IAAI,CAAC,qBAAqB,EAAE;YAC5B,IAAI,CAAC,gBAAgB,EAAE;AAEvB,YAAA,OAAO,IAAI;QACb;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAc,CAAC;AAClC,YAAA,OAAO,KAAK;QACd;IACF;IAEQ,mBAAmB,GAAA;QACzB,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE;QAElB,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,IAAI,CAAC,iBAAiB,CAAC;QACxE,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,sBAAsB,EAAE,IAAI,CAAC,qBAAqB,CAAC;IAClF;IAEQ,qBAAqB,GAAA;QAC3B,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;;QAGd,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,EAAE;QAC9C,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,CAAC;;AAGzC,QAAA,MAAM,QAAQ,GAAG,IAAI,YAAY,CAAC;AAChC,YAAA,EAAI;AACJ,YAAA,EAAI;AACJ,YAAA,GAAG;YACH,GAAG;AACH,YAAA,GAAG;YACH,GAAG;AACH,YAAA,EAAI;AACJ,YAAA,GAAG;YACH,GAAG;AACH,YAAA,GAAG;AACH,YAAA,EAAI;YACJ,GAAG;AACH,YAAA,GAAG;YACH,GAAG;AACH,YAAA,GAAG;YACH,GAAG;YACH,GAAG;AACH,YAAA,GAAG;YACH,GAAG;AACH,YAAA,GAAG;AACJ,SAAA,CAAC;AAEF,QAAA,MAAM,OAAO,GAAG,IAAI,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAEnD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;AAC1C,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC;AAC3D,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,QAAQ,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC;QAEvE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;AACzC,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,WAAW,CAAC;AAClE,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC;QAE9E,IAAI,CAAC,QAAQ,GAAG;YACd,QAAQ;YACR,OAAO;YACP,SAAS,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;SACtD;;;;AAMD,QAAA,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC;IAC/B;AAEA,IAAA,OAAO,CAAC,QAAkB,EAAA;QACxB,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;AAEd,QAAA,IAAI,CAAC,QAAQ,GAAG,QAAQ;;AAGxB,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC;QAC7C;QACA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,EAAE;QAC9C,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,CAAC;;AAGzC,QAAA,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC;QACzC;QACA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;AAC1C,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC;QAC3D,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC;;AAGjF,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC;QACxC;QACA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;AACzC,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,WAAW,CAAC;QAClE,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC;;AAGvF,QAAA,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,mBAAmB,EAAE;QAC5B;AAEA,QAAA,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC;IAC/B;IAEQ,mBAAmB,GAAA;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ;YAAE;AAEjD,QAAA,MAAM,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC;;AAGrB,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;AAExE,QAAA,IAAI,WAAW,IAAI,CAAC,EAAE;AACpB,YAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,WAAW,CAAC;YAC5C,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC;QAC9E;aAAO;AACL,YAAA,OAAO,CAAC,KAAK,CAAC,qEAAqE,CAAC;QACtF;;AAGA,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC;AAExE,QAAA,IAAI,WAAW,IAAI,CAAC,EAAE;AACpB,YAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,WAAW,CAAC;YAC5C,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC;QAClF;aAAO;AACL,YAAA,OAAO,CAAC,KAAK,CAAC,qEAAqE,CAAC;QACtF;;AAGA,QAAA,IAAI,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE;YAC9B,MAAM,cAAc,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE;AAC7C,YAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,cAAc,CAAC;YACxD,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC;;AAG1F,YAAA,MAAM,MAAM,GAAG,EAAE,GAAG,CAAC,CAAC;;AAGtB,YAAA,MAAM,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,mBAAmB,CAAC;AAChF,YAAA,IAAI,WAAW,IAAI,CAAC,EAAE;AACpB,gBAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,WAAW,CAAC;gBAC5C,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC;gBAC5E,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,CAAC;YAC7C;;AAGA,YAAA,MAAM,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,mBAAmB,CAAC;AAChF,YAAA,IAAI,WAAW,IAAI,CAAC,EAAE;AACpB,gBAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,WAAW,CAAC;gBAC5C,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC;gBAChF,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC,CAAC;YAC7C;;AAGA,YAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,gBAAgB,CAAC;AAC1E,YAAA,IAAI,QAAQ,IAAI,CAAC,EAAE;AACjB,gBAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,QAAQ,CAAC;gBACzC,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC;gBAC7E,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC1C;;AAGA,YAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,gBAAgB,CAAC;AAC1E,YAAA,IAAI,QAAQ,IAAI,CAAC,EAAE;AACjB,gBAAA,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,QAAQ,CAAC;gBACzC,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC;gBAC7E,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC1C;QACF;IACF;IAEQ,gBAAgB,GAAA;AACtB,QAAA,MAAM,YAAY,GAAG,CAAA;;;;;;;;;;;;;;;;KAgBpB;AAED,QAAA,MAAM,cAAc,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAoCtB;QAED,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,cAAc,EAAE,CAAC;IAClD;AAEA,IAAA,SAAS,CAAC,MAIT,EAAA;QACC,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;AAEd,QAAA,IAAI;;AAEF,YAAA,IAAI,YAAY,GAAG,MAAM,CAAC,YAAY;AACtC,YAAA,IAAI,cAAc,GAAG,MAAM,CAAC,cAAc;;YAG1C,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;AACtC,gBAAA,YAAY,GAAG,IAAI,CAAC,2BAA2B,CAAC,YAAY,CAAC;YAC/D;YACA,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;AACxC,gBAAA,cAAc,GAAG,IAAI,CAAC,6BAA6B,CAAC,cAAc,CAAC;YACrE;AAGA,YAAA,MAAM,OAAO,GAAG,MAAM,CAAC;AACrB,kBAAE,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,cAAc,EAAE,MAAM,CAAC,yBAAyB;kBACjF,KAAK,CAAC,aAAa,CAAC,YAAY,EAAE,cAAc,CAAC;YACrD,IAAI,OAAO,EAAE;AACX,gBAAA,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC;gBACrC;AACA,gBAAA,IAAI,CAAC,OAAO,GAAG,OAAO;gBACtB,KAAK,CAAC,0BAA0B,EAAE;;gBAGlC,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,QAAQ,EAAE;oBACrC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,CAAC;AACzC,oBAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC;AAC3D,oBAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,WAAW,CAAC;oBAClE,IAAI,CAAC,mBAAmB,EAAE;AAC1B,oBAAA,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC;gBAC/B;YACF;QACF;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAc,CAAC;QACpC;IACF;;AAGU,IAAA,aAAa,CACrB,YAAoB,EACpB,cAAsB,EACtB,yBAAoC,EAAA;QAEpC,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;AAEzB,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;AAC5E,QAAA,MAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC;AAElF,QAAA,IAAI,CAAC,YAAY,IAAI,CAAC,cAAc;AAAE,YAAA,OAAO,IAAI;QAEjD,MAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;QACvC,IAAI,CAAC,OAAO,EAAE;AACZ,YAAA,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC;QACpD;QAEA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,YAAY,CAAC;QAC3C,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,cAAc,CAAC;;QAG7C,IAAI,yBAAyB,IAAI,yBAAyB,CAAC,MAAM,GAAG,CAAC,EAAE;AACrE,YAAA,IAAI,CAAC,EAAE,CAAC,yBAAyB,CAC/B,OAAO,EACP,yBAAyB,EACzB,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAC5B;QACH;AAEA,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC;AAE5B,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,EAAE;YAC9D,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,OAAO,CAAC;AAChD,YAAA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC;AAC9B,YAAA,MAAM,IAAI,KAAK,CAAC,kCAAkC,KAAK,CAAA,CAAE,CAAC;QAC5D;AAEA,QAAA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC;AAClC,QAAA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC;AAEpC,QAAA,OAAO,OAAO;IAChB;IAEQ,aAAa,CAAC,MAAc,EAAE,IAAY,EAAA;QAChD,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;QAEzB,MAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC;QACzC,IAAI,CAAC,MAAM,EAAE;AACX,YAAA,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC;QAC5C;QAEA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC;AACpC,QAAA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC;AAE7B,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,CAAC,EAAE;YAC/D,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,MAAM,CAAC;AAC9C,YAAA,OAAO,CAAC,KAAK,CAAC,4CAA4C,EAAE,KAAK,CAAC;AAClE,YAAA,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,CAAC;AAC5B,YAAA,MAAM,IAAI,KAAK,CAAC,6BAA6B,KAAK,CAAA,CAAE,CAAC;QACvD;AAEA,QAAA,OAAO,MAAM;IACf;IAEQ,0BAA0B,GAAA;QAChC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO;YAAE;AAE/B,QAAA,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;AACrB,QAAA,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE;AACvB,QAAA,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE;;AAGhC,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC;AAEtF,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,CAAC,EAAE,EAAE;AACpC,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;YACtD,IAAI,IAAI,EAAE;AACR,gBAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC;gBACpE,IAAI,QAAQ,EAAE;oBACZ,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;gBACxC;YACF;QACF;;AAGA,QAAA,MAAM,aAAa,GAAG,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC;AAE1F,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,EAAE,CAAC,EAAE,EAAE;AACtC,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;YACrD,IAAI,IAAI,EAAE;AACR,gBAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC;AACnE,gBAAA,IAAI,QAAQ,IAAI,CAAC,EAAE;oBACjB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;gBAC1C;YACF;QACF;;AAGA,QAAA,MAAM,gBAAgB,GAAG,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAClD,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAC9B;AACD,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,EAAE,CAAC,EAAE,EAAE;AACzC,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,yBAAyB,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;YAC/D,IAAI,IAAI,EAAE;AACR,gBAAA,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC;gBAC9D,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC;YAC3C;QACF;IACF;;AAGU,IAAA,aAAa,CAAC,KAAuB,EAAA;QAC7C,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;QAEzB,MAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;AACvC,QAAA,IAAI,CAAC,OAAO;AAAE,YAAA,OAAO,IAAI;AAEzB,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC;AAEhD,QAAA,IAAI;AACF,YAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAChB,IAAI,CAAC,EAAE,CAAC,UAAU,EAClB,CAAC,EACD,IAAI,CAAC,EAAE,CAAC,IAAI,EACZ,IAAI,CAAC,EAAE,CAAC,IAAI,EACZ,IAAI,CAAC,EAAE,CAAC,aAAa,EACrB,KAAK,CACN;QACH;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,OAAO,CAAC,KAAK,CAAC,0DAA0D,EAAE,KAAK,CAAC;AAChF,YAAA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC;AAC9B,YAAA,OAAO,IAAI;QACb;;QAGA,IAAI,CAAC,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC;;QAG1C,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QACxF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QACxF,IAAI,CAAC,EAAE,CAAC,aAAa,CACnB,IAAI,CAAC,EAAE,CAAC,UAAU,EAClB,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAC1B,IAAI,CAAC,EAAE,CAAC,oBAAoB,CAC7B;QACD,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC;;QAGrF,MAAM,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,gCAAgC,CAAC;QAClE,IAAI,GAAG,EAAE;AACP,YAAA,MAAM,aAAa,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,GAAG,CAAC,8BAA8B,CAAC;AAC9E,YAAA,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,GAAG,CAAC,0BAA0B,EAAE,aAAa,CAAC;QAC1F;AAEA,QAAA,OAAO,OAAO;IAChB;AAEA,IAAA,oBAAoB,CAAC,KAAa,EAAE,MAAc,EAAE,IAAmB,EAAA;QACrE,IAAI,CAAC,IAAI,CAAC,EAAE;AAAE,YAAA,OAAO,IAAI;QAEzB,MAAM,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;AACvC,QAAA,IAAI,CAAC,OAAO;AAAE,YAAA,OAAO,IAAI;AAEzB,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC;AAChD,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAChB,IAAI,CAAC,EAAE,CAAC,UAAU,EAClB,CAAC,EACD,IAAI,CAAC,EAAE,CAAC,OAAO,EACf,KAAK,EACL,MAAM,EACN,CAAC,EACD,IAAI,CAAC,EAAE,CAAC,IAAI,EACZ,IAAI,CAAC,EAAE,CAAC,KAAK,EACb,IAAI,IAAI,IAAI,CACb;QAED,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QACxF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;QACxF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC;QACtF,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC;AAEtF,QAAA,OAAO,OAAO;IAChB;IAEA,sBAAsB,CAAC,OAAsB,EAAE,SAAmB,EAAA;QAChE,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;AAEd,QAAA,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,IAAI,CAAC,iBAAiB,CAAC;QACzD;QAEA,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,EAAE,CAAC,uBAAuB,EAAE;AAC1D,QAAA,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,iBAAiB,CAAC;QAEjF,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,KAAK,KAAI;AAChC,YAAA,IAAI,CAAC,EAAG,CAAC,cAAc,CAAC,IAAI,CAAC,EAAG,CAAC,yBAAyB,EAAE,KAAK,EAAE,MAAM,CAAC;AAC5E,QAAA,CAAC,CAAC;AAEF,QAAA,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC;IACjE;AAEA,IAAA,MAAM,CACJ,cAAmC,EACnC,WAAgC,EAChC,QAAgB,EAChB,kBAAqE,EACrE,eAAwB,EACxB,YAAqB,EACrB,aAAsB,EAAA;AAEtB,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,cAAc,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;AACrE,YAAA,OAAO,CAAC,KAAK,CAAC,qDAAqD,EAAE;AACnE,gBAAA,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE;AACb,gBAAA,OAAO,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO;gBACvB,cAAc,EAAE,CAAC,CAAC,cAAc;AAChC,gBAAA,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW;AAChC,aAAA,CAAC;YACF;QACF;QAEA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC;QAChC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,CAAC;;AAGzC,QAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AAC9B,QAAA,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAC;;QAGlE,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC;AACvC,QAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,cAAc,CAAC;QAEvD,IAAI,WAAW,EAAE;YACf,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC;AACvC,YAAA,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC;QACtD;;QAGA,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC;QAClD,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC;QAClD,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC;AAElD,QAAA,IAAI,WAAW;YAAE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;AAClD,QAAA,IAAI,WAAW;YAAE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;AAClD,QAAA,IAAI,WAAW;YAAE,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,WAAW,EAAE,QAAQ,CAAC;;QAGzD,MAAM,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC;AACtD,QAAA,IAAI,aAAa,IAAI,IAAI,CAAC,MAAM,EAAE;AAChC,YAAA,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,aAAa,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QACzE;;AAGA,QAAA,KAAK,CAAC,oBAAoB,CAAC,eAAe,EAAE,YAAY,CAAC;;QAGzD,IAAI,kBAAkB,EAAE;AACtB,YAAA,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,KAAI;gBAC3D,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC;gBACxC,IAAI,QAAQ,EAAE;AACZ,oBAAA,IAAI,KAAK,YAAY,YAAY,EAAE;AACjC,wBAAA,QAAQ,KAAK,CAAC,MAAM;AAClB,4BAAA,KAAK,EAAE;gCACL,IAAI,CAAC,EAAG,CAAC,gBAAgB,CAAC,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC;gCACjD;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,gBAAgB,CAAC,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC;gCACjD;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;gCACpC;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;gCACpC;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;gCACpC;AACF,4BAAA;gCACE,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;;oBAE1C;AAAO,yBAAA,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;AAC/B,wBAAA,QAAQ,KAAK,CAAC,MAAM;AAClB,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;gCACpC;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;gCACpC;AACF,4BAAA,KAAK,CAAC;gCACJ,IAAI,CAAC,EAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,KAAK,CAAC;gCACpC;;oBAEN;yBAAO;wBACL,IAAI,CAAC,EAAG,CAAC,SAAS,CAAC,QAAQ,EAAE,KAAK,CAAC;oBACrC;gBACF;AACF,YAAA,CAAC,CAAC;QACJ;;AAIA,QAAA,IAAI;AACF,YAAA,IAAI,IAAI,CAAC,QAAQ,EAAE;AACjB,gBAAA,IAAI,aAAa,IAAI,aAAa,GAAG,CAAC,EAAE;AACtC,oBAAA,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAC3B,IAAI,CAAC,EAAE,CAAC,SAAS,EACjB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,EAC5B,IAAI,CAAC,EAAE,CAAC,cAAc,EACtB,CAAC,EACD,aAAa,CACd;gBACH;qBAAO;oBACL,IAAI,CAAC,EAAE,CAAC,YAAY,CAClB,IAAI,CAAC,EAAE,CAAC,SAAS,EACjB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,EAC5B,IAAI,CAAC,EAAE,CAAC,cAAc,EACtB,CAAC,CACF;gBACH;YACF;iBAAO;AACL,gBAAA,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC,EAAE,CAAC,CAAC;YAClD;;YAGA,MAAM,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;YAChC,IAAI,KAAK,KAAK,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;gBAC9B,IAAI,WAAW,GAAG,eAAe;gBACjC,QAAQ,KAAK;AACX,oBAAA,KAAK,IAAI,CAAC,EAAE,CAAC,YAAY;wBACvB,WAAW,GAAG,cAAc;wBAC5B;AACF,oBAAA,KAAK,IAAI,CAAC,EAAE,CAAC,aAAa;wBACxB,WAAW,GAAG,eAAe;wBAC7B;AACF,oBAAA,KAAK,IAAI,CAAC,EAAE,CAAC,iBAAiB;wBAC5B,WAAW,GAAG,mBAAmB;wBACjC;AACF,oBAAA,KAAK,IAAI,CAAC,EAAE,CAAC,6BAA6B;wBACxC,WAAW,GAAG,+BAA+B;wBAC7C;AACF,oBAAA,KAAK,IAAI,CAAC,EAAE,CAAC,aAAa;wBACxB,WAAW,GAAG,eAAe;wBAC7B;;gBAEJ,OAAO,CAAC,KAAK,CAAC,CAAA,kCAAA,EAAqC,KAAK,CAAA,EAAA,EAAK,WAAW,CAAA,CAAA,CAAG,CAAC;YAC9E;QACF;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,OAAO,CAAC,KAAK,CAAC,qCAAqC,EAAE,KAAK,CAAC;AAC3D,YAAA,MAAM,KAAK;QACb;AAEA,QAAA,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC;IAC/B;AAEA,IAAA,2BAA2B,CACzB,cAAmC,EACnC,WAAgC,EAChC,QAAgB,EAChB,kBAAqE,EAAA;AAErE,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,iBAAiB;YAAE;QAE1D,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC;AAC1C,QAAA,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,iBAAiB,CAAC;QACjF,IAAI,CAAC,EAAE,CAAC,sBAAsB,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC;QAE9C,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,WAAW,EAAE,QAAQ,EAAE,kBAAkB,CAAC;AAEtE,QAAA,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE;AAC9B,QAAA,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC;QAC/D,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC;IAC7C;IAEA,OAAO,GAAA;QACL,IAAI,CAAC,IAAI,CAAC,EAAE;YAAE;;QAGd,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC,OAAO,KAAI;AACvC,YAAA,IAAI,CAAC,EAAG,CAAC,aAAa,CAAC,OAAO,CAAC;AACjC,QAAA,CAAC,CAAC;AACF,QAAA,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE;;AAG5B,QAAA,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC;AACvC,YAAA,IAAI,CAAC,YAAY,GAAG,IAAI;QAC1B;AAEA,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC;AACtC,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI;QACzB;;AAGA,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC;AAC3C,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI;QACzB;;AAGA,QAAA,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,IAAI,CAAC,iBAAiB,CAAC;AACvD,YAAA,IAAI,CAAC,iBAAiB,GAAG,IAAI;QAC/B;;QAGA,KAAK,CAAC,aAAa,EAAE;IACvB;IAEA,aAAa,GAAA;QACX,OAAO,KAAK,CAAC,aAAa,EAAE,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI;IAC3D;IAEA,QAAQ,GAAA;AACN,QAAA,OAAO,IAAI;IACb;AAEQ,IAAA,2BAA2B,CAAC,MAAc,EAAA;QAChD,IAAI,SAAS,GAAG,MAAM;;QAGtB,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,8BAA8B,EAAE,EAAE,CAAC;;AAGjE,QAAA,SAAS,GAAG,2CAA2C,GAAG,SAAS;;QAGnE,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,iBAAiB,EAAE,KAAK,CAAC;;QAGvD,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,eAAe,EAAE,MAAM,CAAC;AAEtD,QAAA,OAAO,SAAS;IAClB;AAEQ,IAAA,6BAA6B,CAAC,MAAc,EAAA;QAClD,IAAI,SAAS,GAAG,MAAM;;QAGtB,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,8BAA8B,EAAE,EAAE,CAAC;;AAGjE,QAAA,SAAS,GAAG,gEAAgE,GAAG,SAAS;;QAGxF,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,eAAe,EAAE,KAAK,CAAC;;QAGrD,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,mBAAmB,EAAE,WAAW,CAAC;;QAG/D,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,mBAAmB,EAAE,UAAU,CAAC;AAE9D,QAAA,OAAO,SAAS;IAClB;AACD;;MCzxBY,gBAAgB,CAAA;AAO3B,IAAA,WAAA,CAAY,UAAmC,EAAE,EAAA;QANzC,IAAA,CAAA,MAAM,GAA6B,IAAI;QACvC,IAAA,CAAA,GAAG,GAAoC,IAAI;QAC3C,IAAA,CAAA,YAAY,GAA4B,IAAI;QAC5C,IAAA,CAAA,SAAS,GAA4B,IAAI;QAI/C,IAAI,CAAC,OAAO,GAAG;AACb,YAAA,kBAAkB,EAAE,IAAI;AACxB,YAAA,GAAG,OAAO;SACX;IACH;AAEA,IAAA,UAAU,CAAC,MAAyB,EAAA;AAClC,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM;QACpB,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;AAElC,QAAA,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;AACb,YAAA,OAAO,KAAK;QACd;;AAGA,QAAA,IAAI,CAAC,GAAG,CAAC,qBAAqB,GAAG,IAAI;AACrC,QAAA,IAAI,CAAC,GAAG,CAAC,qBAAqB,GAAG,MAAM;AAEvC,QAAA,OAAO,IAAI;IACb;IAEA,SAAS,CAAC,OAAgC,EAAE,IAA6B,EAAA;AACvE,QAAA,IAAI,CAAC,YAAY,GAAG,OAAO;AAC3B,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI;IACvB;AAEA,IAAA,MAAM,CAAC,QAAgB,EAAA;QACrB,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE;;QAG/B,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;;AAG/D,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM;QAE1D,IAAI,IAAI,CAAC,YAAY,IAAI,QAAQ,GAAG,CAAC,EAAE;AACrC,YAAA,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM;AACrE,YAAA,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,CAAC,mBAAmB,CACtD,IAAI,CAAC,MAAM,CAAC,KAAK,EACjB,IAAI,CAAC,MAAM,CAAC,MAAM,EAClB,UAAU,EACV,WAAW,CACZ;;AAGD,YAAA,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;YACf,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,CAAC,GAAG,QAAQ;AACnC,YAAA,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC;AAC1D,YAAA,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;QACpB;QAEA,IAAI,IAAI,CAAC,SAAS,IAAI,QAAQ,GAAG,CAAC,EAAE;AAClC,YAAA,MAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM;AAC/D,YAAA,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,CAAC,mBAAmB,CACtD,IAAI,CAAC,MAAM,CAAC,KAAK,EACjB,IAAI,CAAC,MAAM,CAAC,MAAM,EAClB,UAAU,EACV,WAAW,CACZ;;AAGD,YAAA,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;AACf,YAAA,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,QAAQ;AAC/B,YAAA,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC;AACvD,YAAA,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;QACpB;IACF;AAEQ,IAAA,mBAAmB,CACzB,WAAmB,EACnB,YAAoB,EACpB,UAAkB,EAClB,WAAmB,EAAA;AAEnB,QAAA,IAAI,KAAa;AACjB,QAAA,IAAI,MAAc;QAClB,IAAI,CAAC,GAAG,CAAC;QACT,IAAI,CAAC,GAAG,CAAC;AAET,QAAA,IAAI,UAAU,GAAG,WAAW,EAAE;;YAE5B,KAAK,GAAG,WAAW;AACnB,YAAA,MAAM,GAAG,WAAW,GAAG,UAAU;YACjC,CAAC,GAAG,CAAC,YAAY,GAAG,MAAM,IAAI,CAAC;QACjC;aAAO;;YAEL,MAAM,GAAG,YAAY;AACrB,YAAA,KAAK,GAAG,YAAY,GAAG,UAAU;YACjC,CAAC,GAAG,CAAC,WAAW,GAAG,KAAK,IAAI,CAAC;QAC/B;QAEA,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE;IAChC;IAEA,MAAM,CAAC,KAAa,EAAE,MAAc,EAAA;QAClC,IAAI,CAAC,IAAI,CAAC,MAAM;YAAE;AAElB,QAAA,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK;AACzB,QAAA,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,MAAM;;AAG3B,QAAA,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IAChB;IAEA,OAAO,GAAA;AACL,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI;AAClB,QAAA,IAAI,CAAC,GAAG,GAAG,IAAI;AACf,QAAA,IAAI,CAAC,YAAY,GAAG,IAAI;AACxB,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI;IACvB;IAEA,aAAa,GAAA;AACX,QAAA,OAAO,IAAI,CAAC,GAAG,KAAK,IAAI;IAC1B;IAEA,UAAU,GAAA;QACR,OAAO,IAAI,CAAC,GAAG;IACjB;AACD;;MC3GY,aAAa,CAAA;AAA1B,IAAA,WAAA,GAAA;AACU,QAAA,IAAA,CAAA,OAAO,GAAyB,IAAI,GAAG,EAAE;QACzC,IAAA,CAAA,iBAAiB,GAAG,MAAM;IAoDpC;AAlDE,IAAA,QAAQ,CAAC,MAAe,EAAA;AACtB,QAAA,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;AAChB,YAAA,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC;QAC5C;QAEA,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;YACjC,OAAO,CAAC,IAAI,CAAC,CAAA,QAAA,EAAW,MAAM,CAAC,IAAI,CAAA,uCAAA,CAAyC,CAAC;QAC/E;QAEA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC;IACvC;AAEA,IAAA,UAAU,CAAC,IAAY,EAAA;QACrB,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC;IAClC;AAEA,IAAA,GAAG,CAAC,IAAY,EAAA;QACd,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI;IACvC;AAEA,IAAA,GAAG,CAAC,IAAY,EAAA;QACd,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;IAC/B;IAEA,IAAI,GAAA;QACF,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;IACxC;IAEA,KAAK,GAAA;AACH,QAAA,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;IACtB;IAEA,IAAI,GAAA;AACF,QAAA,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI;IAC1B;AAEA,IAAA,UAAU,CAAC,IAAY,EAAA;QACrB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;AAC3B,YAAA,MAAM,IAAI,KAAK,CAAC,WAAW,IAAI,CAAA,mBAAA,CAAqB,CAAC;QACvD;AACA,QAAA,IAAI,CAAC,iBAAiB,GAAG,IAAI;IAC/B;IAEA,UAAU,GAAA;QACR,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC;IACzC;IAEA,cAAc,GAAA;QACZ,OAAO,IAAI,CAAC,iBAAiB;IAC/B;AACD;AAED;AACM,SAAU,mBAAmB,CAAC,OAAmB,EAAA;AACrD,IAAA,MAAM,OAAO,GAAG,IAAI,aAAa,EAAE;IAEnC,IAAI,OAAO,EAAE;AACX,QAAA,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACvD;AAEA,IAAA,OAAO,OAAO;AAChB;;MCrFsB,UAAU,CAAA;AAAhC,IAAA,WAAA,GAAA;;AAIW,QAAA,IAAA,CAAA,YAAY,GAAW;;;;;;;;;;GAU/B;IAqCH;;AA1BE,IAAA,IAAI,cAAc,GAAA;AAChB,QAAA,OAAO,KAAK;IACd;;AAGA,IAAA,IAAI,kBAAkB,GAAA;AACpB,QAAA,OAAO,KAAK;IACd;IAEA,OAAO,GAAA;AACL,QAAA,MAAM,IAAI,KAAK,CAAC,sEAAsE,CAAC;IACzF;;IAGA,eAAe,GAAA;QACb,OAAO;AACL,YAAA,SAAS,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC9B,YAAA,OAAO,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC5B,YAAA,MAAM,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;SAC5B;IACH;;IAGA,4BAA4B,GAAA;AAC1B,QAAA,OAAO,EAAE;IACX;AACD;;ACtDD;AAEO,MAAM,qBAAqB,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiC9B,MAAM,oBAAoB,GAAG,CAAC,UAAkB,EAAE,aAAa,GAAG,IAAI,KAAY;IACvF,MAAM,MAAM,GAAG,aAAa,GAAG,qBAAqB,GAAG,EAAE;IAEzD,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAqCH,MAAM;;MAEN,UAAU;GACb;AACH;;AC5EM,MAAO,UAAW,SAAQ,UAAU,CAAA;AAA1C,IAAA,WAAA,GAAA;;QACW,IAAA,CAAA,IAAI,GAAG,MAAM;QAEb,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;AAW9C,EAAA,CAAA,CAAC;IAOJ;AALE,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;SACpB;IACH;AACD;;ACnBK,MAAO,WAAY,SAAQ,UAAU,CAAA;AAIzC,IAAA,WAAA,CAAY,YAA4B,MAAM,EAAA;AAC5C,QAAA,KAAK,EAAE;QAKA,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgC9C,EAAA,CAAA,CAAC;AApCA,QAAA,IAAI,CAAC,SAAS,GAAG,SAAS;QAC1B,IAAI,CAAC,IAAI,GAAG,CAAA,KAAA,EAAQ,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA,CAAE;IAC9E;AAoCA,IAAA,WAAW,CAAC,QAAgB,EAAA;AAC1B,QAAA,IAAI,SAAS,GAAa,CAAC,CAAC,EAAE,CAAC,CAAC;AAEhC,QAAA,QAAQ,IAAI,CAAC,SAAS;AACpB,YAAA,KAAK,MAAM;AACT,gBAAA,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC;gBACnB;AACF,YAAA,KAAK,OAAO;AACV,gBAAA,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;gBAClB;AACF,YAAA,KAAK,IAAI;AACP,gBAAA,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;gBAClB;AACF,YAAA,KAAK,MAAM;AACT,gBAAA,SAAS,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;gBACnB;;QAGJ,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;AACnB,YAAA,UAAU,EAAE,SAAS;SACtB;IACH;AACD;;ACnEK,MAAO,UAAW,SAAQ,UAAU,CAAA;AAIxC,IAAA,WAAA,CAAY,OAAiB,YAAY,EAAA;AACvC,QAAA,KAAK,EAAE;;AAMA,QAAA,IAAA,CAAA,YAAY,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA4BvB;QAEQ,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkC9C,EAAA,CAAA,CAAC;AArEA,QAAA,IAAI,CAAC,IAAI,GAAG,IAAI;QAChB,IAAI,CAAC,IAAI,GAAG,CAAA,IAAA,EAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA,CAAE;IACnE;AAqEA,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;AACnB,YAAA,KAAK,EAAE,IAAI,CAAC,IAAI,KAAK,UAAU,GAAG,CAAC,GAAG,CAAC;SACxC;IACH;AACD;;AC/EK,MAAO,UAAW,SAAQ,UAAU,CAAA;AAMxC,IAAA,WAAA,CAAY,UAAuB,EAAE,EAAA;AACnC,QAAA,KAAK,EAAE;QANT,IAAA,CAAA,IAAI,GAAG,MAAM;QAYJ,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8B9C,EAAA,CAAA,CAAC;AAEM,QAAA,IAAA,CAAA,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE;QArC5B,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,GAAG;QACzC,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,IAAI;QAC1C,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,GAAG;IACnC;AAoCA,IAAA,WAAW,CAAC,QAAgB,EAAA;AAC1B,QAAA,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC;QAElD,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,UAAU,EAAE,IAAI,CAAC,SAAS;YAC1B,UAAU,EAAE,IAAI,CAAC,SAAS;YAC1B,MAAM,EAAE,IAAI,CAAC,KAAK;AAClB,YAAA,KAAK,EAAE,IAAI;SACZ;IACH;AAEA,IAAA,cAAc,CAAC,GAA0B,EAAA;;AAEvC,QAAA,IAAI,IAAI,CAAC,YAAY,KAAK,CAAC,IAAI,IAAI,CAAC,YAAY,KAAK,SAAS,EAAE;AAC9D,YAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE;QAC7B;QACA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC;IAC5C;AAGD;;ACpEK,MAAO,gBAAiB,SAAQ,UAAU,CAAA;AAM9C,IAAA,WAAA,CAAY,UAA6B,EAAE,EAAA;AACzC,QAAA,KAAK,EAAE;QANT,IAAA,CAAA,IAAI,GAAG,YAAY;QAYV,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+D9C,EAAA,CAAA,CAAC;QApEA,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,GAAG;QACzC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,GAAG;QACnC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,GAAG;IACrC;AAmEA,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,UAAU,EAAE,IAAI,CAAC,SAAS;YAC1B,OAAO,EAAE,IAAI,CAAC,MAAM;YACpB,OAAO,EAAE,IAAI,CAAC,MAAM;SACrB;IACH;AACD;;ACtFK,MAAO,cAAe,SAAQ,UAAU,CAAA;AAM5C,IAAA,WAAA,CAAY,UAA2B,EAAE,EAAA;AACvC,QAAA,KAAK,EAAE;QANT,IAAA,CAAA,IAAI,GAAG,UAAU;QAYR,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmD9C,EAAA,CAAA,CAAC;QAxDA,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,IAAI;QAClC,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,GAAG;QACzC,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,GAAG;IAC3C;AAuDA,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,MAAM,EAAE,IAAI,CAAC,KAAK;YAClB,UAAU,EAAE,IAAI,CAAC,SAAS;YAC1B,UAAU,EAAE,IAAI,CAAC,SAAS;SAC3B;IACH;AACD;;ACzEK,MAAO,YAAa,SAAQ,UAAU,CAAA;AAO1C,IAAA,WAAA,CAAY,UAAyB,EAAE,EAAA;AACrC,QAAA,KAAK,EAAE;QAPT,IAAA,CAAA,IAAI,GAAG,QAAQ;QAcN,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiC9C,EAAA,CAAA,CAAC;QAvCA,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,GAAG;QACrC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,GAAG;QACrC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,GAAG;QACrC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,GAAG;IACnC;AAqCA,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,OAAO,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC;YACrC,QAAQ,EAAE,IAAI,CAAC,OAAO;YACtB,MAAM,EAAE,IAAI,CAAC,KAAK;SACnB;IACH;AACD;;AC5DK,MAAO,mBAAoB,SAAQ,UAAU,CAAA;AAKjD,IAAA,WAAA,CAAY,UAAgC,EAAE,EAAA;AAC5C,QAAA,KAAK,EAAE;QALT,IAAA,CAAA,IAAI,GAAG,eAAe;QAUb,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqC9C,EAAA,CAAA,CAAC;QAzCA,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,IAAI;QAC1C,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,GAAG;IACvC;AAyCA,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,UAAU,EAAE,IAAI,CAAC,SAAS;YAC1B,QAAQ,EAAE,IAAI,CAAC,OAAO;SACvB;IACH;AACD;;ACvDK,MAAO,WAAY,SAAQ,UAAU,CAAA;AAOzC,IAAA,WAAA,CAAY,UAAwB,EAAE,EAAA;AACpC,QAAA,KAAK,EAAE;QAPT,IAAA,CAAA,IAAI,GAAG,OAAO;;AAeL,QAAA,IAAA,CAAA,YAAY,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA4CvB;QAEQ,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiD9C,EAAA,CAAA,CAAC;QAtGA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,IAAI,IAAI;QACxC,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,IAAI,GAAG;QACnD,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,IAAI,GAAG;QAC7C,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,IAAI,GAAG;IACnD;AAoGA,IAAA,WAAW,CAAC,QAAgB,EAAA;QAC1B,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,SAAS,EAAE,IAAI,CAAC,QAAQ;YACxB,eAAe,EAAE,IAAI,CAAC,cAAc;YACpC,YAAY,EAAE,IAAI,CAAC,WAAW;YAC9B,cAAc,EAAE,IAAI,CAAC,aAAa;SACnC;IACH;AACD;;AC1HK,MAAO,YAAa,SAAQ,UAAU,CAAA;AAQ1C,IAAA,WAAA,CAAY,UAAyB,EAAE,EAAA;AACrC,QAAA,KAAK,EAAE;QART,IAAA,CAAA,IAAI,GAAG,QAAQ;QAgBN,IAAA,CAAA,cAAc,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8F9C,EAAA,CAAA,CAAC;QArGA,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,GAAG;QACzC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,IAAI;QAC5C,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,IAAI;QAC5C,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,IAAI,GAAG;AAC7C,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE;IAC7B;AAkGA,IAAA,WAAW,CAAC,QAAgB,EAAA;AAC1B,QAAA,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI;QACjD,OAAO;AACL,YAAA,SAAS,EAAE,QAAQ;YACnB,UAAU,EAAE,IAAI,CAAC,SAAS;YAC1B,WAAW,EAAE,IAAI,CAAC,UAAU;YAC5B,WAAW,EAAE,IAAI,CAAC,UAAU;YAC5B,YAAY,EAAE,IAAI,CAAC,WAAW;AAC9B,YAAA,KAAK,EAAE,IAAI;SACZ;IACH;AACD;;ACvHD;;AAEG;AACG,MAAO,YAAa,SAAQ,UAAU,CAAA;AAW1C,IAAA,WAAA,CAAY,OAA4B,EAAA;AACtC,QAAA,KAAK,EAAE;AACP,QAAA,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI;AACxB,QAAA,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC,YAAY;AACxC,QAAA,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc;AAC5C,QAAA,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,QAAQ;QACtC,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC,cAAc,IAAI,KAAK;QACtD,IAAI,CAAC,mBAAmB,GAAG,OAAO,CAAC,kBAAkB,IAAI,KAAK;AAC9D,QAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO;AAC/B,QAAA,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC,eAAe;AAC/C,QAAA,IAAI,CAAC,6BAA6B,GAAG,OAAO,CAAC,4BAA4B;IAC3E;AAEA,IAAA,WAAW,CAAC,QAAgB,EAAA;AAC1B,QAAA,MAAM,YAAY,GAAG;AACnB,YAAA,SAAS,EAAE,QAAQ;SACpB;AAED,QAAA,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,OAAO,EAAE,GAAG,YAAY,EAAE,GAAG,IAAI,CAAC,cAAc,EAAE,EAAE;QACtD;AAEA,QAAA,OAAO,YAAY;IACrB;AAEA,IAAA,IAAI,cAAc,GAAA;QAChB,OAAO,IAAI,CAAC,eAAe;IAC7B;AAEA,IAAA,IAAI,kBAAkB,GAAA;QACpB,OAAO,IAAI,CAAC,mBAAmB;IACjC;IAEA,OAAO,GAAA;AACL,QAAA,IAAI,IAAI,CAAC,QAAQ,EAAE;AACjB,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE;YAC5B,OAAO;gBACL,SAAS,EAAE,IAAI,CAAC,SAAS;gBACzB,OAAO,EAAE,IAAI,CAAC,OAAO;AACrB,gBAAA,SAAS,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC9B,gBAAA,OAAO,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC5B,gBAAA,SAAS,EAAE,EAAE;aACd;QACH;AACA,QAAA,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC;IACrE;IAEA,eAAe,GAAA;AACb,QAAA,IAAI,IAAI,CAAC,gBAAgB,EAAE;AACzB,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,EAAE;YACpC,IAAI,IAAI,EAAE;;gBAER,OAAO;AACL,oBAAA,SAAS,EAAE,IAAI;AACf,oBAAA,OAAO,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC5B,oBAAA,MAAM,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;iBAC5B;YACH;QACF;;QAEA,OAAO;AACL,YAAA,SAAS,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC9B,YAAA,OAAO,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;AAC5B,YAAA,MAAM,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC;SAC5B;IACH;IAEA,4BAA4B,GAAA;AAC1B,QAAA,IAAI,IAAI,CAAC,6BAA6B,EAAE;AACtC,YAAA,OAAO,IAAI,CAAC,6BAA6B,EAAE;QAC7C;AACA,QAAA,OAAO,EAAE;IACX;AACD;AAED;;AAEG;AACI,eAAe,2BAA2B,CAC/C,IAAY,EACZ,eAAuB,EACvB,iBAAyB,EACzB,OAAsC,EAAA;IAEtC,MAAM,CAAC,YAAY,EAAE,cAAc,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;AACvD,QAAA,KAAK,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;AAC5C,QAAA,KAAK,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;AAC/C,KAAA,CAAC;IAEF,OAAO,IAAI,YAAY,CAAC;QACtB,IAAI;QACJ,YAAY;QACZ,cAAc;AACd,QAAA,GAAG,OAAO;AACX,KAAA,CAAC;AACJ;AAEA;;AAEG;AACG,SAAU,kBAAkB,CAChC,IAAY,EACZ,YAAgC,EAChC,cAAsB,EACtB,OAAsC,EAAA;;AAGtC,IAAA,MAAM,mBAAmB,GAAG;;;;;;;;;;GAU3B;IAED,OAAO,IAAI,YAAY,CAAC;QACtB,IAAI;QACJ,YAAY,EAAE,YAAY,IAAI,mBAAmB;QACjD,cAAc;AACd,QAAA,GAAG,OAAO;AACX,KAAA,CAAC;AACJ;;AC1JA;AAkCA;AACO,MAAM,UAAU,GAAG,IAAI,UAAU;MAC3B,eAAe,GAAG,IAAI,WAAW,CAAC,MAAM;MACxC,gBAAgB,GAAG,IAAI,WAAW,CAAC,OAAO;MAC1C,aAAa,GAAG,IAAI,WAAW,CAAC,IAAI;MACpC,eAAe,GAAG,IAAI,WAAW,CAAC,MAAM;MACxC,oBAAoB,GAAG,IAAI,UAAU,CAAC,YAAY;MAClD,kBAAkB,GAAG,IAAI,UAAU,CAAC,UAAU;AACpD,MAAM,UAAU,GAAG,IAAI,UAAU;MAC3B,gBAAgB,GAAG,IAAI,UAAU,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE;MACjF,iBAAiB,GAAG,IAAI,UAAU,CAAC,EAAE,SAAS,EAAE,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE;AACxF,MAAM,gBAAgB,GAAG,IAAI,gBAAgB;AAC7C,MAAM,sBAAsB,GAAG,IAAI,gBAAgB,CAAC;AACzD,IAAA,SAAS,EAAE,GAAG;AACd,IAAA,MAAM,EAAE,GAAG;AACX,IAAA,MAAM,EAAE,GAAG;AACZ,CAAA;AACM,MAAM,uBAAuB,GAAG,IAAI,gBAAgB,CAAC;AAC1D,IAAA,SAAS,EAAE,GAAG;AACd,IAAA,MAAM,EAAE,GAAG;AACX,IAAA,MAAM,EAAE,GAAG;AACZ,CAAA;AACM,MAAM,cAAc,GAAG,IAAI,cAAc;AACzC,MAAM,oBAAoB,GAAG,IAAI,cAAc,CAAC;AACrD,IAAA,KAAK,EAAE,GAAG;AACV,IAAA,SAAS,EAAE,GAAG;AACd,IAAA,SAAS,EAAE,GAAG;AACf,CAAA;AACM,MAAM,mBAAmB,GAAG,IAAI,mBAAmB;AACnD,MAAM,wBAAwB,GAAG,IAAI,mBAAmB,CAAC;AAC9D,IAAA,SAAS,EAAE,IAAI;AACf,IAAA,OAAO,EAAE,GAAG;AACb,CAAA,CAAC;AACK,MAAM,wBAAwB,GAAG,IAAI,mBAAmB,CAAC;AAC9D,IAAA,SAAS,EAAE,IAAI;AACf,IAAA,OAAO,EAAE,GAAG;AACb,CAAA,CAAC;AACK,MAAM,YAAY,GAAG,IAAI,YAAY;AACrC,MAAM,sBAAsB,GAAG,IAAI,YAAY,CAAC;AACrD,IAAA,OAAO,EAAE,GAAG;AACZ,IAAA,OAAO,EAAE,GAAG;AACZ,IAAA,OAAO,EAAE,IAAI;AACb,IAAA,KAAK,EAAE,GAAG;AACX,CAAA;AACM,MAAM,sBAAsB,GAAG,IAAI,YAAY,CAAC;AACrD,IAAA,OAAO,EAAE,GAAG;AACZ,IAAA,OAAO,EAAE,GAAG;AACZ,IAAA,OAAO,EAAE,GAAG;AACZ,IAAA,KAAK,EAAE,GAAG;AACX,CAAA;AACM,MAAM,WAAW,GAAG,IAAI,WAAW,EAAE;AACrC,MAAM,kBAAkB,GAAG,IAAI,WAAW,CAAC;AAChD,IAAA,QAAQ,EAAE,KAAK;AACf,IAAA,cAAc,EAAE,GAAG;AACnB,IAAA,WAAW,EAAE,GAAG;AAChB,IAAA,aAAa,EAAE,GAAG;AACnB,CAAA,CAAC;AACK,MAAM,YAAY,GAAG,IAAI,YAAY,EAAE;AACvC,MAAM,mBAAmB,GAAG,IAAI,YAAY,CAAC;AAClD,IAAA,SAAS,EAAE,GAAG;AACd,IAAA,UAAU,EAAE,IAAI;AAChB,IAAA,UAAU,EAAE,IAAI;AAChB,IAAA,WAAW,EAAE,GAAG;AACjB,CAAA,CAAC;AACK,MAAM,kBAAkB,GAAG,IAAI,YAAY,CAAC;AACjD,IAAA,SAAS,EAAE,GAAG;AACd,IAAA,UAAU,EAAE,IAAI;AAChB,IAAA,UAAU,EAAE,IAAI;AAChB,IAAA,WAAW,EAAE,IAAI;AAClB,CAAA,CAAC;AAEF;AACA,gBAAgB,CAAC,IAAI,GAAG,YAAY;AACpC,iBAAiB,CAAC,IAAI,GAAG,aAAa;AACtC,sBAAsB,CAAC,IAAI,GAAG,kBAAkB;AAChD,uBAAuB,CAAC,IAAI,GAAG,mBAAmB;AAClD,mBAAmB,CAAC,IAAI,GAAG,eAAe;AAC1C,oBAAoB,CAAC,IAAI,GAAG,gBAAgB;AAC5C,sBAAsB,CAAC,IAAI,GAAG,kBAAkB;AAChD,sBAAsB,CAAC,IAAI,GAAG,kBAAkB;AAChD,wBAAwB,CAAC,IAAI,GAAG,oBAAoB;AACpD,wBAAwB,CAAC,IAAI,GAAG,oBAAoB;AACpD,kBAAkB,CAAC,IAAI,GAAG,cAAc;AACxC,mBAAmB,CAAC,IAAI,GAAG,eAAe;AAC1C,kBAAkB,CAAC,IAAI,GAAG,cAAc;AAExC;SACgB,iBAAiB,GAAA;IAC/B,OAAO;QACL,UAAU;QACV,eAAe;QACf,gBAAgB;QAChB,aAAa;QACb,eAAe;QACf,oBAAoB;QACpB,kBAAkB;QAClB,UAAU;QACV,gBAAgB;QAChB,iBAAiB;QACjB,gBAAgB;QAChB,sBAAsB;QACtB,uBAAuB;QACvB,cAAc;QACd,mBAAmB;QACnB,wBAAwB;QACxB,wBAAwB;QACxB,oBAAoB;QACpB,YAAY;QACZ,sBAAsB;QACtB,sBAAsB;QACtB,WAAW;QACX,kBAAkB;QAClB,YAAY;QACZ,mBAAmB;QACnB,kBAAkB;KACnB;AACH;AAIA;AACM,SAAU,sBAAsB,CAAC,OAAsB,EAAA;AAC3D,IAAA,iBAAiB,EAAE,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AACnE;;AC5HM,MAAO,YAAa,SAAQ,YAAgC,CAAA;AAehE,IAAA,WAAA,CAAY,OAA4B,EAAA;AACtC,QAAA,KAAK,EAAE;QAbD,IAAA,CAAA,QAAQ,GAA6D,IAAI;AAIzE,QAAA,IAAA,CAAA,YAAY,GAA6B,IAAI,GAAG,EAAE;AAClD,QAAA,IAAA,CAAA,QAAQ,GAA8B,IAAI,GAAG,EAAE;QAC/C,IAAA,CAAA,WAAW,GAAkB,IAAI;QACjC,IAAA,CAAA,mBAAmB,GAAkB,IAAI;QACzC,IAAA,CAAA,aAAa,GAA0B,IAAI;QAC3C,IAAA,CAAA,OAAO,GAAG,KAAK;AACf,QAAA,IAAA,CAAA,iBAAiB,GAAa,EAAE,CAAC;AAIvC,QAAA,IAAI,CAAC,OAAO,GAAG,OAAO;AACtB,QAAA,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM;;AAG5B,QAAA,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,CAAC;YACnC,MAAM,EAAE,OAAO,CAAC,MAAM;AACtB,YAAA,YAAY,EAAE,CAAC;AACf,YAAA,MAAM,EAAE,OAAO,CAAC,MAAM,IAAI,MAAM;AAChC,YAAA,gBAAgB,EAAE,OAAO,CAAC,gBAAgB,IAAI,IAAI;AAClD,YAAA,kBAAkB,EAAE,OAAO,CAAC,kBAAkB,IAAI,IAAI;AACtD,YAAA,IAAI,EAAE,OAAO,CAAC,IAAI,KAAK,KAAK;AAC5B,YAAA,SAAS,EAAE,OAAO,CAAC,QAAQ,IAAI,KAAK;AACrC,SAAA,CAAC;AAEF,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI,WAAW,CAAC;YACjC,WAAW,EAAE,WAAW;AACzB,SAAA,CAAC;AACF,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,aAAa,EAAE;;AAGxC,QAAA,sBAAsB,CAAC,IAAI,CAAC,aAAa,CAAC;;QAG1C,IAAI,CAAC,mBAAmB,EAAE;;AAG1B,QAAA,IAAI,OAAO,CAAC,iBAAiB,EAAE;YAC7B,IAAI,CAAC,EAAE,CAAC,iBAAiB,EAAE,OAAO,CAAC,iBAAiB,CAAC;QACvD;AACA,QAAA,IAAI,OAAO,CAAC,eAAe,EAAE;YAC3B,IAAI,CAAC,EAAE,CAAC,eAAe,EAAE,OAAO,CAAC,eAAe,CAAC;QACnD;IACF;AAEA,IAAA,MAAM,UAAU,GAAA;AACd,QAAA,IAAI;;AAEF,YAAA,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,EAAE;AAC9B,gBAAA,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC;YAClD;;AAGA,YAAA,MAAM,IAAI,CAAC,aAAa,EAAE;;YAG1B,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE;gBACtC,IAAI,CAAC,aAAa,EAAE;YACtB;AAEA,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;QACpB;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAc,CAAC;AAClC,YAAA,MAAM,KAAK;QACb;IACF;IAEQ,kBAAkB,GAAA;;QAExB,IAAI,IAAI,CAAC,OAAO,CAAC,gBAAgB,KAAK,KAAK,EAAE;AAC3C,YAAA,MAAM,cAAc,GAAG,IAAI,cAAc,EAAE;YAC3C,IAAI,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;AAC1C,gBAAA,IAAI,CAAC,QAAQ,GAAG,cAAc;AAC9B,gBAAA,IAAI,CAAC,OAAO,GAAG,IAAI;;AAGnB,gBAAA,cAAc,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAChE,gBAAA,cAAc,CAAC,EAAE,CAAC,aAAa,EAAE,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;AAChE,gBAAA,cAAc,CAAC,EAAE,CAAC,iBAAiB,EAAE,MAAM,IAAI,CAAC,qBAAqB,EAAE,CAAC;AAExE,gBAAA,OAAO,IAAI;YACb;YACA,cAAc,CAAC,OAAO,EAAE;QAC1B;;QAGA,IAAI,IAAI,CAAC,OAAO,CAAC,gBAAgB,KAAK,KAAK,EAAE;AAC3C,YAAA,MAAM,aAAa,GAAG,IAAI,aAAa,EAAE;YACzC,IAAI,aAAa,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;AACzC,gBAAA,IAAI,CAAC,QAAQ,GAAG,aAAa;AAC7B,gBAAA,IAAI,CAAC,OAAO,GAAG,IAAI;;AAGnB,gBAAA,aAAa,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAC/D,gBAAA,aAAa,CAAC,EAAE,CAAC,aAAa,EAAE,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;AAC/D,gBAAA,aAAa,CAAC,EAAE,CAAC,iBAAiB,EAAE,MAAM,IAAI,CAAC,qBAAqB,EAAE,CAAC;AAEvE,gBAAA,OAAO,IAAI;YACb;YACA,aAAa,CAAC,OAAO,EAAE;QACzB;;AAGA,QAAA,MAAM,gBAAgB,GAAG,IAAI,gBAAgB,EAAE;QAC/C,IAAI,gBAAgB,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;AAC5C,YAAA,IAAI,CAAC,QAAQ,GAAG,gBAAgB;AAChC,YAAA,IAAI,CAAC,OAAO,GAAG,KAAK;AACpB,YAAA,OAAO,IAAI;QACb;AAEA,QAAA,OAAO,KAAK;IACd;IAEQ,mBAAmB,GAAA;AACzB,QAAA,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC,IAAI,EAAE,EAAE,KAAI;YACnD,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,EAAE,EAAE,CAAC;AACtC,YAAA,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,EAAE,CAAC;AAChC,QAAA,CAAC,CAAC;QAEF,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,eAAe,EAAE,CAAC,KAAK,KAAI;AAC9C,YAAA,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,KAAK,CAAC;AACnC,QAAA,CAAC,CAAC;QAEF,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC,SAAS,KAAI;YACpD,IAAI,SAAS,EAAE;AACb,gBAAA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;gBACjB,IAAI,CAAC,aAAa,EAAE;YACtB;iBAAO;AACL,gBAAA,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;gBAClB,IAAI,CAAC,YAAY,EAAE;YACrB;AACF,QAAA,CAAC,CAAC;AAEF,QAAA,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC,QAAQ,EAAE,QAAQ,KAAI;AACzD,YAAA,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC;AACpC,QAAA,CAAC,CAAC;IACJ;AAEQ,IAAA,MAAM,aAAa,GAAA;QACzB,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAE9C,QAAA,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,KAAI;AACzF,YAAA,IAAI,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,KAAK,CAAC,EAAE;;gBAEhD,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;AACxD,gBAAA,MAAM,QAAQ,GAAG,MAAM,CAAC,UAAU,CAAC;gBACnC,IAAI,QAAQ,EAAE;oBACZ,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC;oBAC5D,IAAI,YAAY,EAAE;wBAChB,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,YAAY,CAAC;wBAC7C,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,UAAU,EAAE,YAAY,CAAC;AAClD,wBAAA,IAAI,CAAC,oBAAoB,CAAC,YAAY,EAAE,UAAU,CAAC;oBACrD;gBACF;YACF;AACF,QAAA,CAAC,CAAC;;QAGF,YAAY,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,KAAK,KAAI;AACpC,YAAA,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAE,EAAE,KAAK,CAAC;YAC5C,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,KAAK,EAAE,KAAK,CAAC;;YAGtC,IACE,IAAI,CAAC,OAAO;AACZ,iBAAC,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC,EACnF;AACA,gBAAA,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC;gBACxD,IAAI,OAAO,EAAE;AACX,oBAAA,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAE,EAAE,OAAO,CAAC;gBAC5C;YACF;AACF,QAAA,CAAC,CAAC;AAEF,QAAA,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,YAAY,CAAC;IAC5C;IAEQ,oBAAoB,CAAC,KAAkB,EAAE,UAAmB,EAAA;QAClE,IACE,IAAI,CAAC,OAAO;AACZ,aAAC,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC,EACnF;YACA,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC9C,YAAA,MAAM,KAAK,GAAG,UAAU,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;AACjE,YAAA,MAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAE;;;AAK/B,YAAA,IAAI,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC;YACtD,IAAI,OAAO,EAAE;gBACX,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,EAAE,OAAO,CAAC;YACtC;YAEA,IAAI,OAAO,EAAE;;gBAEX,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;gBAClD,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC;AACjD,gBAAA,MAAM,QAAQ,GAAG,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE;;gBAIpD,IAAI,MAAM,EAAE;AACV,oBAAA,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;wBACtB,YAAY,EAAE,MAAM,CAAC,YAAY;wBACjC,cAAc,EAAE,MAAM,CAAC,cAAc;AACtC,qBAAA,CAAC;gBACJ;;AAGA,gBAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,CAAC;YACzE;QACF;AAAO,aAAA,IAAI,IAAI,CAAC,QAAQ,YAAY,gBAAgB,EAAE;YACpD,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC;AAC5C,YAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QACzB;IACF;IAEQ,eAAe,CAAC,IAAY,EAAE,EAAU,EAAA;QAC9C,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC9C,QAAA,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAE,CAAC;AACtD,QAAA,MAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAE,CAAC;AAElD,QAAA,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,EAAE;;AAE1B,YAAA,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,EAAE,CAAC;YACnC;QACF;AAEA,QAAA,IAAI,CAAC,mBAAmB,GAAG,WAAW,CAAC,GAAG,EAAE;QAE5C,IACE,IAAI,CAAC,OAAO;AACZ,aAAC,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC,EACnF;AACA,YAAA,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAE,CAAC;AACpD,YAAA,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAE,CAAC;AAEhD,YAAA,IAAI,WAAW,IAAI,SAAS,EAAE;;gBAE5B,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;gBAClD,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC;;AAG/C,gBAAA,IAAI,UAAU,KAAK,gBAAgB,IAAI,MAAM,EAAE;AAC7C,oBAAA,IAAI;;wBAEF,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,IAAI,MAAM,CAAC,kBAAkB,EAAE;AACxE,4BAAA,MAAM,IAAI,GAAG,MAAM,CAAC,OAAO,IAAI;AAC/B,4BAAA,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;AAC7C,gCAAA,OAAO,CAAC,KAAK,CACX,qFAAqF,CACtF;gCACD,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC;gCACvC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC;4BACzC;iCAAO;AACL,gCAAA,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;oCACpB,QAAQ,EAAE,IAAI,CAAC,SAAS;oCACxB,OAAO,EAAE,IAAI,CAAC,OAAO;oCACrB,SAAS,EAAE,IAAI,CAAC,SAAS;oCACzB,OAAO,EAAE,IAAI,CAAC,OAAO;oCACrB,YAAY,EAAE,MAAM,CAAC,eAAe,IAAI,EAAE,SAAS,IAAI,SAAS;AACjE,iCAAA,CAAC;4BACJ;wBACF;oBACF;oBAAE,OAAO,KAAK,EAAE;AACd,wBAAA,OAAO,CAAC,KAAK,CAAC,iEAAiE,EAAE,KAAK,CAAC;wBACvF,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC;wBACvC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC;oBACzC;gBACF;gBAEA,IAAI,MAAM,EAAE;AACV,oBAAA,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;wBACtB,YAAY,EAAE,MAAM,CAAC,YAAY;wBACjC,cAAc,EAAE,MAAM,CAAC,cAAc;AACtC,qBAAA,CAAC;gBACJ;gBAEA,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,SAAS,EAAE,EAAE,CAAC;YACpD;iBAAO;AACL,gBAAA,OAAO,CAAC,KAAK,CAAC,iDAAiD,EAAE;oBAC/D,WAAW,EAAE,CAAC,CAAC,WAAW;oBAC1B,SAAS,EAAE,CAAC,CAAC,SAAS;AACvB,iBAAA,CAAC;YACJ;QACF;AAAO,aAAA,IAAI,IAAI,CAAC,QAAQ,YAAY,gBAAgB,EAAE;AACpD,YAAA,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC;YAC3D,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC;QACxC;IACF;AAEQ,IAAA,iBAAiB,CACvB,WAAgC,EAChC,SAA8B,EAC9B,OAAe,EAAA;QAEf,MAAM,OAAO,GAAG,MAAK;AACnB,YAAA,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;gBAC7B;YACF;YAEA,MAAM,OAAO,GAAG,WAAW,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,mBAAmB;YAC5D,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,oBAAoB,CAAC;AAC5D,YAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,QAAQ,EAAE,CAAC,CAAC;AAEhD,YAAA,IAAI;gBACF,IACE,IAAI,CAAC,OAAO;qBACX,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC;oBACnF,WAAW;AACX,oBAAA,SAAS,EACT;AACA,oBAAA,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACtE,oBAAA,MAAM,QAAQ,GAAG,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,EAAE;oBAC3D,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;oBAC9C,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;AAC1D,oBAAA,MAAM,OAAO,GAAG,MAAM,CAAC,YAAY,CAAC;AACpC,oBAAA,MAAM,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC;oBAE7B,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,IAAI,MAAM,EAAE,eAAe,EAAE;AACtE,wBAAA,MAAM,YAAY,GAAG,MAAM,CAAC,eAAe,EAAE;AAC7C,wBAAA,MAAM,aAAa,GAAG,YAAY,EAAE;AAClC,8BAAE,YAAY,CAAC,SAAS,CAAC,MAAM,GAAG;8BAChC,SAAS;;AAEb,wBAAA,IAAI,aAAa,IAAI,aAAa,GAAG,CAAC,EAAE;AACtC,4BAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAClB,WAAW,EACX,SAAS,EACT,QAAQ,EACR,QAAQ,EACR,OAAO,EACP,KAAK,EACL,aAAa,CACd;wBACH;6BAAO;AACL,4BAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,CAAC;wBAClF;oBACF;yBAAO;AACL,wBAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,CAAC;oBAClF;gBACF;AAAO,qBAAA,IAAI,IAAI,CAAC,QAAQ,YAAY,gBAAgB,EAAE;AACpD,oBAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC;gBAChC;YACF;YAAE,OAAO,KAAK,EAAE;AACd,gBAAA,OAAO,CAAC,KAAK,CAAC,6CAA6C,EAAE,KAAK,CAAC;;AAEnE,gBAAA,IAAI,CAAC,WAAW,GAAG,IAAI;AACvB,gBAAA,IAAI,CAAC,mBAAmB,GAAG,IAAI;AAC/B,gBAAA,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,OAAO,CAAC;gBACxC;YACF;AAEA,YAAA,IAAI,QAAQ,GAAG,CAAC,EAAE;AAChB,gBAAA,IAAI,CAAC,WAAW,GAAG,qBAAqB,CAAC,OAAO,CAAC;YACnD;iBAAO;AACL,gBAAA,IAAI,CAAC,WAAW,GAAG,IAAI;AACvB,gBAAA,IAAI,CAAC,mBAAmB,GAAG,IAAI;AAC/B,gBAAA,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,OAAO,CAAC;;gBAGxC,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE;oBACtC,IAAI,CAAC,sBAAsB,EAAE;gBAC/B;YACF;AACF,QAAA,CAAC;AAED,QAAA,OAAO,EAAE;IACX;IAEQ,iBAAiB,GAAA;;AAEvB,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;AACpB,YAAA,oBAAoB,CAAC,IAAI,CAAC,WAAW,CAAC;AACtC,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI;QACzB;;AAGA,QAAA,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;IACvB;IAEQ,qBAAqB,GAAA;;QAE3B,IACE,IAAI,CAAC,OAAO;AACZ,aAAC,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC,EACnF;YACA,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC,YAAY,EAAE;AAC5C,gBAAA,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC;gBACxD,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC;gBACjC;YACF;QACF;;QAGA,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;QAC1D,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC9C,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,YAAY,CAAE,CAAC;QAEjE,IAAI,YAAY,EAAE;AAChB,YAAA,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC;QACzC;IACF;IAEQ,aAAa,GAAA;QACnB,IAAI,CAAC,YAAY,EAAE;QACnB,IAAI,CAAC,sBAAsB,EAAE;IAC/B;IAEQ,YAAY,GAAA;AAClB,QAAA,IAAI,IAAI,CAAC,aAAa,EAAE;AACtB,YAAA,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC;AAChC,YAAA,IAAI,CAAC,aAAa,GAAG,IAAI;QAC3B;IACF;IAEQ,sBAAsB,GAAA;QAC5B,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,CAAC;YAAE;;QAGzC,IAAI,CAAC,YAAY,EAAE;QAEnB,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,kBAAkB,CAAC;AAC1D,QAAA,IAAI,CAAC,aAAa,GAAG,UAAU,CAAC,MAAK;AACnC,YAAA,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,iBAAiB,CAAC,EAAE;gBACnF,IAAI,CAAC,IAAI,EAAE;YACb;QACF,CAAC,EAAE,QAAQ,CAAC;IACd;;IAGA,IAAI,GAAA;AACF,QAAA,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,iBAAiB,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE;YAC9E,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE;AAClD,YAAA,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,SAAS,CAAC;QAC9C;IACF;IAEA,QAAQ,GAAA;AACN,QAAA,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,iBAAiB,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,EAAE;YAClF,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE;AACtD,YAAA,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,SAAS,CAAC;QAC9C;IACF;AAEA,IAAA,IAAI,CAAC,KAAa,EAAA;QAChB,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;QAC9C,IACE,KAAK,IAAI,CAAC;YACV,KAAK,GAAG,MAAM,CAAC,MAAM;YACrB,KAAK,KAAK,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;YAC/C,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,iBAAiB,CAAC,EACzC;AACA,YAAA,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,KAAK,CAAC;QAC1C;IACF;IAEA,IAAI,GAAA;QACF,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC;IAC1C;IAEA,KAAK,GAAA;QACH,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC;IAC3C;IAEA,WAAW,CAAC,OAAgB,EAAE,QAAiB,EAAA;AAC7C,QAAA,IAAI,QAAQ,KAAK,SAAS,EAAE;YAC1B,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,kBAAkB,EAAE,QAAQ,CAAC;QACrD;QACA,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC;IAC7C;AAEA,IAAA,qBAAqB,CAAC,QAAgB,EAAA;QACpC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,oBAAoB,EAAE,QAAQ,CAAC;IACvD;AAEA,IAAA,SAAS,CAAC,UAAkB,EAAA;QAC1B,IAAI,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;YACtC,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC;;AAGjD,YAAA,IAAI,MAAM,IAAI,MAAM,CAAC,cAAc,EAAE;gBACnC,IAAI,EAAE,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC,EAAE;AAC9C,oBAAA,OAAO,CAAC,IAAI,CACV,CAAA,QAAA,EAAW,UAAU,CAAA,8CAAA,EAAiD,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,IAAI,CAAA,8BAAA,CAAgC,CACtI;;AAED,oBAAA,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC/B;YACF;YAEA,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAU,CAAC;;YAG3C,IACE,IAAI,CAAC,OAAO;iBACX,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC;AACnF,gBAAA,MAAM,EACN;AACA,gBAAA,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;oBACtB,YAAY,EAAE,MAAM,CAAC,YAAY;oBACjC,cAAc,EAAE,MAAM,CAAC,cAAc;AACtC,iBAAA,CAAC;;gBAGF,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;gBAC1D,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC9C,gBAAA,MAAM,eAAe,GAAG,MAAM,CAAC,YAAY,CAAC;gBAE5C,IAAI,eAAe,EAAE;oBACnB,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC;oBAClD,IAAI,OAAO,EAAE;wBACX,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,eAAe,CAAC;oBAChF;gBACF;YACF;AAEA,YAAA,OAAO,IAAI;QACb;AACA,QAAA,OAAO,KAAK;IACd;AAEA,IAAA,cAAc,CAAC,MAAe,EAAA;AAC5B,QAAA,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,CAAC;IACrC;IAEA,eAAe,GAAA;QACb,OAAO,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;IAC9C;IAEA,SAAS,GAAA;QACP,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC5C,QAAA,OAAO;AACJ,aAAA,GAAG,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC;aACvC,MAAM,CAAC,CAAC,GAAG,KAAyB,GAAG,KAAK,SAAS,CAAC;IAC3D;IAEA,MAAM,CAAC,KAAc,EAAE,MAAe,EAAA;QACpC,IAAI,CAAC,IAAI,CAAC,QAAQ;YAAE;;QAGpB,MAAM,WAAW,GAAG,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK;QAC9C,MAAM,YAAY,GAAG,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM;QAEjD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,YAAY,CAAC;;QAG/C,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC;QAC1D,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC9C,QAAA,MAAM,eAAe,GAAG,MAAM,CAAC,YAAY,CAAC;AAE5C,QAAA,IAAI,CAAC,eAAe;YAAE;QAEtB,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,eAAe,CAAC;AAC3D,QAAA,IAAI,CAAC,YAAY;YAAE;;QAGnB,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,iBAAiB,CAAC,EAAE;YAC5C;QACF;;QAGA,IACE,IAAI,CAAC,OAAO;AACZ,aAAC,IAAI,CAAC,QAAQ,YAAY,aAAa,IAAI,IAAI,CAAC,QAAQ,YAAY,cAAc,CAAC,EACnF;YACA,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC;YAClD,IAAI,OAAO,EAAE;;gBAEX,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC;gBAClD,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC;AACjD,gBAAA,MAAM,QAAQ,GAAG,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE;AAEpD,gBAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,EAAE,QAAQ,EAAE,eAAe,CAAC;YACnE;QACF;AAAO,aAAA,IAAI,IAAI,CAAC,QAAQ,YAAY,gBAAgB,EAAE;YACpD,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC;AACnD,YAAA,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QACzB;IACF;IAEA,OAAO,GAAA;;AAEL,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;AACpB,YAAA,oBAAoB,CAAC,IAAI,CAAC,WAAW,CAAC;AACtC,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI;QACzB;;QAGA,IAAI,CAAC,YAAY,EAAE;;AAGnB,QAAA,IAAI,IAAI,CAAC,QAAQ,EAAE;AACjB,YAAA,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE;AACvB,YAAA,IAAI,CAAC,QAAQ,GAAG,IAAI;QACtB;;AAGA,QAAA,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE;AAC7B,QAAA,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE;AACzB,QAAA,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;;QAGrB,IAAI,CAAC,kBAAkB,EAAE;AACzB,QAAA,IAAI,CAAC,YAAY,CAAC,kBAAkB,EAAE;IACxC;IAEA,OAAO,GAAA;AACL,QAAA,OAAO,IAAI,CAAC,QAAQ,KAAK,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,CAAC;IAC7D;IAEA,YAAY,GAAA;QACV,OAAO,IAAI,CAAC,OAAO;IACrB;AACD;;ACvoBK,MAAO,aAAc,SAAQ,YAAiC,CAAA;AAQlE,IAAA,WAAA,CAAY,OAA6B,EAAA;AACvC,QAAA,KAAK,EAAE;QAJD,IAAA,CAAA,aAAa,GAAG,KAAK;QAwMrB,IAAA,CAAA,YAAY,GAAG,MAAW;YAChC,IAAI,CAAC,YAAY,EAAE;AACnB,YAAA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;AACzD,QAAA,CAAC;;QApMC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC;QAC5C,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM;;AAGjC,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;;AAG1D,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,EAAE;;AAGjC,QAAA,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,EAAE;;AAG7B,QAAA,KAAK,IAAI,CAAC,UAAU,EAAE;IACxB;AAEQ,IAAA,eAAe,CAAC,OAA6B,EAAA;AACnD,QAAA,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;AACtB,YAAA,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC;QAC1C;AAEA,QAAA,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;AAClD,YAAA,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC;QACnD;QAEA,OAAO;YACL,SAAS,EAAE,OAAO,CAAC,SAAS;YAC5B,MAAM,EAAE,OAAO,CAAC,MAAM;AACtB,YAAA,MAAM,EAAE,OAAO,CAAC,MAAM,IAAI,MAAM;AAChC,YAAA,OAAO,EAAE,OAAO,CAAC,OAAO,IAAI,EAAE;AAC9B,YAAA,QAAQ,EAAE,OAAO,CAAC,QAAQ,IAAI,KAAK;AACnC,YAAA,gBAAgB,EAAE,OAAO,CAAC,gBAAgB,IAAI,IAAI;AAClD,YAAA,UAAU,EAAE,OAAO,CAAC,UAAU,IAAI,IAAI;AACtC,YAAA,UAAU,EAAE,OAAO,CAAC,UAAU,IAAI,IAAI;AACtC,YAAA,IAAI,EAAE,OAAO,CAAC,IAAI,IAAI,IAAI;AAC1B,YAAA,OAAO,EAAE,OAAO,CAAC,OAAO,IAAI,IAAI;AAChC,YAAA,kBAAkB,EAAE,OAAO,CAAC,kBAAkB,IAAI,IAAI;AACtD,YAAA,kBAAkB,EAAE,OAAO,CAAC,kBAAkB,IAAI,IAAI;AACtD,YAAA,UAAU,EAAE,OAAO,CAAC,UAAU,IAAI,CAAC;AACnC,YAAA,MAAM,EAAE,OAAO,CAAC,MAAM,KAAK,CAAC,CAAS,KAAK,CAAC,CAAC;YAC5C,aAAa,EAAE,OAAO,CAAC,aAAa,KAAK,MAAK,EAAE,CAAC,CAAC;YAClD,iBAAiB,EAAE,OAAO,CAAC,iBAAiB,KAAK,MAAK,EAAE,CAAC,CAAC;YAC1D,eAAe,EAAE,OAAO,CAAC,eAAe,KAAK,MAAK,EAAE,CAAC,CAAC;YACtD,OAAO,EAAE,OAAO,CAAC,OAAO,KAAK,MAAK,EAAE,CAAC,CAAC;SACvC;IACH;AAEQ,IAAA,YAAY,CAAC,SAA+B,EAAA;AAClD,QAAA,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE;YACjC,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC;YACjD,IAAI,CAAC,OAAO,EAAE;AACZ,gBAAA,MAAM,IAAI,KAAK,CAAC,gCAAgC,SAAS,CAAA,CAAE,CAAC;YAC9D;AACA,YAAA,OAAO,OAAsB;QAC/B;AACA,QAAA,OAAO,SAAS;IAClB;IAEQ,YAAY,GAAA;;AAElB,QAAA,MAAM,iBAAiB,GAAG,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,QAAQ;AAC1E,QAAA,IAAI,iBAAiB,KAAK,QAAQ,EAAE;YAClC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU;QAC5C;QAEA,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;AAC/C,QAAA,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM;AAC3B,QAAA,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM;AAC5B,QAAA,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO;AAC9B,QAAA,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC;AAElC,QAAA,OAAO,MAAM;IACf;IAEQ,YAAY,GAAA;QAClB,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,qBAAqB,EAAE;AACnD,QAAA,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,gBAAgB;AACxD,QAAA,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,gBAAgB;AAC1D,QAAA,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,CAAA,EAAG,IAAI,CAAC,KAAK,CAAA,EAAA,CAAI;AAC3C,QAAA,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,CAAA,EAAG,IAAI,CAAC,MAAM,CAAA,EAAA,CAAI;IAC/C;IAEQ,UAAU,GAAA;;QAEhB,MAAM,UAAU,GACd,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK;AAC7B,cAAE,IAAI,CAAC,OAAO,CAAC;cACb,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,IAAI,MAAM;QAEzC,OAAO,IAAI,YAAY,CAAC;YACtB,MAAM,EAAE,IAAI,CAAC,MAAM;AACnB,YAAA,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM;AAC3B,YAAA,MAAM,EAAE,UAAU;AAClB,YAAA,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ;AAC/B,YAAA,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC,gBAAgB;AAC/C,YAAA,kBAAkB,EAAE,IAAI,CAAC,OAAO,CAAC,kBAAkB;AACnD,YAAA,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI;AACvB,YAAA,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC,kBAAkB;;AAElD,SAAA,CAAC;IACJ;AAEQ,IAAA,MAAM,UAAU,GAAA;AACtB,QAAA,IAAI;;YAEF,IAAI,CAAC,YAAY,EAAE;;YAGnB,IAAI,CAAC,mBAAmB,EAAE;;AAG1B,YAAA,MAAM,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;;YAG5B,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,QAAQ,EAAE;;gBAE3C,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;gBACxC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC;YAC1C;iBAAO;gBACL,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;YACrC;;AAGA,YAAA,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;gBACxB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,KAAI;AACtC,oBAAA,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;AAC7B,gBAAA,CAAC,CAAC;YACJ;;AAGA,YAAA,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;AACzB,gBAAA,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC;YAC5D;;YAGA,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC;;AAGhE,YAAA,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;gBAC3B,IAAI,CAAC,wBAAwB,EAAE;YACjC;AAEA,YAAA,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;gBAC3B,IAAI,CAAC,wBAAwB,EAAE;;gBAE/B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,CAAC,CAAC;YACrD;;YAGA,IAAI,CAAC,YAAY,EAAE;;YAGnB,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,YAAY,CAAC;AAEpD,YAAA,IAAI,CAAC,aAAa,GAAG,IAAI;AACzB,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;QACpB;QAAE,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,WAAW,CAAC,KAAc,CAAC;QAClC;IACF;IAEQ,mBAAmB,GAAA;;QAEzB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC,GAAG,IAAe,KAAI;AACjD,YAAA,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAW;AAC/B,YAAA,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,KAAK,CAAC;YAC/B,IAAI,CAAC,OAAO,CAAC,aAAa,GAAG,KAAK,CAAC;AACnC,YAAA,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC;AAC9B,QAAA,CAAC,CAAC;AAEF,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC,IAAY,EAAE,EAAU,KAAI;YAC3D,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,EAAE,EAAE,CAAC;YACtC,IAAI,CAAC,OAAO,CAAC,iBAAiB,GAAG,IAAI,EAAE,EAAE,CAAC;AAC5C,QAAA,CAAC,CAAC;QAEF,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,EAAE,CAAC,KAAa,KAAI;AAC9C,YAAA,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,KAAK,CAAC;YACjC,IAAI,CAAC,OAAO,CAAC,eAAe,GAAG,KAAK,CAAC;AACvC,QAAA,CAAC,CAAC;QAEF,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,KAAK,KAAI;AAC9B,YAAA,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;AACzB,QAAA,CAAC,CAAC;AAEF,QAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,MAAK,EAAE,CAAC,CAAC;IACjC;AAEQ,IAAA,WAAW,CAAC,KAAY,EAAA;AAC9B,QAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC;QACzB,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,KAAK,CAAC;AAC7B,QAAA,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,KAAK,CAAC;IAC9C;IAOQ,wBAAwB,GAAA;QAC9B,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;AACnD,QAAA,UAAU,CAAC,SAAS,GAAG,qBAAqB;AAC5C,QAAA,UAAU,CAAC,SAAS,GAAG,UAAU;AACjC,QAAA,UAAU,CAAC,YAAY,CAAC,YAAY,EAAE,gBAAgB,CAAC;AACvD,QAAA,UAAU,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAC;QAE3D,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;AACnD,QAAA,UAAU,CAAC,SAAS,GAAG,qBAAqB;AAC5C,QAAA,UAAU,CAAC,SAAS,GAAG,UAAU;AACjC,QAAA,UAAU,CAAC,YAAY,CAAC,YAAY,EAAE,YAAY,CAAC;AACnD,QAAA,UAAU,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;AAEvD,QAAA,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC;AACtC,QAAA,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC;;QAGtC,IAAI,CAAC,mBAAmB,EAAE;IAC5B;IAEQ,wBAAwB,GAAA;QAC9B,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;AAChD,QAAA,UAAU,CAAC,SAAS,GAAG,2BAA2B;QAElD,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM;AAC7C,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;YACnC,MAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;AAC5C,YAAA,GAAG,CAAC,SAAS,GAAG,oBAAoB;YACpC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,CAAA,YAAA,EAAe,CAAC,GAAG,CAAC,CAAA,CAAE,CAAC;AACtD,YAAA,GAAG,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAEjD,YAAA,IAAI,CAAC,KAAK,CAAC,EAAE;AACX,gBAAA,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC;YAC7B;AAEA,YAAA,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC;QAC7B;AAEA,QAAA,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC;;QAGtC,IAAI,CAAC,mBAAmB,EAAE;IAC5B;AAEQ,IAAA,gBAAgB,CAAC,KAAa,EAAA;QACpC,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,qBAAqB,CAAC;QACnE,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,KAAI;YACtB,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,KAAK,KAAK,CAAC;AAC7C,QAAA,CAAC,CAAC;IACJ;IAEQ,mBAAmB,GAAA;AACzB,QAAA,IAAI,QAAQ,CAAC,cAAc,CAAC,2BAA2B,CAAC;YAAE;QAE1D,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC;AAC7C,QAAA,KAAK,CAAC,EAAE,GAAG,2BAA2B;QACtC,KAAK,CAAC,WAAW,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;KA4BnB;AAED,QAAA,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;IAClC;IAEQ,mBAAmB,GAAA;AACzB,QAAA,IAAI,QAAQ,CAAC,cAAc,CAAC,kCAAkC,CAAC;YAAE;QAEjE,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC;AAC7C,QAAA,KAAK,CAAC,EAAE,GAAG,kCAAkC;QAC7C,KAAK,CAAC,WAAW,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;KA4BnB;AAED,QAAA,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;IAClC;;IAIA,IAAI,GAAA;QACF,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;IAClB;IAEA,QAAQ,GAAA;QACN,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;IACtB;AAEA,IAAA,IAAI,CAAC,KAAa,EAAA;QAChB,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;IACvB;AAEA,IAAA,SAAS,CAAC,UAAkB,EAAA;QAC1B,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;QAEzB,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC;QAC/C,IAAI,OAAO,EAAE;AACX,YAAA,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,UAAU,CAAC;QACvC;IACF;IAEA,mBAAmB,GAAA;;QAEjB,OAAO;YACL,MAAM;YACN,WAAW;YACX,YAAY;YACZ,SAAS;YACT,WAAW;YACX,gBAAgB;YAChB,cAAc;YACd,MAAM;YACN,YAAY;YACZ,UAAU;YACV,eAAe;YACf,QAAQ;YACR,OAAO;YACP,QAAQ;YACR,UAAU;SACX;IACH;AAEA,IAAA,cAAc,CAAC,MAAe,EAAA;QAC5B,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;IAClC;IAEA,IAAI,GAAA;QACF,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC;IAC5D;IAEA,KAAK,GAAA;QACH,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;IAC9B;IAEA,WAAW,CAAC,OAAgB,EAAE,QAAiB,EAAA;QAC7C,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;QACzB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,QAAQ,CAAC;IAC1C;AAEA,IAAA,qBAAqB,CAAC,QAAgB,EAAA;QACpC,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC;IAC3C;IAEA,eAAe,GAAA;AACb,QAAA,OAAO,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;IACpC;IAEA,aAAa,GAAA;;AAEX,QAAA,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM;IAC3B;IAEA,OAAO,GAAA;QACL,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;;QAGzB,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,YAAY,CAAC;;AAGvD,QAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;;QAGnB,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE;YACzC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC;QACjD;;QAGA,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAC9C,wEAAwE,CACzE;AACD,QAAA,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,KAAK,OAAO,CAAC,MAAM,EAAE,CAAC;;QAG/C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,EAAE;AAElC,QAAA,IAAI,CAAC,aAAa,GAAG,KAAK;QAC1B,IAAI,CAAC,kBAAkB,EAAE;IAC3B;IAEA,OAAO,GAAA;QACL,OAAO,IAAI,CAAC,aAAa;IAC3B;IAEA,YAAY,GAAA;AACV,QAAA,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;IACjC;AAEA,IAAA,YAAY,CAAC,MAAgB,EAAA;QAC3B,IAAI,CAAC,IAAI,CAAC,aAAa;YAAE;AACzB,QAAA,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM;;;IAG9B;IAEA,SAAS,GAAA;AACP,QAAA,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM;IAC5B;AACD;;ACrbM,MAAM,kBAAkB,GAAGA,gBAAU,CAC1C,CAAC,KAAK,EAAE,GAAG,KAAI;AACb,IAAA,MAAM,EACJ,SAAS,EACT,KAAK,EACL,KAAK,GAAG,MAAM,EACd,MAAM,GAAG,OAAO,EAChB,OAAO,EACP,aAAa,EACb,iBAAiB,EACjB,eAAe,EACf,OAAO,EACP,cAAc,EACd,GAAG,eAAe,EACnB,GAAG,KAAK;AAET,IAAA,MAAM,YAAY,GAAGC,YAAM,CAAiB,IAAI,CAAC;AACjD,IAAA,MAAM,WAAW,GAAGA,YAAM,CAAuB,IAAI,CAAC;;AAGtD,IAAAC,yBAAmB,CACjB,GAAG,EACH,OAAO;QACL,IAAI,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE;QACvC,QAAQ,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,QAAQ,EAAE;AAC/C,QAAA,IAAI,EAAE,CAAC,KAAa,KAAK,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC;AACzD,QAAA,SAAS,EAAE,CAAC,UAAkB,KAAK,WAAW,CAAC,OAAO,EAAE,SAAS,CAAC,UAAU,CAAC;QAC7E,mBAAmB,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,mBAAmB,EAAE,IAAI,EAAE;AAC3E,QAAA,cAAc,EAAE,CAAC,MAAe,KAAK,WAAW,CAAC,OAAO,EAAE,cAAc,CAAC,MAAM,CAAC;QAChF,IAAI,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE;QACvC,KAAK,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE;AACzC,QAAA,qBAAqB,EAAE,CAAC,QAAgB,KACtC,WAAW,CAAC,OAAO,EAAE,qBAAqB,CAAC,QAAQ,CAAC;QACtD,eAAe,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,eAAe,EAAE,IAAI,CAAC;QAClE,aAAa,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,aAAa,EAAE,IAAI,CAAC;QAC9D,OAAO,EAAE,MAAM,WAAW,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,KAAK;KACvD,CAAC,EACF,EAAE,CACH;IAEDC,eAAS,CAAC,MAAK;QACb,IAAI,CAAC,YAAY,CAAC,OAAO;YAAE;;AAG3B,QAAA,MAAM,QAAQ,GAAG,IAAI,aAAa,CAAC;AACjC,YAAA,GAAG,eAAe;YAClB,SAAS,EAAE,YAAY,CAAC,OAAO;AAC/B,YAAA,aAAa,EAAE,aAAa;AAC5B,YAAA,iBAAiB,EAAE,iBAAiB;AACpC,YAAA,eAAe,EAAE,eAAe;AAChC,YAAA,OAAO,EAAE,OAAO;AACjB,SAAA,CAAC;AAEF,QAAA,WAAW,CAAC,OAAO,GAAG,QAAQ;;QAG9B,IAAI,OAAO,EAAE;AACX,YAAA,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;QAC/B;QAEA,IAAI,aAAa,EAAE;AACjB,YAAA,QAAQ,CAAC,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC;QAC3C;QAEA,IAAI,iBAAiB,EAAE;AACrB,YAAA,QAAQ,CAAC,EAAE,CAAC,iBAAiB,EAAE,iBAAiB,CAAC;QACnD;QAEA,IAAI,eAAe,EAAE;AACnB,YAAA,QAAQ,CAAC,EAAE,CAAC,eAAe,EAAE,eAAe,CAAC;QAC/C;QAEA,IAAI,OAAO,EAAE;AACX,YAAA,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;QAC/B;QAEA,IAAI,cAAc,EAAE;AAClB,YAAA,QAAQ,CAAC,EAAE,CAAC,cAAc,EAAE,cAAc,CAAC;QAC7C;;AAGA,QAAA,OAAO,MAAK;YACV,QAAQ,CAAC,OAAO,EAAE;AAClB,YAAA,WAAW,CAAC,OAAO,GAAG,IAAI;AAC5B,QAAA,CAAC;AACH,IAAA,CAAC,EAAE,EAAE,CAAC,CAAC;;IAGPA,eAAS,CAAC,MAAK;QACb,IAAI,CAAC,WAAW,CAAC,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE;YAAE;AAE5D,QAAA,IAAI,eAAe,CAAC,MAAM,EAAE;AAC1B,YAAA,IAAI,OAAO,eAAe,CAAC,MAAM,KAAK,QAAQ,EAAE;;gBAE9C,WAAW,CAAC,OAAO,CAAC,cAAc,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC1D,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC;YAC5D;iBAAO;gBACL,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,eAAe,CAAC,MAAM,CAAC;YACvD;QACF;AACF,IAAA,CAAC,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;IAE5BA,eAAS,CAAC,MAAK;QACb,IAAI,CAAC,WAAW,CAAC,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE;YAAE;AAE5D,QAAA,IAAI,eAAe,CAAC,QAAQ,KAAK,SAAS,EAAE;AAC1C,YAAA,IAAI,eAAe,CAAC,QAAQ,EAAE;AAC5B,gBAAA,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE;YAC5B;iBAAO;AACL,gBAAA,WAAW,CAAC,OAAO,CAAC,KAAK,EAAE;YAC7B;QACF;AACF,IAAA,CAAC,EAAE,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;IAE9BA,eAAS,CAAC,MAAK;QACb,IAAI,CAAC,WAAW,CAAC,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE;YAAE;AAE5D,QAAA,IAAI,eAAe,CAAC,kBAAkB,KAAK,SAAS,EAAE;YACpD,WAAW,CAAC,OAAO,CAAC,qBAAqB,CAAC,eAAe,CAAC,kBAAkB,CAAC;QAC/E;AACF,IAAA,CAAC,EAAE,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC;AAExC,IAAA,MAAM,cAAc,GAAwB;QAC1C,KAAK;QACL,MAAM;AACN,QAAA,QAAQ,EAAE,UAAU;AACpB,QAAA,QAAQ,EAAE,QAAQ;AAClB,QAAA,GAAG,KAAK;KACT;IAED,QACE,6BACE,GAAG,EAAE,YAAY,EACjB,SAAS,EAAE,SAAS,EACpB,KAAK,EAAE,cAAc,EACrB,IAAI,EAAC,QAAQ,EAAA,YAAA,EACF,gBAAgB,EAAA,CAC3B;AAEN,CAAC;AAGH,kBAAkB,CAAC,WAAW,GAAG,oBAAoB;;ACpJ9C,MAAM,gBAAgB,GAAGC,mBAAe,CAAC;AAC9C,IAAA,IAAI,EAAE,kBAAkB;AACxB,IAAA,KAAK,EAAE;AACL,QAAA,MAAM,EAAE;AACN,YAAA,IAAI,EAAE,KAA2B;AACjC,YAAA,QAAQ,EAAE,IAAI;AACf,SAAA;AACD,QAAA,QAAQ,EAAE;AACR,YAAA,IAAI,EAAE,OAAO;AACb,YAAA,OAAO,EAAE,KAAK;AACf,SAAA;AACD,QAAA,QAAQ,EAAE;AACR,YAAA,IAAI,EAAE,MAAM;AACZ,YAAA,OAAO,EAAE,IAAI;AACd,SAAA;AACD,QAAA,kBAAkB,EAAE;AAClB,YAAA,IAAI,EAAE,MAAM;AACZ,YAAA,OAAO,EAAE,IAAI;AACd,SAAA;AACD,QAAA,MAAM,EAAE;AACN,YAAA,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,CAAkC;AACvD,YAAA,OAAO,EAAE,MAAM;AAChB,SAAA;AACD,QAAA,OAAO,EAAE;AACP,YAAA,IAAI,EAAE,KAA+B;AACrC,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,YAAY,EAAE;AACZ,YAAA,IAAI,EAAE,OAAO;AACb,YAAA,OAAO,EAAE,IAAI;AACd,SAAA;AACD,QAAA,WAAW,EAAE;AACX,YAAA,IAAI,EAAE,OAAO;AACb,YAAA,OAAO,EAAE,IAAI;AACd,SAAA;AACD,QAAA,UAAU,EAAE;AACV,YAAA,IAAI,EAAE,MAAM;AACZ,YAAA,OAAO,EAAE,CAAC;AACX,SAAA;AACD,QAAA,gBAAgB,EAAE;AAChB,YAAA,IAAI,EAAE,MAAqC;AAC3C,YAAA,OAAO,EAAE,UAAU;AACpB,SAAA;AACD,QAAA,YAAY,EAAE;AACZ,YAAA,IAAI,EAAE,MAA0C;AAChD,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,MAAM,EAAE;AACN,YAAA,IAAI,EAAE,QAA2C;AACjD,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,iBAAiB,EAAE;AACjB,YAAA,IAAI,EAAE,QAAmE;AACzE,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,eAAe,EAAE;AACf,YAAA,IAAI,EAAE,QAAmE;AACzE,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,OAAO,EAAE;AACP,YAAA,IAAI,EAAE,QAA4C;AAClD,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,kBAAkB,EAAE;AAClB,YAAA,IAAI,EAAE,QAAgC;AACtC,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,sBAAsB,EAAE;AACtB,YAAA,IAAI,EAAE,QAAgC;AACtC,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,WAAW,EAAE;AACX,YAAA,IAAI,EAAE,QAAqE;AAC3E,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,YAAY,EAAE;AACZ,YAAA,IAAI,EAAE,QAAmF;AACzF,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACD,QAAA,OAAO,EAAE;AACP,YAAA,IAAI,EAAE,QAAgC;AACtC,YAAA,OAAO,EAAE,SAAS;AACnB,SAAA;AACF,KAAA;AACD,IAAA,KAAK,CAAC,KAAK,EAAE,EAAE,MAAM,EAAE,EAAA;AACrB,QAAA,MAAM,YAAY,GAAGC,OAAG,CAAwB,IAAI,CAAC;QACrD,IAAI,QAAQ,GAAyB,IAAI;QAEzC,MAAM,YAAY,GAAG,MAAK;AACxB,YAAA,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,QAAQ;gBAAE;AAErC,YAAA,MAAM,OAAO,GAAyB;gBACpC,SAAS,EAAE,YAAY,CAAC,KAAK;gBAC7B,MAAM,EAAE,KAAK,CAAC,MAAM;gBACpB,QAAQ,EAAE,KAAK,CAAC,QAAQ;gBACxB,gBAAgB,EAAE,KAAK,CAAC,QAAQ;gBAChC,kBAAkB,EAAE,KAAK,CAAC,kBAAkB;AAC5C,gBAAA,MAAM,EAAE,OAAO,KAAK,CAAC,MAAM,KAAK,QAAQ,GAAG,KAAK,CAAC,MAAM,GAAG,SAAS;gBACnE,UAAU,EAAE,KAAK,CAAC,UAAU;aAC7B;;AAGD,YAAA,IAAI,KAAK,CAAC,OAAO,EAAE;AACjB,gBAAA,OAAO,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO;YACjC;;AAGA,YAAA,IAAI,OAAO,KAAK,CAAC,MAAM,KAAK,QAAQ,EAAE;gBACpC,OAAO,CAAC,OAAO,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC;YAClC;;AAGA,YAAA,IAAI,KAAK,CAAC,MAAM,EAAE;AAChB,gBAAA,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM;YAC/B;AAEA,YAAA,QAAQ,GAAG,IAAI,aAAa,CAAC,OAAO,CAAC;;AAGrC,YAAA,IAAI,KAAK,CAAC,iBAAiB,EAAE;gBAC3B,QAAQ,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC,IAAY,EAAE,EAAU,KAAI;oBAC1D,KAAK,CAAC,iBAAiB,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACzC,gBAAA,CAAC,CAAC;YACJ;AACA,YAAA,IAAI,KAAK,CAAC,eAAe,EAAE;gBACzB,QAAQ,CAAC,EAAE,CAAC,eAAe,EAAE,CAAC,MAAc,KAAI;;AAE9C,oBAAA,KAAK,CAAC,eAAe,GAAG,EAAE,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC;AAC7C,gBAAA,CAAC,CAAC;YACJ;AACA,YAAA,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;YACrC;;AAEA,YAAA,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;YACrC;AACF,QAAA,CAAC;QAED,MAAM,eAAe,GAAG,MAAK;YAC3B,IAAI,QAAQ,EAAE;gBACZ,QAAQ,CAAC,OAAO,EAAE;gBAClB,QAAQ,GAAG,IAAI;YACjB;AACF,QAAA,CAAC;;QAGDC,SAAK,CACH,MAAM,KAAK,CAAC,MAAM,EAClB,CAAC,SAAS,KAAI;YACZ,IAAI,QAAQ,EAAE;AACZ,gBAAA,QAAQ,CAAC,YAAY,CAAC,SAAS,CAAC;YAClC;AACF,QAAA,CAAC,CACF;QAEDA,SAAK,CACH,MAAM,KAAK,CAAC,QAAQ,EACpB,CAAC,WAAW,KAAI;YACd,IAAI,QAAQ,EAAE;gBACZ,IAAI,WAAW,EAAE;oBACf,QAAQ,CAAC,IAAI,EAAE;gBACjB;qBAAO;oBACL,QAAQ,CAAC,KAAK,EAAE;gBAClB;YACF;AACF,QAAA,CAAC,CACF;QAEDA,SAAK,CACH,MAAM,KAAK,CAAC,QAAQ,EACpB,CAAC,WAAW,KAAI;YACd,IAAI,QAAQ,EAAE;gBACZ,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,WAAW,CAAC;YACnD;AACF,QAAA,CAAC,CACF;QAEDA,SAAK,CACH,MAAM,KAAK,CAAC,MAAM,EAClB,CAAC,SAAS,KAAI;AACZ,YAAA,IAAI,QAAQ,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE;AAC7C,gBAAA,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC;YAC/B;AACF,QAAA,CAAC,CACF;QAEDC,aAAS,CAAC,MAAK;AACb,YAAA,YAAY,EAAE;AAChB,QAAA,CAAC,CAAC;QAEFC,eAAW,CAAC,MAAK;AACf,YAAA,eAAe,EAAE;AACnB,QAAA,CAAC,CAAC;;QAGF,MAAM,IAAI,GAAG,MAAK;YAChB,QAAQ,EAAE,IAAI,EAAE;AAClB,QAAA,CAAC;QAED,MAAM,QAAQ,GAAG,MAAK;YACpB,QAAQ,EAAE,QAAQ,EAAE;AACtB,QAAA,CAAC;AAED,QAAA,MAAM,IAAI,GAAG,CAAC,KAAa,KAAI;AAC7B,YAAA,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC;AACvB,QAAA,CAAC;QAED,MAAM,eAAe,GAAG,MAAK;AAC3B,YAAA,OAAO,QAAQ,EAAE,eAAe,EAAE,IAAI,CAAC;AACzC,QAAA,CAAC;QAED,MAAM,cAAc,GAAG,MAAK;AAC1B,YAAA,OAAO,QAAQ,EAAE,aAAa,EAAE,IAAI,CAAC;AACvC,QAAA,CAAC;AAED,QAAA,MAAM,SAAS,GAAG,CAAC,MAA2B,KAAI;AAChD,YAAA,IAAI,QAAQ,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;AAC1C,gBAAA,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5B;AACF,QAAA,CAAC;QAED,MAAM,mBAAmB,GAAG,MAAK;AAC/B,YAAA,OAAO,QAAQ,EAAE,mBAAmB,EAAE,IAAI,EAAE;AAC9C,QAAA,CAAC;AAED,QAAA,MAAM,cAAc,GAAG,CAAC,MAAkB,KAAI;;AAE5C,YAAA,QAAQ,EAAE,cAAc,CAAC,MAAM,CAAC;AAClC,QAAA,CAAC;QAED,MAAM,IAAI,GAAG,MAAK;YAChB,QAAQ,EAAE,IAAI,EAAE;AAClB,QAAA,CAAC;QAED,MAAM,KAAK,GAAG,MAAK;YACjB,QAAQ,EAAE,KAAK,EAAE;AACnB,QAAA,CAAC;QAED,MAAM,SAAS,GAAG,MAAK;;AAErB,YAAA,OAAO,KAAK;AACd,QAAA,CAAC;AAED,QAAA,MAAM,mBAAmB,GAAG,CAAC,QAAgB,KAAI;AAC/C,YAAA,QAAQ,EAAE,WAAW,CAAC,IAAI,EAAE,QAAQ,CAAC;AACvC,QAAA,CAAC;AAED,QAAA,MAAM,YAAY,GAAG,CAAC,OAAiB,KAAI;;AAE3C,QAAA,CAAC;QAED,MAAM,eAAe,GAAG,MAAK;;AAE3B,YAAA,OAAO,KAAK;AACd,QAAA,CAAC;AAED,QAAA,MAAM,CAAC;YACL,IAAI;YACJ,QAAQ;YACR,IAAI;YACJ,eAAe;YACf,cAAc;YACd,SAAS;YACT,mBAAmB;YACnB,cAAc;YACd,IAAI;YACJ,KAAK;YACL,SAAS;YACT,mBAAmB;YACnB,YAAY;YACZ,eAAe;AAChB,SAAA,CAAC;AAEF,QAAA,OAAO,MACLC,KAAC,CAAC,KAAK,EAAE;AACP,YAAA,GAAG,EAAE,YAAY;AACjB,YAAA,KAAK,EAAE,0BAA0B;AACjC,YAAA,KAAK,EAAE;AACL,gBAAA,KAAK,EAAE,MAAM;AACb,gBAAA,MAAM,EAAE,MAAM;AACd,gBAAA,QAAQ,EAAE,UAAU;AACrB,aAAA;AACF,SAAA,CAAC;IACN,CAAC;AACF,CAAA;;ACzTD;AACO,MAAM,OAAO,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}